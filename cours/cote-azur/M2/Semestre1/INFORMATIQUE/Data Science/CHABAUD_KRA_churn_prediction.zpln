{
  "paragraphs": [
    {
      "text": "%md \n\nCustomer Relationship Management (CRM) is a key element of modern marketing strategies.\nThe French Telecom company Orange offered a large marketing database to predict the propensity of customers to switch provider (churn).\n\nOrange made available a large dataset of customer data consisting of:\n- Training : 50,000 instances including 15,000 inputs variables, and the target value.\n- Test : 50,000 instances including 15,000 inputs variables.\n\nSee details on https://www.kdd.org/kdd-cup/view/kdd-cup-2009/Intro\n\nThe Orange Telecom Churn Dataset used in this labs consists of cleaned customer activity data (features), along with a churn label specifying whether the customer canceled their subscription or not. \nThe used dataset is smaller than the original one.\nThe input csv file has the following format: \nKS,128,415,No,Yes,25,265.1,110,45.07,197.4,99,16.78,244.7,91,11.01,10.0,3,2.7,1,False\nThe name of the variables are given in the header of the data files.\n\nWe use a Scala case class and Structype to define the schema, corresponding to a line in the csv data file.",
      "user": "anonymous",
      "dateUpdated": "2024-11-04T09:22:08+0000",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionSupport": false
        },
        "colWidth": 12,
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "<div class=\"markdown-body\">\n<p>Customer Relationship Management (CRM) is a key element of modern marketing strategies.<br />\nThe French Telecom company Orange offered a large marketing database to predict the propensity of customers to switch provider (churn).</p>\n<p>Orange made available a large dataset of customer data consisting of:</p>\n<ul>\n<li>Training : 50,000 instances including 15,000 inputs variables, and the target value.</li>\n<li>Test : 50,000 instances including 15,000 inputs variables.</li>\n</ul>\n<p>See details on <a href=\"https://www.kdd.org/kdd-cup/view/kdd-cup-2009/Intro\">https://www.kdd.org/kdd-cup/view/kdd-cup-2009/Intro</a></p>\n<p>The Orange Telecom Churn Dataset used in this labs consists of cleaned customer activity data (features), along with a churn label specifying whether the customer canceled their subscription or not.<br />\nThe used dataset is smaller than the original one.<br />\nThe input csv file has the following format:<br />\nKS,128,415,No,Yes,25,265.1,110,45.07,197.4,99,16.78,244.7,91,11.01,10.0,3,2.7,1,False<br />\nThe name of the variables are given in the header of the data files.</p>\n<p>We use a Scala case class and Structype to define the schema, corresponding to a line in the csv data file.</p>\n\n</div>"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1730711950521_1517842586",
      "id": "20170530-122945_1594214131",
      "dateCreated": "2024-11-04T09:19:10+0000",
      "dateStarted": "2024-11-04T09:22:08+0000",
      "dateFinished": "2024-11-04T09:22:12+0000",
      "status": "FINISHED",
      "focus": true,
      "$$hashKey": "object:150296"
    },
    {
      "title": "Import needed packages",
      "text": "%spark\n\nimport org.apache.spark._\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types._\nimport org.apache.spark.sql._\nimport org.apache.spark.sql.Dataset\nimport org.apache.spark.ml.Pipeline\nimport org.apache.spark.ml.classification.DecisionTreeClassifier\nimport org.apache.spark.ml.classification.DecisionTreeClassificationModel\nimport org.apache.spark.mllib.evaluation.BinaryClassificationMetrics\nimport org.apache.spark.ml.evaluation.BinaryClassificationEvaluator\nimport org.apache.spark.ml.feature.StringIndexer\nimport org.apache.spark.ml.tuning.ParamGridBuilder\nimport org.apache.spark.ml.tuning.CrossValidator\nimport org.apache.spark.ml.feature.VectorAssembler",
      "user": "anonymous",
      "dateUpdated": "2024-11-04T09:22:20+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "import org.apache.spark._\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types._\nimport org.apache.spark.sql._\nimport org.apache.spark.sql.Dataset\nimport org.apache.spark.ml.Pipeline\nimport org.apache.spark.ml.classification.DecisionTreeClassifier\nimport org.apache.spark.ml.classification.DecisionTreeClassificationModel\nimport org.apache.spark.mllib.evaluation.BinaryClassificationMetrics\nimport org.apache.spark.ml.evaluation.BinaryClassificationEvaluator\nimport org.apache.spark.ml.feature.StringIndexer\nimport org.apache.spark.ml.tuning.ParamGridBuilder\nimport org.apache.spark.ml.tuning.CrossValidator\nimport org.apache.spark.ml.feature.VectorAssembler\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1730711950522_250408312",
      "id": "20170508-144514_403247535",
      "dateCreated": "2024-11-04T09:19:10+0000",
      "dateStarted": "2024-11-04T09:22:20+0000",
      "dateFinished": "2024-11-04T09:22:43+0000",
      "status": "FINISHED",
      "$$hashKey": "object:150297"
    },
    {
      "title": "Define Schema for csv file data",
      "text": "%spark\n\ncase class Account(state: String, len: Integer, acode: String,\n    intlplan: String, vplan: String, numvmail: Double,\n    tdmins: Double, tdcalls: Double, tdcharge: Double,\n    temins: Double, tecalls: Double, techarge: Double,\n    tnmins: Double, tncalls: Double, tncharge: Double,\n    timins: Double, ticalls: Double, ticharge: Double,\n    numcs: Double, churn: String)\n    \n    \n// StructType objects define the schema of Spark DataFrames. \n// StructType objects contain a list of StructField objects that define the name, type, and nullable flag for each column in a DataFrame.    \n// A nullable flag switched to true means that the corresponding column could have null values.\nval schema = StructType(Array(\n    StructField(\"state\", StringType, true),\n    StructField(\"len\", IntegerType, true),\n    StructField(\"acode\", StringType, true),\n    StructField(\"intlplan\", StringType, true),\n    StructField(\"vplan\", StringType, true),\n    StructField(\"numvmail\", DoubleType, true),\n    StructField(\"tdmins\", DoubleType, true),\n    StructField(\"tdcalls\", DoubleType, true),\n    StructField(\"tdcharge\", DoubleType, true),\n    StructField(\"temins\", DoubleType, true),\n    StructField(\"tecalls\", DoubleType, true),\n    StructField(\"techarge\", DoubleType, true),\n    StructField(\"tnmins\", DoubleType, true),\n    StructField(\"tncalls\", DoubleType, true),\n    StructField(\"tncharge\", DoubleType, true),\n    StructField(\"timins\", DoubleType, true),\n    StructField(\"ticalls\", DoubleType, true),\n    StructField(\"ticharge\", DoubleType, true),\n    StructField(\"numcs\", DoubleType, true),\n    StructField(\"churn\", StringType, true)\n  ))",
      "user": "anonymous",
      "dateUpdated": "2024-11-04T09:23:12+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "defined class Account\n\u001b[1m\u001b[34mschema\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.types.StructType\u001b[0m = StructType(StructField(state,StringType,true),StructField(len,IntegerType,true),StructField(acode,StringType,true),StructField(intlplan,StringType,true),StructField(vplan,StringType,true),StructField(numvmail,DoubleType,true),StructField(tdmins,DoubleType,true),StructField(tdcalls,DoubleType,true),StructField(tdcharge,DoubleType,true),StructField(temins,DoubleType,true),StructField(tecalls,DoubleType,true),StructField(techarge,DoubleType,true),StructField(tnmins,DoubleType,true),StructField(tncalls,DoubleType,true),StructField(tncharge,DoubleType,true),StructField(timins,DoubleType,true),StructField(ticalls,DoubleType,true),StructField(ticharge,DoubleType,true),StructField(numcs,DoubleType,tr...\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1730711950523_1418965170",
      "id": "20170508-150032_326029627",
      "dateCreated": "2024-11-04T09:19:10+0000",
      "dateStarted": "2024-11-04T09:23:12+0000",
      "dateFinished": "2024-11-04T09:23:13+0000",
      "status": "FINISHED",
      "$$hashKey": "object:150298"
    },
    {
      "text": "%spark\n\nval trainDf = spark.read.option(\"header\", \"true\").csv(\"/home/user/churn-train-header.csv\")\ntrainDf.count()\ntrainDf.first()\ntrainDf.printSchema()",
      "user": "anonymous",
      "dateUpdated": "2024-11-04T09:23:57+0000",
      "progress": 100,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "root\n |-- State: string (nullable = true)\n |-- Account length: string (nullable = true)\n |-- Area code: string (nullable = true)\n |-- International plan: string (nullable = true)\n |-- Voice mail plan: string (nullable = true)\n |-- Number vmail messages: string (nullable = true)\n |-- Total day minutes: string (nullable = true)\n |-- Total day calls: string (nullable = true)\n |-- Total day charge: string (nullable = true)\n |-- Total eve minutes: string (nullable = true)\n |-- Total eve calls: string (nullable = true)\n |-- Total eve charge: string (nullable = true)\n |-- Total night minutes: string (nullable = true)\n |-- Total night calls: string (nullable = true)\n |-- Total night charge: string (nullable = true)\n |-- Total intl minutes: string (nullable = true)\n |-- Total intl calls: string (nullable = true)\n |-- Total intl charge: string (nullable = true)\n |-- Customer service calls: string (nullable = true)\n |-- Churn: string (nullable = true)\n\n\u001b[1m\u001b[34mtrainDf\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [State: string, Account length: string ... 18 more fields]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=0",
              "$$hashKey": "object:151970"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=1",
              "$$hashKey": "object:151971"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=2",
              "$$hashKey": "object:151972"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=3",
              "$$hashKey": "object:151973"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1730711950523_1204220333",
      "id": "20181102-175053_704133435",
      "dateCreated": "2024-11-04T09:19:10+0000",
      "dateStarted": "2024-11-04T09:23:57+0000",
      "dateFinished": "2024-11-04T09:24:06+0000",
      "status": "FINISHED",
      "$$hashKey": "object:150299"
    },
    {
      "title": "Read the data from CSV file into a Dataset of Account type",
      "text": "%spark\n\nimport spark.implicits._\nval train: Dataset[Account] = spark.read.option(\"header\", \"true\").option(\"inferSchema\", \"false\")\n      .schema(schema).csv(\"/home/user/churn-train-header.csv\").as[Account]\ntrain.count()  \ntrain.cache()\ntrain.first()\ntrain.printSchema()\n\n// Importe le fichier churn-train-header.csv comme une instance de la classe Account, avec le schéma \"schema\" défini manuellement.",
      "user": "anonymous",
      "dateUpdated": "2024-11-04T10:30:51+0000",
      "progress": 100,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "root\n |-- state: string (nullable = true)\n |-- len: integer (nullable = true)\n |-- acode: string (nullable = true)\n |-- intlplan: string (nullable = true)\n |-- vplan: string (nullable = true)\n |-- numvmail: double (nullable = true)\n |-- tdmins: double (nullable = true)\n |-- tdcalls: double (nullable = true)\n |-- tdcharge: double (nullable = true)\n |-- temins: double (nullable = true)\n |-- tecalls: double (nullable = true)\n |-- techarge: double (nullable = true)\n |-- tnmins: double (nullable = true)\n |-- tncalls: double (nullable = true)\n |-- tncharge: double (nullable = true)\n |-- timins: double (nullable = true)\n |-- ticalls: double (nullable = true)\n |-- ticharge: double (nullable = true)\n |-- numcs: double (nullable = true)\n |-- churn: string (nullable = true)\n\nimport spark.implicits._\n\u001b[1m\u001b[34mtrain\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[Account]\u001b[0m = [state: string, len: int ... 18 more fields]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=279",
              "$$hashKey": "object:152043"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=280",
              "$$hashKey": "object:152044"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=281",
              "$$hashKey": "object:152045"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1730711950523_1756572503",
      "id": "20170508-150131_378637203",
      "dateCreated": "2024-11-04T09:19:10+0000",
      "dateStarted": "2024-11-04T10:30:51+0000",
      "dateFinished": "2024-11-04T10:30:53+0000",
      "status": "FINISHED",
      "$$hashKey": "object:150300"
    },
    {
      "text": "%md\n\n**Q1: What is the advantage to use the \"Dataset\" train instead of the \"Dataframe\" trainDf?**\n\n\n",
      "user": "anonymous",
      "dateUpdated": "2024-11-04T09:19:10+0000",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "<div class=\"markdown-body\">\n<p><strong>Q1: What is the advantage to use the &ldquo;Dataset&rdquo; train instead of the &ldquo;Dataframe&rdquo; trainDf?</strong></p>\n\n</div>"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1730711950523_1044603607",
      "id": "20181103-141647_2000726232",
      "dateCreated": "2024-11-04T09:19:10+0000",
      "status": "READY",
      "$$hashKey": "object:150301"
    },
    {
      "text": "%md\n\nLes DataFrames peuvent mener à des problèmes au niveau du typage, car ils nécessitent souvent des chaînes de caractères pour identifier les colonnes, ce qui rend le code plus sujet aux erreurs non détectées à la compilation. En effet, dans un DataFrame, chaque ligne est une liste de valeurs sans type précis pour les colonnes.\nEn revanche, les Datasets sont sécurisés au niveau des types et utilisent des \"case classes\" pour décrire les données. Ils sont donc plus sûrs et mieux adaptés aux applications nécessitant un typage structuré des données.",
      "user": "anonymous",
      "dateUpdated": "2024-11-04T09:25:54+0000",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12,
        "editorMode": "ace/mode/markdown",
        "fontSize": 9,
        "editorHide": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "<div class=\"markdown-body\">\n<p>Les DataFrames peuvent mener à des problèmes au niveau du typage, car ils nécessitent souvent des chaînes de caractères pour identifier les colonnes, ce qui rend le code plus sujet aux erreurs non détectées à la compilation. En effet, dans un DataFrame, chaque ligne est une liste de valeurs sans type précis pour les colonnes.<br />\nEn revanche, les Datasets sont sécurisés au niveau des types et utilisent des &ldquo;case classes&rdquo; pour décrire les données. Ils sont donc plus sûrs et mieux adaptés aux applications nécessitant un typage structuré des données.</p>\n\n</div>"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1730712283353_261500714",
      "id": "paragraph_1730712283353_261500714",
      "dateCreated": "2024-11-04T09:24:43+0000",
      "dateStarted": "2024-11-04T09:25:54+0000",
      "dateFinished": "2024-11-04T09:25:54+0000",
      "status": "FINISHED",
      "$$hashKey": "object:150302"
    },
    {
      "text": "%spark\n\nval test: Dataset[Account] = spark.read.option(\"header\", \"true\").option(\"inferSchema\", \"false\")\n      .schema(schema).csv(\"/home/user/churn-test-header.csv\").as[Account]\ntest.count()      \ntest.first()\ntest.printSchema()\n    ",
      "user": "anonymous",
      "dateUpdated": "2024-11-04T09:28:09+0000",
      "progress": 50,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "root\n |-- state: string (nullable = true)\n |-- len: integer (nullable = true)\n |-- acode: string (nullable = true)\n |-- intlplan: string (nullable = true)\n |-- vplan: string (nullable = true)\n |-- numvmail: double (nullable = true)\n |-- tdmins: double (nullable = true)\n |-- tdcalls: double (nullable = true)\n |-- tdcharge: double (nullable = true)\n |-- temins: double (nullable = true)\n |-- tecalls: double (nullable = true)\n |-- techarge: double (nullable = true)\n |-- tnmins: double (nullable = true)\n |-- tncalls: double (nullable = true)\n |-- tncharge: double (nullable = true)\n |-- timins: double (nullable = true)\n |-- ticalls: double (nullable = true)\n |-- ticharge: double (nullable = true)\n |-- numcs: double (nullable = true)\n |-- churn: string (nullable = true)\n\n\u001b[1m\u001b[34mtest\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[Account]\u001b[0m = [state: string, len: int ... 18 more fields]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=7",
              "$$hashKey": "object:152203"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=8",
              "$$hashKey": "object:152204"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=9",
              "$$hashKey": "object:152205"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1730711950523_1595005083",
      "id": "20170508-150324_497571301",
      "dateCreated": "2024-11-04T09:19:10+0000",
      "dateStarted": "2024-11-04T09:28:09+0000",
      "dateFinished": "2024-11-04T09:28:11+0000",
      "status": "FINISHED",
      "$$hashKey": "object:150303"
    },
    {
      "title": "Register Dataset as a Table , display first 20 rows ",
      "text": "%spark\n\n// Création d'une vue temporaire de l'ensemble \"train\".\ntrain.createOrReplaceTempView(\"account\")\nspark.catalog.cacheTable(\"account\") // Caches the specified table in-memory.\ntrain.show",
      "user": "anonymous",
      "dateUpdated": "2024-11-04T10:32:52+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": true,
        "results": {
          "0": {
            "graph": {
              "mode": "table",
              "height": 300,
              "optionOpen": true,
              "setting": {
                "stackedAreaChart": {}
              },
              "commonSetting": {},
              "keys": [
                {
                  "name": "churn",
                  "index": 19,
                  "aggr": "sum"
                }
              ],
              "groups": [],
              "values": [
                {
                  "name": "len",
                  "index": 1,
                  "aggr": "sum"
                }
              ]
            },
            "helium": {}
          }
        },
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----+---+-----+--------+-----+--------+------+-------+--------+------+-------+--------+------+-------+--------+------+-------+--------+-----+-----+\n|state|len|acode|intlplan|vplan|numvmail|tdmins|tdcalls|tdcharge|temins|tecalls|techarge|tnmins|tncalls|tncharge|timins|ticalls|ticharge|numcs|churn|\n+-----+---+-----+--------+-----+--------+------+-------+--------+------+-------+--------+------+-------+--------+------+-------+--------+-----+-----+\n|   KS|128|  415|      No|  Yes|    25.0| 265.1|  110.0|   45.07| 197.4|   99.0|   16.78| 244.7|   91.0|   11.01|  10.0|    3.0|     2.7|  1.0|False|\n|   OH|107|  415|      No|  Yes|    26.0| 161.6|  123.0|   27.47| 195.5|  103.0|   16.62| 254.4|  103.0|   11.45|  13.7|    3.0|     3.7|  1.0|False|\n|   NJ|137|  415|      No|   No|     0.0| 243.4|  114.0|   41.38| 121.2|  110.0|    10.3| 162.6|  104.0|    7.32|  12.2|    5.0|    3.29|  0.0|False|\n|   OH| 84|  408|     Yes|   No|     0.0| 299.4|   71.0|    50.9|  61.9|   88.0|    5.26| 196.9|   89.0|    8.86|   6.6|    7.0|    1.78|  2.0|False|\n|   OK| 75|  415|     Yes|   No|     0.0| 166.7|  113.0|   28.34| 148.3|  122.0|   12.61| 186.9|  121.0|    8.41|  10.1|    3.0|    2.73|  3.0|False|\n|   AL|118|  510|     Yes|   No|     0.0| 223.4|   98.0|   37.98| 220.6|  101.0|   18.75| 203.9|  118.0|    9.18|   6.3|    6.0|     1.7|  0.0|False|\n|   MA|121|  510|      No|  Yes|    24.0| 218.2|   88.0|   37.09| 348.5|  108.0|   29.62| 212.6|  118.0|    9.57|   7.5|    7.0|    2.03|  3.0|False|\n|   MO|147|  415|     Yes|   No|     0.0| 157.0|   79.0|   26.69| 103.1|   94.0|    8.76| 211.8|   96.0|    9.53|   7.1|    6.0|    1.92|  0.0|False|\n|   WV|141|  415|     Yes|  Yes|    37.0| 258.6|   84.0|   43.96| 222.0|  111.0|   18.87| 326.4|   97.0|   14.69|  11.2|    5.0|    3.02|  0.0|False|\n|   RI| 74|  415|      No|   No|     0.0| 187.7|  127.0|   31.91| 163.4|  148.0|   13.89| 196.0|   94.0|    8.82|   9.1|    5.0|    2.46|  0.0|False|\n|   IA|168|  408|      No|   No|     0.0| 128.8|   96.0|    21.9| 104.9|   71.0|    8.92| 141.1|  128.0|    6.35|  11.2|    2.0|    3.02|  1.0|False|\n|   MT| 95|  510|      No|   No|     0.0| 156.6|   88.0|   26.62| 247.6|   75.0|   21.05| 192.3|  115.0|    8.65|  12.3|    5.0|    3.32|  3.0|False|\n|   IA| 62|  415|      No|   No|     0.0| 120.7|   70.0|   20.52| 307.2|   76.0|   26.11| 203.0|   99.0|    9.14|  13.1|    6.0|    3.54|  4.0|False|\n|   ID| 85|  408|      No|  Yes|    27.0| 196.4|  139.0|   33.39| 280.9|   90.0|   23.88|  89.3|   75.0|    4.02|  13.8|    4.0|    3.73|  1.0|False|\n|   VT| 93|  510|      No|   No|     0.0| 190.7|  114.0|   32.42| 218.2|  111.0|   18.55| 129.6|  121.0|    5.83|   8.1|    3.0|    2.19|  3.0|False|\n|   VA| 76|  510|      No|  Yes|    33.0| 189.7|   66.0|   32.25| 212.8|   65.0|   18.09| 165.7|  108.0|    7.46|  10.0|    5.0|     2.7|  1.0|False|\n|   TX| 73|  415|      No|   No|     0.0| 224.4|   90.0|   38.15| 159.5|   88.0|   13.56| 192.8|   74.0|    8.68|  13.0|    2.0|    3.51|  1.0|False|\n|   FL|147|  415|      No|   No|     0.0| 155.1|  117.0|   26.37| 239.7|   93.0|   20.37| 208.8|  133.0|     9.4|  10.6|    4.0|    2.86|  0.0|False|\n|   CO| 77|  408|      No|   No|     0.0|  62.4|   89.0|   10.61| 169.9|  121.0|   14.44| 209.6|   64.0|    9.43|   5.7|    6.0|    1.54|  5.0| True|\n|   AZ|130|  415|      No|   No|     0.0| 183.0|  112.0|   31.11|  72.9|   99.0|     6.2| 181.8|   78.0|    8.18|   9.5|   19.0|    2.57|  0.0|False|\n+-----+---+-----+--------+-----+--------+------+-------+--------+------+-------+--------+------+-------+--------+------+-------+--------+-----+-----+\nonly showing top 20 rows\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=282",
              "$$hashKey": "object:152271"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1730711950523_98946",
      "id": "20170508-150408_505244914",
      "dateCreated": "2024-11-04T09:19:10+0000",
      "dateStarted": "2024-11-04T10:32:52+0000",
      "dateFinished": "2024-11-04T10:32:53+0000",
      "status": "FINISHED",
      "$$hashKey": "object:150304"
    },
    {
      "text": "%md\nThe describe() function performs summary statistics calculations on  numeric columns ",
      "user": "anonymous",
      "dateUpdated": "2024-11-04T09:30:09+0000",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionSupport": false
        },
        "colWidth": 12,
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "<div class=\"markdown-body\">\n<p>The describe() function performs summary statistics calculations on  numeric columns</p>\n\n</div>"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1730711950524_1904590090",
      "id": "20170524-214640_973339640",
      "dateCreated": "2024-11-04T09:19:10+0000",
      "dateStarted": "2024-11-04T09:30:09+0000",
      "dateFinished": "2024-11-04T09:30:09+0000",
      "status": "FINISHED",
      "$$hashKey": "object:150305"
    },
    {
      "title": "Perform summary statistics  on selected columns",
      "text": "%spark\n\ntrain.describe(\"tdcharge\", \"techarge\",\"tncharge\", \"numcs\").show",
      "user": "anonymous",
      "dateUpdated": "2024-11-04T09:30:17+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-------+------------------+------------------+------------------+------------------+\n|summary|          tdcharge|          techarge|          tncharge|             numcs|\n+-------+------------------+------------------+------------------+------------------+\n|  count|              2666|              2666|              2666|              2666|\n|   mean|30.512404351087813|17.033072018004518| 9.052689422355604|1.5626406601650413|\n| stddev| 9.215732907163497| 4.330864176799864|2.2851195129157564|1.3112357589949093|\n|    min|               0.0|               0.0|              1.97|               0.0|\n|    max|             59.64|             30.91|             17.77|               9.0|\n+-------+------------------+------------------+------------------+------------------+\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=11",
              "$$hashKey": "object:152375"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=12",
              "$$hashKey": "object:152376"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1730711950524_1480963705",
      "id": "20170524-083228_1459810795",
      "dateCreated": "2024-11-04T09:19:10+0000",
      "dateStarted": "2024-11-04T09:30:17+0000",
      "dateFinished": "2024-11-04T09:30:19+0000",
      "status": "FINISHED",
      "$$hashKey": "object:150306"
    },
    {
      "text": "%md \nuse Spark SQL to explore the dataset",
      "user": "anonymous",
      "dateUpdated": "2024-11-04T09:33:13+0000",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionSupport": false
        },
        "colWidth": 12,
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "<div class=\"markdown-body\">\n<p>use Spark SQL to explore the dataset</p>\n\n</div>"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1730711950524_1998617416",
      "id": "20170603-182655_1680505289",
      "dateCreated": "2024-11-04T09:19:10+0000",
      "dateStarted": "2024-11-04T09:33:13+0000",
      "dateFinished": "2024-11-04T09:33:13+0000",
      "status": "FINISHED",
      "$$hashKey": "object:150307"
    },
    {
      "text": "%md\n\n**Q2: compute the number of labels (churn or no churn) for the train dataset in the following cell. Use sparkSQL.**",
      "user": "anonymous",
      "dateUpdated": "2024-11-04T09:31:10+0000",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionSupport": false
        },
        "colWidth": 12,
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "<div class=\"markdown-body\">\n<p><strong>Q2: compute the number of labels (churn or no churn) for the train dataset in the following cell. Use sparkSQL.</strong></p>\n\n</div>"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1730711950524_1540128826",
      "id": "20181103-142552_1060736217",
      "dateCreated": "2024-11-04T09:19:10+0000",
      "dateStarted": "2024-11-04T09:31:10+0000",
      "dateFinished": "2024-11-04T09:31:10+0000",
      "status": "FINISHED",
      "$$hashKey": "object:150308"
    },
    {
      "title": "Count number customers grouped by churn",
      "text": "%spark\n\n// Compute the number of labels hereafter\n\ntrain.groupBy(\"churn\").count.show\n",
      "user": "anonymous",
      "dateUpdated": "2024-11-04T09:32:31+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----+-----+\n|churn|count|\n+-----+-----+\n|False| 2278|\n| True|  388|\n+-----+-----+\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=13",
              "$$hashKey": "object:152530"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=14",
              "$$hashKey": "object:152531"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1730711950524_775490867",
      "id": "20170524-093402_1430077788",
      "dateCreated": "2024-11-04T09:19:10+0000",
      "dateStarted": "2024-11-04T09:32:31+0000",
      "dateFinished": "2024-11-04T09:32:32+0000",
      "status": "FINISHED",
      "$$hashKey": "object:150309"
    },
    {
      "text": "%md\n\nOn affiche le nombre de clients correspondant à chaque label (churn=False ou churn=True). Le dataset \"train\" contient 2278 clients de label churn=False et 388 clients de label churn=True. ",
      "user": "anonymous",
      "dateUpdated": "2024-11-04T09:38:09+0000",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12,
        "editorMode": "ace/mode/markdown",
        "fontSize": 9,
        "editorHide": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "<div class=\"markdown-body\">\n<p>On affiche le nombre de clients correspondant à chaque label (churn=False ou churn=True). Le dataset &ldquo;train&rdquo; contient 2278 clients de label churn=False et 388 clients de label churn=True.</p>\n\n</div>"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1730712768534_767036723",
      "id": "paragraph_1730712768534_767036723",
      "dateCreated": "2024-11-04T09:32:48+0000",
      "dateStarted": "2024-11-04T09:38:09+0000",
      "dateFinished": "2024-11-04T09:38:09+0000",
      "status": "FINISHED",
      "$$hashKey": "object:150310"
    },
    {
      "title": "Use sampleBy to reduce number of churn=false samples ",
      "text": "%spark\n\nval fractions = Map(\"False\" -> .17, \"True\" -> 1.0)\n//Here we're keeping all instances of the Churn=True class, but downsampling the Churn=False class to a fraction of 388/2278.\nval strain = train.stat.sampleBy(\"churn\", fractions, 36L) // Returns a stratified sample without replacement based on the fraction given on each stratum.\n// Parameters:\n//    col - column that defines strata\n//    fractions - sampling fraction for each stratum. If a stratum is not specified, we treat its fraction as zero.\n//    seed - random seed\n\nstrain.groupBy(\"churn\").count.show\nstrain.createOrReplaceTempView(\"account\")\nspark.catalog.cacheTable(\"account\")\n\n// The resulting table is now balanced (\"fractions\" defines a probability to take a sample, hence the number of samples is not known in advance)",
      "user": "anonymous",
      "dateUpdated": "2024-11-04T09:38:26+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----+-----+\n|churn|count|\n+-----+-----+\n|False|  387|\n| True|  388|\n+-----+-----+\n\n\u001b[1m\u001b[34mfractions\u001b[0m: \u001b[1m\u001b[32mscala.collection.immutable.Map[String,Double]\u001b[0m = Map(False -> 0.17, True -> 1.0)\n\u001b[1m\u001b[34mstrain\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [state: string, len: int ... 18 more fields]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=15",
              "$$hashKey": "object:152639"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=16",
              "$$hashKey": "object:152640"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1730711950525_2083518793",
      "id": "20170603-183738_564410056",
      "dateCreated": "2024-11-04T09:19:10+0000",
      "dateStarted": "2024-11-04T09:38:26+0000",
      "dateFinished": "2024-11-04T09:38:28+0000",
      "status": "FINISHED",
      "$$hashKey": "object:150311"
    },
    {
      "text": "%md\n\nThe zeppelin-context is a system-wide container for common utility functions and user-specific data. \nIt implements functions for data input, data display, etc. that are often needed but are not uniformly available in all interpreters.\n\nThe zeppelin-context is available as a predefined variable z that can be used by directly invoking its methods. \n\nIn the Apache Spark interpreter, the zeppelin-context provides a show method, which, using Zeppelin's table feature, can be used to nicely display a set of data.",
      "user": "anonymous",
      "dateUpdated": "2024-11-04T09:39:01+0000",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionSupport": false
        },
        "colWidth": 12,
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "<div class=\"markdown-body\">\n<p>The zeppelin-context is a system-wide container for common utility functions and user-specific data.<br />\nIt implements functions for data input, data display, etc. that are often needed but are not uniformly available in all interpreters.</p>\n<p>The zeppelin-context is available as a predefined variable z that can be used by directly invoking its methods.</p>\n<p>In the Apache Spark interpreter, the zeppelin-context provides a show method, which, using Zeppelin&rsquo;s table feature, can be used to nicely display a set of data.</p>\n\n</div>"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1730711950525_310980694",
      "id": "20181102-220037_2010723778",
      "dateCreated": "2024-11-04T09:19:10+0000",
      "dateStarted": "2024-11-04T09:39:01+0000",
      "dateFinished": "2024-11-04T09:39:01+0000",
      "status": "FINISHED",
      "$$hashKey": "object:150312"
    },
    {
      "title": "Explore Average statistics grouped by churn",
      "text": "%spark\n\nz.show(strain.groupBy(\"churn\").avg())",
      "user": "anonymous",
      "dateUpdated": "2024-11-04T09:39:15+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": true,
        "results": {
          "0": {
            "graph": {
              "mode": "multiBarChart",
              "height": 300,
              "optionOpen": false,
              "setting": {
                "multiBarChart": {
                  "rotate": {
                    "degree": "-45"
                  },
                  "xLabelStatus": "default"
                }
              },
              "commonSetting": {},
              "keys": [
                {
                  "name": "churn",
                  "index": 0,
                  "aggr": "sum"
                }
              ],
              "groups": [],
              "values": [
                {
                  "name": "avg(tdmins)",
                  "index": 3,
                  "aggr": "sum"
                },
                {
                  "name": "avg(temins)",
                  "index": 6,
                  "aggr": "sum"
                },
                {
                  "name": "avg(tnmins)",
                  "index": 9,
                  "aggr": "sum"
                },
                {
                  "name": "avg(timins)",
                  "index": 12,
                  "aggr": "sum"
                },
                {
                  "name": "avg(len)",
                  "index": 1,
                  "aggr": "sum"
                },
                {
                  "name": "avg(numcs)",
                  "index": 15,
                  "aggr": "sum"
                },
                {
                  "name": "avg(tdcalls)",
                  "index": 4,
                  "aggr": "sum"
                },
                {
                  "name": "avg(tecalls)",
                  "index": 7,
                  "aggr": "sum"
                },
                {
                  "name": "avg(ticalls)",
                  "index": 13,
                  "aggr": "sum"
                }
              ]
            },
            "helium": {}
          }
        },
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TABLE",
            "data": "churn\tavg(len)\tavg(numvmail)\tavg(tdmins)\tavg(tdcalls)\tavg(tdcharge)\tavg(temins)\tavg(tecalls)\tavg(techarge)\tavg(tnmins)\tavg(tncalls)\tavg(tncharge)\tavg(timins)\tavg(ticalls)\tavg(ticharge)\tavg(numcs)\nFalse\t99.78811369509044\t8.943152454780362\t174.1638242894057\t101.0077519379845\t29.608191214470278\t198.14521963824288\t100.4108527131783\t16.842661498708022\t202.14935400516774\t99.04134366925065\t9.096770025839792\t10.297674418604652\t4.609819121447028\t2.780981912144702\t1.4521963824289406\nTrue\t102.31958762886597\t5.170103092783505\t205.1811855670104\t101.19587628865979\t34.88134020618558\t209.38530927835052\t99.94845360824742\t17.79786082474226\t205.30721649484514\t100.68298969072166\t9.23889175257732\t10.81932989690722\t4.051546391752577\t2.9217268041237117\t2.2061855670103094\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=17",
              "$$hashKey": "object:152788"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=18",
              "$$hashKey": "object:152789"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1730711950525_626038211",
      "id": "20170524-102007_926152177",
      "dateCreated": "2024-11-04T09:19:10+0000",
      "dateStarted": "2024-11-04T09:39:13+0000",
      "dateFinished": "2024-11-04T09:39:14+0000",
      "status": "FINISHED",
      "$$hashKey": "object:150313"
    },
    {
      "title": "Explore average number customer service calls grouped by churn",
      "text": "%sql\n\nSELECT churn, avg(numcs) as numcs\nFROM account \nGROUP BY churn\nORDER BY numcs",
      "user": "anonymous",
      "dateUpdated": "2024-11-04T10:22:28+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "sql",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/sql",
        "fontSize": 9,
        "title": true,
        "results": {
          "0": {
            "graph": {
              "mode": "pieChart",
              "height": 300,
              "optionOpen": false,
              "setting": {
                "multiBarChart": {
                  "rotate": {
                    "degree": "-45"
                  },
                  "xLabelStatus": "default"
                },
                "table": {
                  "tableGridState": {},
                  "tableColumnTypeState": {
                    "names": {
                      "churn": "string",
                      "numcs": "string"
                    },
                    "updated": false
                  },
                  "tableOptionSpecHash": "[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]",
                  "tableOptionValue": {
                    "useFilter": false,
                    "showPagination": false,
                    "showAggregationFooter": false
                  },
                  "updated": false,
                  "initialized": false
                }
              },
              "commonSetting": {},
              "keys": [
                {
                  "name": "churn",
                  "index": 0,
                  "aggr": "sum"
                }
              ],
              "groups": [],
              "values": [
                {
                  "name": "numcs",
                  "index": 1,
                  "aggr": "sum"
                }
              ]
            },
            "helium": {}
          }
        },
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TABLE",
            "data": "churn\tnumcs\nFalse\t1.4521963824289406\nTrue\t2.2061855670103094\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=19",
              "$$hashKey": "object:152891"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=20",
              "$$hashKey": "object:152892"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1730711950525_754467723",
      "id": "20170524-095127_757444423",
      "dateCreated": "2024-11-04T09:19:10+0000",
      "dateStarted": "2024-11-04T09:40:11+0000",
      "dateFinished": "2024-11-04T09:40:12+0000",
      "status": "FINISHED",
      "$$hashKey": "object:150314"
    },
    {
      "text": "%md\n\nOn observe que les clients qui se désabonnent ont appellé en moyenne **2.21** fois le service client, contre seulement **1.45** pour les autres. ",
      "user": "anonymous",
      "dateUpdated": "2024-11-04T09:46:49+0000",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12,
        "editorMode": "ace/mode/markdown",
        "fontSize": 9,
        "editorHide": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "<div class=\"markdown-body\">\n<p>On observe que les clients qui se désabonnent ont appellé en moyenne <strong>2.21</strong> fois le service client, contre seulement <strong>1.45</strong> pour les autres.</p>\n\n</div>"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1730713239006_277195953",
      "id": "paragraph_1730713239006_277195953",
      "dateCreated": "2024-11-04T09:40:39+0000",
      "dateStarted": "2024-11-04T09:46:49+0000",
      "dateFinished": "2024-11-04T09:46:49+0000",
      "status": "FINISHED",
      "$$hashKey": "object:150315"
    },
    {
      "title": "Drop columns that we will not use for our machine learning algorithm",
      "text": "%spark\n\nval ntrain = strain.drop(\"state\").drop(\"acode\").drop(\"vplan\").drop(\"tdcharge\").drop(\"techarge\").drop(\"ticharge\")\nprintln(ntrain.count)\nntrain.show\nntrain.cache",
      "user": "anonymous",
      "dateUpdated": "2024-11-04T09:46:58+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "775\n+---+--------+--------+------+-------+------+-------+------+-------+--------+------+-------+-----+-----+\n|len|intlplan|numvmail|tdmins|tdcalls|temins|tecalls|tnmins|tncalls|tncharge|timins|ticalls|numcs|churn|\n+---+--------+--------+------+-------+------+-------+------+-------+--------+------+-------+-----+-----+\n|118|     Yes|     0.0| 223.4|   98.0| 220.6|  101.0| 203.9|  118.0|    9.18|   6.3|    6.0|  0.0|False|\n|141|     Yes|    37.0| 258.6|   84.0| 222.0|  111.0| 326.4|   97.0|   14.69|  11.2|    5.0|  0.0|False|\n| 74|      No|     0.0| 187.7|  127.0| 163.4|  148.0| 196.0|   94.0|    8.82|   9.1|    5.0|  0.0|False|\n| 77|      No|     0.0|  62.4|   89.0| 169.9|  121.0| 209.6|   64.0|    9.43|   5.7|    6.0|  5.0| True|\n| 12|      No|     0.0| 249.6|  118.0| 252.4|  119.0| 280.2|   90.0|   12.61|  11.8|    3.0|  1.0| True|\n|136|     Yes|    33.0| 203.9|  106.0| 187.6|   99.0| 101.7|  107.0|    4.58|  10.5|    6.0|  3.0|False|\n| 98|      No|     0.0| 126.3|  102.0| 166.8|   85.0| 187.8|  135.0|    8.45|   9.4|    2.0|  3.0|False|\n|135|     Yes|    41.0| 173.1|   85.0| 203.9|  107.0| 122.2|   78.0|     5.5|  14.6|   15.0|  0.0| True|\n|160|      No|     0.0|  85.8|   77.0| 165.3|  110.0| 178.5|   92.0|    8.03|   9.2|    4.0|  3.0|False|\n| 60|      No|     0.0| 220.6|   57.0| 211.1|  115.0| 249.0|  129.0|   11.21|   6.8|    3.0|  1.0|False|\n| 87|      No|     0.0| 151.0|   83.0| 219.7|  116.0| 203.9|  127.0|    9.18|   9.7|    3.0|  5.0| True|\n|121|      No|    30.0| 198.4|  129.0|  75.3|   77.0| 181.2|   77.0|    8.15|   5.8|    3.0|  3.0| True|\n|149|      No|    28.0| 180.7|   92.0| 187.8|   64.0| 265.5|   53.0|   11.95|  12.6|    3.0|  3.0|False|\n|150|      No|     0.0| 178.9|  101.0| 169.1|  110.0| 148.6|  100.0|    6.69|  13.8|    3.0|  4.0| True|\n| 50|      No|     0.0| 157.1|   90.0| 223.3|   72.0| 181.4|  111.0|    8.16|   6.1|    2.0|  1.0|False|\n| 82|      No|     0.0| 300.3|  109.0| 181.0|  100.0| 270.1|   73.0|   12.15|  11.7|    4.0|  0.0| True|\n|144|      No|     0.0|  61.6|  117.0|  77.1|   85.0| 173.0|   99.0|    7.79|   8.2|    7.0|  4.0| True|\n| 55|      No|    25.0| 165.6|  123.0| 136.1|   95.0| 175.7|   90.0|    7.91|  11.0|    2.0|  3.0|False|\n|106|      No|     0.0| 210.6|   96.0| 249.2|   85.0| 191.4|   88.0|    8.61|  12.4|    1.0|  2.0| True|\n| 94|      No|     0.0| 157.9|  105.0| 155.0|  101.0| 189.6|   84.0|    8.53|   8.0|    5.0|  4.0| True|\n+---+--------+--------+------+-------+------+-------+------+-------+--------+------+-------+-----+-----+\nonly showing top 20 rows\n\n\u001b[1m\u001b[34mntrain\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [len: int, intlplan: string ... 12 more fields]\n\u001b[1m\u001b[34mres9\u001b[0m: \u001b[1m\u001b[32mntrain.type\u001b[0m = [len: int, intlplan: string ... 12 more fields]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=21",
              "$$hashKey": "object:153000"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=22",
              "$$hashKey": "object:153001"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=23",
              "$$hashKey": "object:153002"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1730711950525_1222873350",
      "id": "20170524-221059_1333485772",
      "dateCreated": "2024-11-04T09:19:10+0000",
      "dateStarted": "2024-11-04T09:46:58+0000",
      "dateFinished": "2024-11-04T09:46:59+0000",
      "status": "FINISHED",
      "$$hashKey": "object:150316"
    },
    {
      "text": "%md\nIn order for the features to be used by a machine learning algorithm, they are transformed into numbers representing the value for each feature\n",
      "user": "anonymous",
      "dateUpdated": "2024-11-04T09:47:12+0000",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "<div class=\"markdown-body\">\n<p>In order for the features to be used by a machine learning algorithm, they are transformed into numbers representing the value for each feature</p>\n\n</div>"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1730711950525_1712153592",
      "id": "20170603-184811_78732818",
      "dateCreated": "2024-11-04T09:19:10+0000",
      "dateStarted": "2024-11-04T09:47:12+0000",
      "dateFinished": "2024-11-04T09:47:12+0000",
      "status": "FINISHED",
      "$$hashKey": "object:150317"
    },
    {
      "title": "Map International Plan Yes No to Numbers",
      "text": "%spark\n\nval ipindexer = new StringIndexer()\n      .setInputCol(\"intlplan\")\n      .setOutputCol(\"iplanIndex\")\n\n",
      "user": "anonymous",
      "dateUpdated": "2024-11-04T09:47:15+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34mipindexer\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.feature.StringIndexer\u001b[0m = strIdx_aa17a746c539\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1730711950525_1665365316",
      "id": "20170508-150543_958647761",
      "dateCreated": "2024-11-04T09:19:10+0000",
      "dateStarted": "2024-11-04T09:47:15+0000",
      "dateFinished": "2024-11-04T09:47:16+0000",
      "status": "FINISHED",
      "$$hashKey": "object:150318"
    },
    {
      "text": "%md\n\n**Q3: Create a transformer to convert the churn value into a 0-1 label**\n",
      "user": "anonymous",
      "dateUpdated": "2024-11-04T09:19:10+0000",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionSupport": false
        },
        "colWidth": 12,
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "<div class=\"markdown-body\">\n<p><strong>Q3: Create a transformer to convert the churn value into a 0-1 label</strong></p>\n\n</div>"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1730711950525_317379440",
      "id": "20181103-143221_330782578",
      "dateCreated": "2024-11-04T09:19:10+0000",
      "status": "READY",
      "$$hashKey": "object:150319"
    },
    {
      "title": "Map churn true false to  Numbers",
      "text": "%spark\n\n// Put the transformer here\n\nval labelindexer = new StringIndexer()\n      .setInputCol(\"churn\")\n      .setOutputCol(\"label\")\n",
      "user": "anonymous",
      "dateUpdated": "2024-11-04T09:48:17+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34mlabelindexer\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.feature.StringIndexer\u001b[0m = strIdx_5148bada7326\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1730711950526_259180974",
      "id": "20170524-222135_122500289",
      "dateCreated": "2024-11-04T09:19:10+0000",
      "dateStarted": "2024-11-04T09:48:17+0000",
      "dateFinished": "2024-11-04T09:48:17+0000",
      "status": "FINISHED",
      "$$hashKey": "object:150320"
    },
    {
      "text": "%md\n\n**Q4: Create a transformer to convert all the features in a single vector**\n",
      "user": "anonymous",
      "dateUpdated": "2024-11-04T09:19:10+0000",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionSupport": false
        },
        "colWidth": 12,
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "<div class=\"markdown-body\">\n<p><strong>Q4: Create a transformer to convert all the features in a single vector</strong></p>\n\n</div>"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1730711950526_1185851765",
      "id": "20181103-143346_221939635",
      "dateCreated": "2024-11-04T09:19:10+0000",
      "status": "READY",
      "$$hashKey": "object:150321"
    },
    {
      "title": "Use VectorAssembler, a transformer,  to put features into a feature vector column",
      "text": "%spark\n\n// Put the transformer here\n\n// On assemble dans un unique vecteur les features\nval featureCols = Array(\"len\", \"iplanIndex\", \"numvmail\", \"tdmins\", \"tdcalls\", \"temins\", \"tecalls\", \"tncharge\", \"tnmins\", \"tncalls\", \"timins\", \"ticalls\", \"numcs\")\nval assembler = new VectorAssembler()\n      .setInputCols(featureCols)\n      .setOutputCol(\"features\")\n",
      "user": "anonymous",
      "dateUpdated": "2024-11-04T09:53:27+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34mfeatureCols\u001b[0m: \u001b[1m\u001b[32mArray[String]\u001b[0m = Array(len, iplanIndex, numvmail, tdmins, tdcalls, temins, tecalls, tncharge, tnmins, tncalls, timins, ticalls, numcs)\n\u001b[1m\u001b[34massembler\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.feature.VectorAssembler\u001b[0m = VectorAssembler: uid=vecAssembler_1ae85e6ae888, handleInvalid=error, numInputCols=13\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1730711950526_561372619",
      "id": "20170524-223310_2121058884",
      "dateCreated": "2024-11-04T09:19:10+0000",
      "dateStarted": "2024-11-04T09:53:27+0000",
      "dateFinished": "2024-11-04T09:53:27+0000",
      "status": "FINISHED",
      "$$hashKey": "object:150322"
    },
    {
      "title": "Decision Tree Models",
      "text": "%md\n\nDecision trees have played a significant role in data mining and machine learning since the 1960's. \nThey generate white-box classification and regression models which can be used for feature selection and sample prediction. \nThe transparency of these models is a big advantage over black-box learners, because the models are easy to understand and interpret, and they can be readily extracted and implemented in any programming language (with nested if-else statements) for use in production environments. \nFurthermore, decision trees require almost no data preparation (ie normalization) and can handle both categorical and continuous data. \nTo remedy over-fitting and improve prediction accuracy, decision trees can also be limited to a certain depth or complexity, or bundled into ensembles of trees (ie random forests).\n\nA decision tree is a predictive model which maps observations (features) about an item to conclusions about the item's label or class. \nThe model is generated using a top-down approach, where the source dataset is split into subsets using a statistical measure, often in the form of the Gini index or information gain via Shannon entropy. \nThis process is applied recursively until a subset contains only samples with the same target class, or is halted by a predefined stopping criteria.",
      "user": "anonymous",
      "dateUpdated": "2024-11-04T09:53:44+0000",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "fontSize": 9,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "<div class=\"markdown-body\">\n<p>Decision trees have played a significant role in data mining and machine learning since the 1960&rsquo;s.<br />\nThey generate white-box classification and regression models which can be used for feature selection and sample prediction.<br />\nThe transparency of these models is a big advantage over black-box learners, because the models are easy to understand and interpret, and they can be readily extracted and implemented in any programming language (with nested if-else statements) for use in production environments.<br />\nFurthermore, decision trees require almost no data preparation (ie normalization) and can handle both categorical and continuous data.<br />\nTo remedy over-fitting and improve prediction accuracy, decision trees can also be limited to a certain depth or complexity, or bundled into ensembles of trees (ie random forests).</p>\n<p>A decision tree is a predictive model which maps observations (features) about an item to conclusions about the item&rsquo;s label or class.<br />\nThe model is generated using a top-down approach, where the source dataset is split into subsets using a statistical measure, often in the form of the Gini index or information gain via Shannon entropy.<br />\nThis process is applied recursively until a subset contains only samples with the same target class, or is halted by a predefined stopping criteria.</p>\n\n</div>"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1730711950526_1855150577",
      "id": "20181103-144109_1955600190",
      "dateCreated": "2024-11-04T09:19:10+0000",
      "dateStarted": "2024-11-04T09:53:44+0000",
      "dateFinished": "2024-11-04T09:53:44+0000",
      "status": "FINISHED",
      "$$hashKey": "object:150323"
    },
    {
      "title": "Create Decision Tree Estimator , set Label and Feature Columns ",
      "text": "%spark\n\n// Création de l'arbre de décision dTree\nval dTree = new DecisionTreeClassifier().setLabelCol(\"label\")\n      .setFeaturesCol(\"features\")",
      "user": "anonymous",
      "dateUpdated": "2024-11-04T10:36:48+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34mdTree\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.classification.DecisionTreeClassifier\u001b[0m = dtc_31d93cc4d657\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1730711950526_1164182418",
      "id": "20170603-185445_276463997",
      "dateCreated": "2024-11-04T09:19:10+0000",
      "dateStarted": "2024-11-04T10:36:48+0000",
      "dateFinished": "2024-11-04T10:36:49+0000",
      "status": "FINISHED",
      "$$hashKey": "object:150324"
    },
    {
      "text": "%md\n\nSet up a pipeline to pass the data through transformers to extract the features and label and pass this to a decision tree estimator to fit the model \n\n**Q5: Create the Pipeline to train the decision tree**\n\n",
      "user": "anonymous",
      "dateUpdated": "2024-11-04T09:53:58+0000",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionSupport": false
        },
        "colWidth": 12,
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "<div class=\"markdown-body\">\n<p>Set up a pipeline to pass the data through transformers to extract the features and label and pass this to a decision tree estimator to fit the model</p>\n<p><strong>Q5: Create the Pipeline to train the decision tree</strong></p>\n\n</div>"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1730711950526_1989964770",
      "id": "20170601-154525_1033166149",
      "dateCreated": "2024-11-04T09:19:10+0000",
      "dateStarted": "2024-11-04T09:53:58+0000",
      "dateFinished": "2024-11-04T09:53:58+0000",
      "status": "FINISHED",
      "$$hashKey": "object:150325"
    },
    {
      "title": "Set up pipeline with  feature transformers and model estimator",
      "text": "%spark\n\n// put treeClassifier in a Pipeline here.\n val pipeline = new Pipeline()\n      .setStages(Array(ipindexer, labelindexer, assembler, dTree))",
      "user": "anonymous",
      "dateUpdated": "2024-11-04T10:40:01+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34mpipeline\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.Pipeline\u001b[0m = pipeline_eeff45e42fbc\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1730711950526_705146697",
      "id": "20170508-151557_1422077156",
      "dateCreated": "2024-11-04T09:19:10+0000",
      "dateStarted": "2024-11-04T10:40:01+0000",
      "dateFinished": "2024-11-04T10:40:01+0000",
      "status": "FINISHED",
      "$$hashKey": "object:150326"
    },
    {
      "text": "%md\r\nSpark ML supports k-fold cross validation with a transformation/estimation pipeline to try out different combinations of parameters, using a process called grid search. \r\nYou set up a CrossValidator with the parameters to test, an estimator and evaluator for a model selection workflow.\r\n",
      "user": "anonymous",
      "dateUpdated": "2024-11-04T09:57:22+0000",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "<div class=\"markdown-body\">\n<p>Spark ML supports k-fold cross validation with a transformation/estimation pipeline to try out different combinations of parameters, using a process called grid search.<br />\nYou set up a CrossValidator with the parameters to test, an estimator and evaluator for a model selection workflow.</p>\n\n</div>"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1730711950526_1749649830",
      "id": "20170531-154658_1298817002",
      "dateCreated": "2024-11-04T09:19:10+0000",
      "dateStarted": "2024-11-04T09:57:22+0000",
      "dateFinished": "2024-11-04T09:57:22+0000",
      "status": "FINISHED",
      "$$hashKey": "object:150327"
    },
    {
      "title": "set up a CrossValidator with the parameters to test, an estimator and evaluator for a model selection",
      "text": "%spark\n\n// set param grid to Search through decision tree's maxDepth parameter for best model\n// Deeper trees are potentially more accurate, but are also more likely to overfit.\n val paramGrid = new ParamGridBuilder().addGrid(dTree.maxDepth, Array( 4, 5, 6)).build()\n val evaluator = new BinaryClassificationEvaluator()\n      .setLabelCol(\"label\")\n      .setRawPredictionCol(\"prediction\")\n\n// Set up 3-fold cross validation with paramGrid\n val crossval = new CrossValidator().setCollectSubModels(true).setEstimator(pipeline)\n      .setEvaluator(evaluator)\n      .setEstimatorParamMaps(paramGrid).setNumFolds(5)",
      "user": "anonymous",
      "dateUpdated": "2024-11-04T09:57:29+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34mparamGrid\u001b[0m: \u001b[1m\u001b[32mArray[org.apache.spark.ml.param.ParamMap]\u001b[0m =\nArray({\n\tdtc_456d0a6142e8-maxDepth: 4\n}, {\n\tdtc_456d0a6142e8-maxDepth: 5\n}, {\n\tdtc_456d0a6142e8-maxDepth: 6\n})\n\u001b[1m\u001b[34mevaluator\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.evaluation.BinaryClassificationEvaluator\u001b[0m = BinaryClassificationEvaluator: uid=binEval_e4093c81abc4, metricName=areaUnderROC, numBins=1000\n\u001b[1m\u001b[34mcrossval\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.tuning.CrossValidator\u001b[0m = cv_939457e1072a\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1730711950526_344953118",
      "id": "20170508-151903_1365343172",
      "dateCreated": "2024-11-04T09:19:10+0000",
      "dateStarted": "2024-11-04T09:57:29+0000",
      "dateFinished": "2024-11-04T09:57:29+0000",
      "status": "FINISHED",
      "$$hashKey": "object:150328"
    },
    {
      "title": "Fit the model to the input data using K-fold cross validation",
      "text": "%spark\n\nval cvModel = crossval.fit(ntrain) // Model from k-fold cross validation",
      "user": "anonymous",
      "dateUpdated": "2024-11-04T09:58:12+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34mcvModel\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.tuning.CrossValidatorModel\u001b[0m = CrossValidatorModel: uid=cv_939457e1072a, bestModel=pipeline_6f4649f69821, numFolds=5\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=24",
              "$$hashKey": "object:153656"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=25",
              "$$hashKey": "object:153657"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=26",
              "$$hashKey": "object:153658"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=27",
              "$$hashKey": "object:153659"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=28",
              "$$hashKey": "object:153660"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=29",
              "$$hashKey": "object:153661"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=30",
              "$$hashKey": "object:153662"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=31",
              "$$hashKey": "object:153663"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=32",
              "$$hashKey": "object:153664"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=33",
              "$$hashKey": "object:153665"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=34",
              "$$hashKey": "object:153666"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=35",
              "$$hashKey": "object:153667"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=36",
              "$$hashKey": "object:153668"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=37",
              "$$hashKey": "object:153669"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=38",
              "$$hashKey": "object:153670"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=39",
              "$$hashKey": "object:153671"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=40",
              "$$hashKey": "object:153672"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=41",
              "$$hashKey": "object:153673"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=42",
              "$$hashKey": "object:153674"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=43",
              "$$hashKey": "object:153675"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=44",
              "$$hashKey": "object:153676"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=45",
              "$$hashKey": "object:153677"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=46",
              "$$hashKey": "object:153678"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=47",
              "$$hashKey": "object:153679"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=48",
              "$$hashKey": "object:153680"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=49",
              "$$hashKey": "object:153681"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=50",
              "$$hashKey": "object:153682"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=51",
              "$$hashKey": "object:153683"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=52",
              "$$hashKey": "object:153684"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=53",
              "$$hashKey": "object:153685"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=54",
              "$$hashKey": "object:153686"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=55",
              "$$hashKey": "object:153687"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=56",
              "$$hashKey": "object:153688"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=57",
              "$$hashKey": "object:153689"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=58",
              "$$hashKey": "object:153690"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=59",
              "$$hashKey": "object:153691"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=60",
              "$$hashKey": "object:153692"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=61",
              "$$hashKey": "object:153693"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=62",
              "$$hashKey": "object:153694"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=63",
              "$$hashKey": "object:153695"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=64",
              "$$hashKey": "object:153696"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=65",
              "$$hashKey": "object:153697"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=66",
              "$$hashKey": "object:153698"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=67",
              "$$hashKey": "object:153699"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=68",
              "$$hashKey": "object:153700"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=69",
              "$$hashKey": "object:153701"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=70",
              "$$hashKey": "object:153702"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=71",
              "$$hashKey": "object:153703"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=72",
              "$$hashKey": "object:153704"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=73",
              "$$hashKey": "object:153705"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=74",
              "$$hashKey": "object:153706"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=75",
              "$$hashKey": "object:153707"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=76",
              "$$hashKey": "object:153708"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=77",
              "$$hashKey": "object:153709"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=78",
              "$$hashKey": "object:153710"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=79",
              "$$hashKey": "object:153711"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=80",
              "$$hashKey": "object:153712"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=81",
              "$$hashKey": "object:153713"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=82",
              "$$hashKey": "object:153714"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=83",
              "$$hashKey": "object:153715"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=84",
              "$$hashKey": "object:153716"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=85",
              "$$hashKey": "object:153717"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=86",
              "$$hashKey": "object:153718"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=87",
              "$$hashKey": "object:153719"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=88",
              "$$hashKey": "object:153720"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=89",
              "$$hashKey": "object:153721"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=90",
              "$$hashKey": "object:153722"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=91",
              "$$hashKey": "object:153723"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=92",
              "$$hashKey": "object:153724"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=93",
              "$$hashKey": "object:153725"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=94",
              "$$hashKey": "object:153726"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=95",
              "$$hashKey": "object:153727"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=96",
              "$$hashKey": "object:153728"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=97",
              "$$hashKey": "object:153729"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=98",
              "$$hashKey": "object:153730"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=99",
              "$$hashKey": "object:153731"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=100",
              "$$hashKey": "object:153732"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=101",
              "$$hashKey": "object:153733"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=102",
              "$$hashKey": "object:153734"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=103",
              "$$hashKey": "object:153735"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=104",
              "$$hashKey": "object:153736"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=105",
              "$$hashKey": "object:153737"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=106",
              "$$hashKey": "object:153738"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=107",
              "$$hashKey": "object:153739"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=108",
              "$$hashKey": "object:153740"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=109",
              "$$hashKey": "object:153741"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=110",
              "$$hashKey": "object:153742"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=111",
              "$$hashKey": "object:153743"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=112",
              "$$hashKey": "object:153744"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=113",
              "$$hashKey": "object:153745"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=114",
              "$$hashKey": "object:153746"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=115",
              "$$hashKey": "object:153747"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=116",
              "$$hashKey": "object:153748"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=117",
              "$$hashKey": "object:153749"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=118",
              "$$hashKey": "object:153750"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=119",
              "$$hashKey": "object:153751"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=120",
              "$$hashKey": "object:153752"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=121",
              "$$hashKey": "object:153753"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=122",
              "$$hashKey": "object:153754"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=123",
              "$$hashKey": "object:153755"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=124",
              "$$hashKey": "object:153756"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=125",
              "$$hashKey": "object:153757"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=126",
              "$$hashKey": "object:153758"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=127",
              "$$hashKey": "object:153759"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=128",
              "$$hashKey": "object:153760"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=129",
              "$$hashKey": "object:153761"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=130",
              "$$hashKey": "object:153762"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=131",
              "$$hashKey": "object:153763"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=132",
              "$$hashKey": "object:153764"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=133",
              "$$hashKey": "object:153765"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=134",
              "$$hashKey": "object:153766"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=135",
              "$$hashKey": "object:153767"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=136",
              "$$hashKey": "object:153768"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=137",
              "$$hashKey": "object:153769"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=138",
              "$$hashKey": "object:153770"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=139",
              "$$hashKey": "object:153771"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=140",
              "$$hashKey": "object:153772"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=141",
              "$$hashKey": "object:153773"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=142",
              "$$hashKey": "object:153774"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=143",
              "$$hashKey": "object:153775"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=144",
              "$$hashKey": "object:153776"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=145",
              "$$hashKey": "object:153777"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=146",
              "$$hashKey": "object:153778"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=147",
              "$$hashKey": "object:153779"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=148",
              "$$hashKey": "object:153780"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=149",
              "$$hashKey": "object:153781"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=150",
              "$$hashKey": "object:153782"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=151",
              "$$hashKey": "object:153783"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=152",
              "$$hashKey": "object:153784"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=153",
              "$$hashKey": "object:153785"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=154",
              "$$hashKey": "object:153786"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=155",
              "$$hashKey": "object:153787"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=156",
              "$$hashKey": "object:153788"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=157",
              "$$hashKey": "object:153789"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=158",
              "$$hashKey": "object:153790"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=159",
              "$$hashKey": "object:153791"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=160",
              "$$hashKey": "object:153792"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=161",
              "$$hashKey": "object:153793"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=162",
              "$$hashKey": "object:153794"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=163",
              "$$hashKey": "object:153795"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=164",
              "$$hashKey": "object:153796"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=165",
              "$$hashKey": "object:153797"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=166",
              "$$hashKey": "object:153798"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=167",
              "$$hashKey": "object:153799"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=168",
              "$$hashKey": "object:153800"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=169",
              "$$hashKey": "object:153801"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=170",
              "$$hashKey": "object:153802"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=171",
              "$$hashKey": "object:153803"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=172",
              "$$hashKey": "object:153804"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=173",
              "$$hashKey": "object:153805"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=174",
              "$$hashKey": "object:153806"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=175",
              "$$hashKey": "object:153807"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=176",
              "$$hashKey": "object:153808"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=177",
              "$$hashKey": "object:153809"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=178",
              "$$hashKey": "object:153810"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=179",
              "$$hashKey": "object:153811"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=180",
              "$$hashKey": "object:153812"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=181",
              "$$hashKey": "object:153813"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=182",
              "$$hashKey": "object:153814"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=183",
              "$$hashKey": "object:153815"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=184",
              "$$hashKey": "object:153816"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=185",
              "$$hashKey": "object:153817"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=186",
              "$$hashKey": "object:153818"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=187",
              "$$hashKey": "object:153819"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=188",
              "$$hashKey": "object:153820"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=189",
              "$$hashKey": "object:153821"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=190",
              "$$hashKey": "object:153822"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=191",
              "$$hashKey": "object:153823"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=192",
              "$$hashKey": "object:153824"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=193",
              "$$hashKey": "object:153825"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=194",
              "$$hashKey": "object:153826"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=195",
              "$$hashKey": "object:153827"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=196",
              "$$hashKey": "object:153828"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=197",
              "$$hashKey": "object:153829"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=198",
              "$$hashKey": "object:153830"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=199",
              "$$hashKey": "object:153831"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=200",
              "$$hashKey": "object:153832"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=201",
              "$$hashKey": "object:153833"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=202",
              "$$hashKey": "object:153834"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=203",
              "$$hashKey": "object:153835"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=204",
              "$$hashKey": "object:153836"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=205",
              "$$hashKey": "object:153837"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=206",
              "$$hashKey": "object:153838"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=207",
              "$$hashKey": "object:153839"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=208",
              "$$hashKey": "object:153840"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=209",
              "$$hashKey": "object:153841"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=210",
              "$$hashKey": "object:153842"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=211",
              "$$hashKey": "object:153843"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=212",
              "$$hashKey": "object:153844"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=213",
              "$$hashKey": "object:153845"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=214",
              "$$hashKey": "object:153846"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=215",
              "$$hashKey": "object:153847"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=216",
              "$$hashKey": "object:153848"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=217",
              "$$hashKey": "object:153849"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=218",
              "$$hashKey": "object:153850"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=219",
              "$$hashKey": "object:153851"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=220",
              "$$hashKey": "object:153852"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=221",
              "$$hashKey": "object:153853"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=222",
              "$$hashKey": "object:153854"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=223",
              "$$hashKey": "object:153855"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=224",
              "$$hashKey": "object:153856"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=225",
              "$$hashKey": "object:153857"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=226",
              "$$hashKey": "object:153858"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=227",
              "$$hashKey": "object:153859"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=228",
              "$$hashKey": "object:153860"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=229",
              "$$hashKey": "object:153861"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=230",
              "$$hashKey": "object:153862"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=231",
              "$$hashKey": "object:153863"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=232",
              "$$hashKey": "object:153864"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=233",
              "$$hashKey": "object:153865"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=234",
              "$$hashKey": "object:153866"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=235",
              "$$hashKey": "object:153867"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=236",
              "$$hashKey": "object:153868"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=237",
              "$$hashKey": "object:153869"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=238",
              "$$hashKey": "object:153870"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=239",
              "$$hashKey": "object:153871"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=240",
              "$$hashKey": "object:153872"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=241",
              "$$hashKey": "object:153873"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=242",
              "$$hashKey": "object:153874"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=243",
              "$$hashKey": "object:153875"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=244",
              "$$hashKey": "object:153876"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=245",
              "$$hashKey": "object:153877"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=246",
              "$$hashKey": "object:153878"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=247",
              "$$hashKey": "object:153879"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=248",
              "$$hashKey": "object:153880"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=249",
              "$$hashKey": "object:153881"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=250",
              "$$hashKey": "object:153882"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=251",
              "$$hashKey": "object:153883"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=252",
              "$$hashKey": "object:153884"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=253",
              "$$hashKey": "object:153885"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=254",
              "$$hashKey": "object:153886"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=255",
              "$$hashKey": "object:153887"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=256",
              "$$hashKey": "object:153888"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=257",
              "$$hashKey": "object:153889"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=258",
              "$$hashKey": "object:153890"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=259",
              "$$hashKey": "object:153891"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=260",
              "$$hashKey": "object:153892"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1730711950527_119924157",
      "id": "20170508-151926_10766097",
      "dateCreated": "2024-11-04T09:19:10+0000",
      "dateStarted": "2024-11-04T09:58:12+0000",
      "dateFinished": "2024-11-04T09:58:42+0000",
      "status": "FINISHED",
      "$$hashKey": "object:150329"
    },
    {
      "text": "%spark\n\ncvModel.subModels.foreach{println}",
      "user": "anonymous",
      "dateUpdated": "2024-11-04T09:58:56+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {
          "0": {
            "graph": {
              "mode": "table",
              "height": 167.25,
              "optionOpen": false
            }
          }
        },
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "[Lorg.apache.spark.ml.Model;@2cb31544\n[Lorg.apache.spark.ml.Model;@7a8f97a5\n[Lorg.apache.spark.ml.Model;@63e68e58\n[Lorg.apache.spark.ml.Model;@473ff6d9\n[Lorg.apache.spark.ml.Model;@7312c24f\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1730711950528_506476329",
      "id": "20181102-225417_1735489669",
      "dateCreated": "2024-11-04T09:19:10+0000",
      "dateStarted": "2024-11-04T09:58:56+0000",
      "dateFinished": "2024-11-04T09:58:56+0000",
      "status": "FINISHED",
      "$$hashKey": "object:150330"
    },
    {
      "title": "Display the Best model ",
      "text": "%spark\n\nval bestModel = cvModel.bestModel // retrieve only the best model\nprintln(\"The Best Model:\\n--------------------\")\n// Use Scala's asInstanceOf method to cast an instance to the desired type.\nval treeModel = bestModel.asInstanceOf[org.apache.spark.ml.PipelineModel].stages(3).asInstanceOf[DecisionTreeClassificationModel] // extract the decision tree model from the pipeline\nprintln(\"Learned classification tree model:\\n\" + treeModel.toDebugString) // print the decision tree: we can read the sequence of decision rules",
      "user": "anonymous",
      "dateUpdated": "2024-11-04T09:59:17+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "The Best Model:\n--------------------\nLearned classification tree model:\nDecisionTreeClassificationModel: uid=dtc_456d0a6142e8, depth=5, numNodes=43, numClasses=2, numFeatures=13\n  If (feature 3 <= 235.35)\n   If (feature 12 <= 3.5)\n    If (feature 1 in {1.0})\n     If (feature 10 <= 12.45)\n      If (feature 11 <= 2.5)\n       Predict: 0.0\n      Else (feature 11 > 2.5)\n       Predict: 1.0\n     Else (feature 10 > 12.45)\n      Predict: 0.0\n    Else (feature 1 not in {1.0})\n     If (feature 3 <= 211.2)\n      Predict: 1.0\n     Else (feature 3 > 211.2)\n      If (feature 5 <= 269.6)\n       Predict: 1.0\n      Else (feature 5 > 269.6)\n       Predict: 0.0\n   Else (feature 12 > 3.5)\n    If (feature 5 <= 250.35)\n     If (feature 3 <= 203.6)\n      Predict: 0.0\n     Else (feature 3 > 203.6)\n      If (feature 5 <= 132.95)\n       Predict: 0.0\n      Else (feature 5 > 132.95)\n       Predict: 1.0\n    Else (feature 5 > 250.35)\n     If (feature 9 <= 96.5)\n      If (feature 3 <= 226.8)\n       Predict: 1.0\n      Else (feature 3 > 226.8)\n       Predict: 0.0\n     Else (feature 9 > 96.5)\n      Predict: 0.0\n  Else (feature 3 > 235.35)\n   If (feature 2 <= 4.0)\n    If (feature 5 <= 167.7)\n     If (feature 3 <= 265.75)\n      If (feature 11 <= 2.5)\n       Predict: 0.0\n      Else (feature 11 > 2.5)\n       Predict: 1.0\n     Else (feature 3 > 265.75)\n      If (feature 10 <= 14.149999999999999)\n       Predict: 0.0\n      Else (feature 10 > 14.149999999999999)\n       Predict: 1.0\n    Else (feature 5 > 167.7)\n     Predict: 0.0\n   Else (feature 2 > 4.0)\n    If (feature 1 in {1.0})\n     If (feature 2 <= 33.5)\n      If (feature 2 <= 17.5)\n       Predict: 1.0\n      Else (feature 2 > 17.5)\n       Predict: 0.0\n     Else (feature 2 > 33.5)\n      Predict: 1.0\n    Else (feature 1 not in {1.0})\n     If (feature 3 <= 299.9)\n      Predict: 1.0\n     Else (feature 3 > 299.9)\n      Predict: 0.0\n\n\u001b[1m\u001b[34mbestModel\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.Model[_]\u001b[0m = pipeline_6f4649f69821\n\u001b[1m\u001b[34mtreeModel\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.classification.DecisionTreeClassificationModel\u001b[0m = DecisionTreeClassificationModel: uid=dtc_456d0a6142e8, depth=5, numNodes=43, numClasses=2, numFeatures=13\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1730711950528_1856253630",
      "id": "20170508-151947_197896730",
      "dateCreated": "2024-11-04T09:19:10+0000",
      "dateStarted": "2024-11-04T09:59:17+0000",
      "dateFinished": "2024-11-04T09:59:18+0000",
      "status": "FINISHED",
      "$$hashKey": "object:150331"
    },
    {
      "text": "%md\n\n**Q6: What are the two first features used in the decision tree based classification rule? Give their name with respect to the original dataset.**\n",
      "user": "anonymous",
      "dateUpdated": "2024-11-04T09:59:47+0000",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionSupport": false
        },
        "colWidth": 12,
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "<div class=\"markdown-body\">\n<p><strong>Q6: What are the two first features used in the decision tree based classification rule? Give their name with respect to the original dataset.</strong></p>\n\n</div>"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1730711950529_20443144",
      "id": "20181103-144402_1585087913",
      "dateCreated": "2024-11-04T09:19:10+0000",
      "dateStarted": "2024-11-04T09:59:47+0000",
      "dateFinished": "2024-11-04T09:59:48+0000",
      "status": "FINISHED",
      "$$hashKey": "object:150332"
    },
    {
      "title": "Fields Customer service calls and Total day minutes have high predictive power to determine a customer's likeliness to churn",
      "text": "%spark\r\r// Put here the command to print the original names of the features.\r\rprintln(\"Feature 3: \" +  featureCols(3) +  \" Feature 12: \" +  featureCols(12)) // print the name of the columns which appear first in the decision tree\r",
      "user": "anonymous",
      "dateUpdated": "2024-11-04T10:02:11+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "Feature 3: tdmins Feature 12: numcs\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1730711950529_345817598",
      "id": "20170524-231226_52953518",
      "dateCreated": "2024-11-04T09:19:10+0000",
      "dateStarted": "2024-11-04T10:02:11+0000",
      "dateFinished": "2024-11-04T10:02:12+0000",
      "status": "FINISHED",
      "$$hashKey": "object:150333"
    },
    {
      "text": "%md\n\nAu vue de l'affichage du meilleur arbre arbre dans la cellule ci-dessus, la première feature testée est la feature 3 (tdmins), la deuxième est la feature 12 (numcs).",
      "user": "anonymous",
      "dateUpdated": "2024-11-04T10:05:46+0000",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12,
        "editorMode": "ace/mode/markdown",
        "fontSize": 9,
        "editorHide": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "<div class=\"markdown-body\">\n<p>Au vue de l&rsquo;affichage du meilleur arbre arbre dans la cellule ci-dessus, la première feature testée est la feature 3 (tdmins), la deuxième est la feature 12 (numcs).</p>\n\n</div>"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1730714590021_1131429370",
      "id": "paragraph_1730714590021_1131429370",
      "dateCreated": "2024-11-04T10:03:10+0000",
      "dateStarted": "2024-11-04T10:05:46+0000",
      "dateFinished": "2024-11-04T10:05:46+0000",
      "status": "FINISHED",
      "$$hashKey": "object:150334"
    },
    {
      "text": "%md\r\nThe actual performance of the model can be determined using the test data set which has not been used for any training or cross-validation activities. \r\nWe'll transform the test set with the model pipeline, which will map the features according to the same recipe. \r\n",
      "user": "anonymous",
      "dateUpdated": "2024-11-04T10:06:14+0000",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "<div class=\"markdown-body\">\n<p>The actual performance of the model can be determined using the test data set which has not been used for any training or cross-validation activities.<br />\nWe&rsquo;ll transform the test set with the model pipeline, which will map the features according to the same recipe.</p>\n\n</div>"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1730711950529_1925259240",
      "id": "20170602-155317_1487132664",
      "dateCreated": "2024-11-04T09:19:10+0000",
      "dateStarted": "2024-11-04T10:06:14+0000",
      "dateFinished": "2024-11-04T10:06:14+0000",
      "status": "FINISHED",
      "$$hashKey": "object:150335"
    },
    {
      "text": "%md\n\n**Q7: Apply the learned transformer on the test dataset.**",
      "user": "anonymous",
      "dateUpdated": "2024-11-04T10:06:30+0000",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionSupport": false
        },
        "colWidth": 12,
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "<div class=\"markdown-body\">\n<p><strong>Q7: Apply the learned transformer on the test dataset.</strong></p>\n\n</div>"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1730711950529_1561491098",
      "id": "20181103-144553_531995722",
      "dateCreated": "2024-11-04T09:19:10+0000",
      "dateStarted": "2024-11-04T10:06:30+0000",
      "dateFinished": "2024-11-04T10:06:30+0000",
      "status": "FINISHED",
      "$$hashKey": "object:150336"
    },
    {
      "title": "Get Predictions from Test set and Evaluate",
      "text": "%spark\n\n// Put the command to compute the \"predictions\" hereafter.\n// The variable \"predictions\" will contrain the result of the transformer.\n\n//transform the test set with the model pipeline, which will map the features according to the same recipe\nval predictions = cvModel.transform(test)\n\n// schéma de l'ensemble \"test\"\ntest.printSchema()\n\n// schéma de l'ensemble des prédictions\npredictions.printSchema()\n",
      "user": "anonymous",
      "dateUpdated": "2024-11-04T10:43:21+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "root\n |-- state: string (nullable = true)\n |-- len: integer (nullable = true)\n |-- acode: string (nullable = true)\n |-- intlplan: string (nullable = true)\n |-- vplan: string (nullable = true)\n |-- numvmail: double (nullable = true)\n |-- tdmins: double (nullable = true)\n |-- tdcalls: double (nullable = true)\n |-- tdcharge: double (nullable = true)\n |-- temins: double (nullable = true)\n |-- tecalls: double (nullable = true)\n |-- techarge: double (nullable = true)\n |-- tnmins: double (nullable = true)\n |-- tncalls: double (nullable = true)\n |-- tncharge: double (nullable = true)\n |-- timins: double (nullable = true)\n |-- ticalls: double (nullable = true)\n |-- ticharge: double (nullable = true)\n |-- numcs: double (nullable = true)\n |-- churn: string (nullable = true)\n\nroot\n |-- state: string (nullable = true)\n |-- len: integer (nullable = true)\n |-- acode: string (nullable = true)\n |-- intlplan: string (nullable = true)\n |-- vplan: string (nullable = true)\n |-- numvmail: double (nullable = true)\n |-- tdmins: double (nullable = true)\n |-- tdcalls: double (nullable = true)\n |-- tdcharge: double (nullable = true)\n |-- temins: double (nullable = true)\n |-- tecalls: double (nullable = true)\n |-- techarge: double (nullable = true)\n |-- tnmins: double (nullable = true)\n |-- tncalls: double (nullable = true)\n |-- tncharge: double (nullable = true)\n |-- timins: double (nullable = true)\n |-- ticalls: double (nullable = true)\n |-- ticharge: double (nullable = true)\n |-- numcs: double (nullable = true)\n |-- churn: string (nullable = true)\n |-- iplanIndex: double (nullable = false)\n |-- label: double (nullable = false)\n |-- features: vector (nullable = true)\n |-- rawPrediction: vector (nullable = true)\n |-- probability: vector (nullable = true)\n |-- prediction: double (nullable = false)\n\n\u001b[1m\u001b[34mpredictions\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [state: string, len: int ... 24 more fields]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1730711950529_1337279988",
      "id": "20170508-155848_1997894070",
      "dateCreated": "2024-11-04T09:19:10+0000",
      "dateStarted": "2024-11-04T10:43:21+0000",
      "dateFinished": "2024-11-04T10:43:22+0000",
      "status": "FINISHED",
      "$$hashKey": "object:150337"
    },
    {
      "text": "%spark\n\npredictions.select(\"label\",\"prediction\", \"probability\").show",
      "user": "anonymous",
      "dateUpdated": "2024-11-04T10:07:35+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----+----------+--------------------+\n|label|prediction|         probability|\n+-----+----------+--------------------+\n|  1.0|       1.0|[0.12621359223300...|\n|  0.0|       0.0|[0.95744680851063...|\n|  0.0|       0.0|[0.94964028776978...|\n|  1.0|       1.0|[0.12621359223300...|\n|  1.0|       1.0|[0.12621359223300...|\n|  1.0|       1.0|[0.12621359223300...|\n|  1.0|       1.0|[0.23076923076923...|\n|  0.0|       0.0|[0.95744680851063...|\n|  1.0|       1.0|[0.12621359223300...|\n|  1.0|       1.0|[0.12621359223300...|\n|  1.0|       1.0|[0.12621359223300...|\n|  1.0|       1.0|           [0.0,1.0]|\n|  1.0|       1.0|[0.23076923076923...|\n|  1.0|       1.0|[0.12621359223300...|\n|  0.0|       1.0|[0.12621359223300...|\n|  1.0|       1.0|[0.12621359223300...|\n|  0.0|       0.0|[0.94964028776978...|\n|  1.0|       1.0|[0.12621359223300...|\n|  1.0|       1.0|[0.12621359223300...|\n|  1.0|       1.0|           [0.0,1.0]|\n+-----+----------+--------------------+\nonly showing top 20 rows\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=261",
              "$$hashKey": "object:155286"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1730711950529_48438762",
      "id": "20170602-160222_471240064",
      "dateCreated": "2024-11-04T09:19:10+0000",
      "dateStarted": "2024-11-04T10:07:35+0000",
      "dateFinished": "2024-11-04T10:07:36+0000",
      "status": "FINISHED",
      "$$hashKey": "object:150338"
    },
    {
      "text": "%md\nAccuracy is measured by the area under the ROC curve. The area measures the ability of the test to correctly classify true positives from false positives. A random predictor would have .5 accuracy. The closer the value is to 1 the better its predictions are. \n\n**Q8: Compute the area under the ROC curve in the following cell.**",
      "user": "anonymous",
      "dateUpdated": "2024-11-04T10:08:38+0000",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionSupport": false
        },
        "colWidth": 12,
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "<div class=\"markdown-body\">\n<p>Accuracy is measured by the area under the ROC curve. The area measures the ability of the test to correctly classify true positives from false positives. A random predictor would have .5 accuracy. The closer the value is to 1 the better its predictions are.</p>\n<p><strong>Q8: Compute the area under the ROC curve in the following cell.</strong></p>\n\n</div>"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1730711950529_1829461431",
      "id": "20170602-161538_1648758337",
      "dateCreated": "2024-11-04T09:19:10+0000",
      "dateStarted": "2024-11-04T10:08:38+0000",
      "dateFinished": "2024-11-04T10:08:38+0000",
      "status": "FINISHED",
      "$$hashKey": "object:150339"
    },
    {
      "text": "%spark\n\n// Put your command line to compute the variable \"accuracy\" hereafter\n\n//The evaluator will provide us with the score of the predictions by comparing the prediction to the label\nval accuracy = evaluator.evaluate(predictions)\n\nevaluator.explainParams()",
      "user": "anonymous",
      "dateUpdated": "2024-11-04T10:09:10+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34maccuracy\u001b[0m: \u001b[1m\u001b[32mDouble\u001b[0m = 0.8790945896209054\n\u001b[1m\u001b[34mres15\u001b[0m: \u001b[1m\u001b[32mString\u001b[0m =\nlabelCol: label column name (default: label, current: label)\nmetricName: metric name in evaluation (areaUnderROC|areaUnderPR) (default: areaUnderROC)\nnumBins: Number of bins to down-sample the curves (ROC curve, PR curve) in area computation. If 0, no down-sampling will occur. Must be >= 0. (default: 1000)\nrawPredictionCol: raw prediction (a.k.a. confidence) column name (default: rawPrediction, current: prediction)\nweightCol: weight column name. If this is not set or empty, we treat all instance weights as 1.0 (undefined)\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=262",
              "$$hashKey": "object:155390"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=263",
              "$$hashKey": "object:155391"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=264",
              "$$hashKey": "object:155392"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1730711950530_16315103",
      "id": "20170602-155622_1453197792",
      "dateCreated": "2024-11-04T09:19:10+0000",
      "dateStarted": "2024-11-04T10:09:10+0000",
      "dateFinished": "2024-11-04T10:09:11+0000",
      "status": "FINISHED",
      "$$hashKey": "object:150340"
    },
    {
      "text": "%md\n\nOn obtient une aire en dessous de la courbe ROC d'environ 0,88. Cette valeur étant proche de 1, on peut dire que les prédictions effectuées sont de bonne qualité : le modèle permet de bien discriminer la classe positive de la classe négatives.",
      "user": "anonymous",
      "dateUpdated": "2024-11-04T10:25:47+0000",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12,
        "editorMode": "ace/mode/markdown",
        "fontSize": 9,
        "editorHide": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "<div class=\"markdown-body\">\n<p>On obtient une aire en dessous de la courbe ROC d&rsquo;environ 0,88. Cette valeur étant proche de 1, on peut dire que les prédictions effectuées sont de bonne qualité : le modèle permet de bien discriminer la classe positive de la classe négatives.</p>\n\n</div>"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1730714980951_1707215979",
      "id": "paragraph_1730714980951_1707215979",
      "dateCreated": "2024-11-04T10:09:40+0000",
      "dateStarted": "2024-11-04T10:25:47+0000",
      "dateFinished": "2024-11-04T10:25:47+0000",
      "status": "FINISHED",
      "$$hashKey": "object:150341"
    },
    {
      "title": "More metrics (just for your information)",
      "text": "%spark\n\nval lp = predictions.select(\"label\", \"prediction\")\nval counttotal = predictions.count()\nval correct = lp.filter($\"label\" === $\"prediction\").count() // comparison between columns\nval wrong = lp.filter(not($\"label\" === $\"prediction\")).count()\nval ratioWrong = wrong.toDouble / counttotal.toDouble\nval ratioCorrect = correct.toDouble / counttotal.toDouble\nval truep = lp.filter($\"prediction\" === 0.0).filter($\"label\" === $\"prediction\").count() / counttotal.toDouble\nval truen = lp.filter($\"prediction\" === 1.0).filter($\"label\" === $\"prediction\").count() / counttotal.toDouble\nval falsep = lp.filter($\"prediction\" === 1.0).filter(not($\"label\" === $\"prediction\")).count() / counttotal.toDouble\nval falsen = lp.filter($\"prediction\" === 0.0).filter(not($\"label\" === $\"prediction\")).count() / counttotal.toDouble\nprintln(\"total count : \" + counttotal)\nprintln(\"correct : \" + correct)\nprintln(\"wrong: \" + wrong)\nprintln(\"ratio correct: \" + ratioCorrect)\nprintln(\"ratio true positive : \" + truep)\nprintln(\"ratio true negative : \" + truen)\nprintln(\"ratio wrong: \" + ratioWrong)\nprintln(\"ratio false positive : \" + falsep)\nprintln(\"ratio false negative : \" + falsen)\n",
      "user": "anonymous",
      "dateUpdated": "2024-11-04T10:18:51+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "total count : 667\ncorrect : 604\nwrong: 63\nratio correct: 0.9055472263868066\nratio true positive : 0.1199400299850075\nratio true negative : 0.7856071964017991\nratio wrong: 0.0944527736131934\nratio false positive : 0.022488755622188907\nratio false negative : 0.07196401799100449\n\u001b[1m\u001b[34mlp\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [label: double, prediction: double]\n\u001b[1m\u001b[34mcounttotal\u001b[0m: \u001b[1m\u001b[32mLong\u001b[0m = 667\n\u001b[1m\u001b[34mcorrect\u001b[0m: \u001b[1m\u001b[32mLong\u001b[0m = 604\n\u001b[1m\u001b[34mwrong\u001b[0m: \u001b[1m\u001b[32mLong\u001b[0m = 63\n\u001b[1m\u001b[34mratioWrong\u001b[0m: \u001b[1m\u001b[32mDouble\u001b[0m = 0.0944527736131934\n\u001b[1m\u001b[34mratioCorrect\u001b[0m: \u001b[1m\u001b[32mDouble\u001b[0m = 0.9055472263868066\n\u001b[1m\u001b[34mtruep\u001b[0m: \u001b[1m\u001b[32mDouble\u001b[0m = 0.1199400299850075\n\u001b[1m\u001b[34mtruen\u001b[0m: \u001b[1m\u001b[32mDouble\u001b[0m = 0.7856071964017991\n\u001b[1m\u001b[34mfalsep\u001b[0m: \u001b[1m\u001b[32mDouble\u001b[0m = 0.022488755622188907\n\u001b[1m\u001b[34mfalsen\u001b[0m: \u001b[1m\u001b[32mDouble\u001b[0m = 0.07196401799100449\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=265",
              "$$hashKey": "object:155504"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=266",
              "$$hashKey": "object:155505"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=267",
              "$$hashKey": "object:155506"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=268",
              "$$hashKey": "object:155507"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=269",
              "$$hashKey": "object:155508"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=270",
              "$$hashKey": "object:155509"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=271",
              "$$hashKey": "object:155510"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=272",
              "$$hashKey": "object:155511"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=273",
              "$$hashKey": "object:155512"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=274",
              "$$hashKey": "object:155513"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=275",
              "$$hashKey": "object:155514"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=276",
              "$$hashKey": "object:155515"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=277",
              "$$hashKey": "object:155516"
            },
            {
              "jobUrl": "http://cd8335ef260c:4040/jobs/job?id=278",
              "$$hashKey": "object:155517"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1730711950530_587981859",
      "id": "20170508-155935_1678385472",
      "dateCreated": "2024-11-04T09:19:10+0000",
      "dateStarted": "2024-11-04T10:18:51+0000",
      "dateFinished": "2024-11-04T10:18:54+0000",
      "status": "FINISHED",
      "$$hashKey": "object:150342"
    },
    {
      "text": "%spark\n",
      "user": "anonymous",
      "dateUpdated": "2024-11-04T10:18:51+0000",
      "progress": 0,
      "config": {
        "colWidth": 12,
        "fontSize": 9,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1730715531889_812716844",
      "id": "paragraph_1730715531889_812716844",
      "dateCreated": "2024-11-04T10:18:51+0000",
      "status": "READY",
      "$$hashKey": "object:150343"
    }
  ],
  "name": "CHABAUD_KRA_churn_prediction",
  "id": "2KE8NHGN4",
  "defaultInterpreterGroup": "spark",
  "version": "0.11.1",
  "noteParams": {},
  "noteForms": {},
  "angularObjects": {},
  "config": {
    "isZeppelinNotebookCronEnable": false,
    "looknfeel": "default",
    "personalizedMode": "false"
  },
  "info": {},
  "path": "/CHABAUD_KRA_churn_prediction"
}