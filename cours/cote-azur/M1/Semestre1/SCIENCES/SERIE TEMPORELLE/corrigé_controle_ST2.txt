#Sujet A

#1
#Non parce que la moyenne n'est pas constante.

#2a
data=scan(file="http://math.unice.fr/~rubentha/enseignement/data-sujet-a-1.dat")
x=ts(data,frequency=1)
x1=diff.ts(x,lag=20,difference=1)
plot(x1)
x2=diff.ts(x,lag=20,difference=2)
plot(x2)
x3=diff.ts(x,lag=20,difference=3)
plot(x3)
x4=diff.ts(x,lag=20,difference=4)
plot(x4)
x5=diff.ts(x,lag=20,difference=5)
plot(x5)
#2b
#On observe que x1, x2 ne sont pas nuls (x2 est en-dessous de 0) et que x3, x4 tournent autour de 0 (on considÃ¨re) qu'ils sont nuls. Donc le degrÃ© de la tendance est 2.

#3a 
x=BJsales
plot(x)
#On tente une mÃ©thode de Holt-Winters non saisonniÃ¨re parce qu'on ne voit pas de saisonalitÃ©, avec des coefficients alpha et beta proche de 1 pour ne pas prendre en compte les observations Ã©loignÃ©es (la tendance varie avec le temps).
#3b
xlisse=HoltWinters(x,alpha=0.8,beta=0.8,gamma=FALSE)
p=predict(xlisse,n.ahead=1)

#----------------------------------------------------------------------#

#Sujet B

#1
#Non parce que la variance augmente. 

#2a
data=scan(file="http://math.unice.fr/~rubentha/enseignement/data-sujet-b-1.dat")
x=ts(data)
acf(x,lag.max=40,type=c("correlation"))
#Le graphe est pÃ©riodique donc x a une composante saisonniÃ¨re.
#2b 
data=scan(file="http://math.unice.fr/~rubentha/enseignement/data-sujet-b-2.dat")
x=ts(data)
acf(x,lag.max=40,type=c("correlation"))
#Le graphe a l'air constant donc x a une tendance.

#3a
x=UKDriverDeaths
x_dec=decompose(x,type=c("additive"))
plot(x_dec$seasonal)
plot(x_dec$trend)
plot(x_dec$random)
#3b
#On choisit un niveau de test alpha=0,05.
Box.test(x,lag=20)
#On trouve p<2,2e-16 donc on rejette l'hypothÃ¨se "bruit blanc".

#----------------------------------------------------------------------#

#Sujet C
#1
#Les points (X_t,X_(t+1)) semblent corrÃ©lÃ©s si est impair mais pas si t pair, ce qui contredit la dÃ©finition de la stationnaritÃ©.

#2a
x=nhtemp
plot(x)
#On tente une mÃ©thode de Holt-Winters non saisonniÃ¨re parce qu'on ne voit pas de saisonalitÃ©, avec des coefficients alpha et beta proche de 1 pour ne pas   prendre en compte les observations Ã©loignÃ©es (la tendance varie avec le temps).
#2b
xlisse=HoltWinters(x,alpha=0.2,beta=0.2,gamma=FALSE)
p=predict(xlisse,n.ahead=1)

#3a
data=scan(file="http://math.unice.fr/~rubentha/enseignement/data-sujet-c-1.dat")
x=ts(data)
x1=diff.ts(x,lag=20,difference=1)
plot(x1)
x2=diff.ts(x,lag=20,difference=2)
plot(x2)
x3=diff.ts(x,lag=20,difference=3)
plot(x3)
x4=diff.ts(x,lag=20,difference=4)
plot(x4)
x5=diff.ts(x,lag=20,difference=5)
plot(x5)
#3b
#La suite est nulle Ã  partir de x2. Donc le degrÃ© cherchÃ© est 1.

#----------------------------------------------------------------------#

#Sujet D
#1
#Oui.

#2a
x=USAccDeaths
x_dec=decompose(x,type=c("additive"))
plot(x_dec$seasonal)
plot(x_dec$trend)
plot(x_dec$random)

#2b
#3b
#On choisit un niveau de test alpha=0,05.
Box.test(x,lag=20)
#On trouve p<2,2e-16 donc on rejette l'hypothÃ¨se "bruit blanc".

#3a
data=scan(file="http://math.unice.fr/~rubentha/enseignement/data-sujet-d-1.dat")
x=ts(data)
acf(x,lag.max=40,type=c("correlation"))
#Le graphe est pÃ©riodique donc x a une composante saisonniÃ¨re.
#3b
data=scan(file="http://math.unice.fr/~rubentha/enseignement/data-sujet-d-2.dat")
x=ts(data)
acf(x,lag.max=40,type=c("correlation"))
#Le graphe a l'air constant donc x a une tendance.