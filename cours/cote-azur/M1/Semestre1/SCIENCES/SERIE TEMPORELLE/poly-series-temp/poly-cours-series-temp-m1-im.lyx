#LyX 2.3 created this file. For more info see http://www.lyx.org/
\lyxformat 544
\begin_document
\begin_header
\save_transient_properties true
\origin unavailable
\textclass amsbook
\begin_preamble

%commandes S. Rubenthaler
\newcommand{\R}{\mathbb{R}}
\newcommand{\E}{\mathbb{E}}
\newcommand{\Comp}{\mathbb{C}}
\usepackage{bbm}
\newcommand{\var}{\mathbb{V}}
\newcommand{\1}{\mathbbm{1}}
\newcommand{\heta}{\hat{\eta}}
\newcommand{\hgamma}{\hat{\gamma}}
\newcommand{\Bor}{\mathcal{B}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\Xtn}{\tilde{X}^n}
\newcommand{\clawn}{\underset{n\rightarrow
+\infty}{\Longrightarrow}} 
\newcommand{\convn}{\underset{n\rightarrow
+\infty}{\longrightarrow}} 
 \newcommand{\p}{\mathbb{P}}
\newcommand{\pperp}{\perp \! \! \! \perp}
\newcommand{\lam}{\lambda}
\newcommand{\convps}{\underset{n\rightarrow +\infty}{\overset{\text{p.s.}}{\longrightarrow}}}
\newcommand{\convpsm}{\underset{m\rightarrow +\infty}{\overset{\text{p.s.}}{\longrightarrow}}}
\newcommand{\convproba}{\underset{n\rightarrow +\infty}{\overset{\text{proba.}}{\longrightarrow}}}
\newcommand{\convloi}{\underset{n\rightarrow +\infty}{\overset{\text{loi}}{\longrightarrow}}}
\newcommand{\convlp}{\underset{n\rightarrow +\infty}{\overset{L^p}{\longrightarrow}}}
\newcommand{\convldeux}{\underset{n\rightarrow +\infty}{\overset{L^2}{\longrightarrow}}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\simU}{\sim \mathcal{U}([0;1])}
\DeclareMathOperator*{\argmin}{arg\,min}
\DeclareMathOperator*{\argmax}{arg\,max}
\DeclareMathOperator*{\Id}{Id}
\DeclareMathOperator*{\Var}{Var}
\DeclareMathOperator*{\cov}{Cov}

\date{}

\usepackage{a4wide}
\usepackage{algorithm}

\usepackage{appendix}
\usepackage{hyperref}
\usepackage{url}
\usepackage{fancyhdr}




%\usepackage{enumitem}
\allowdisplaybreaks

%\usepackage{geometry}
%\geometry{bindingoffset=2cm}

\numberwithin{equation}{chapter}
\numberwithin{algorithm}{chapter}



%Pour numéroter les exercices indépendamment :
\let\xca\@undefined
\theoremstyle{definition}
\newtheorem{xca}{\protect\exercisename}
\numberwithin{xca}{chapter}

%Pour changer le nom de l'environnement "algorithm"
\floatname{algorithm}{Programme}

\fancyhead[R]{}
\fancyhead[L]{ \includegraphics[width=4cm]{figures/logo-_uns_membre_uca_quadri.png} }
\renewcommand{\headrulewidth}{0pt}
\end_preamble
\use_default_options false
\begin_removed_modules
eqs-within-sections
\end_removed_modules
\begin_modules
theorems-ams
figs-within-sections
theorems-chap
\end_modules
\maintain_unincluded_children false
\language french
\language_package default
\inputencoding auto
\fontencoding global
\font_roman "default" "default"
\font_sans "default" "default"
\font_typewriter "default" "default"
\font_math "auto" "auto"
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100 100
\font_tt_scale 100 100
\use_microtype false
\use_dash_ligatures true
\graphics default
\default_output_format pdf2
\output_sync 1
\output_sync_macro "\synctex=-1"
\bibtex_command default
\index_command default
\paperfontsize default
\spacing single
\use_hyperref false
\pdf_bookmarks true
\pdf_bookmarksnumbered false
\pdf_bookmarksopen false
\pdf_bookmarksopenlevel 1
\pdf_breaklinks false
\pdf_pdfborder false
\pdf_colorlinks true
\pdf_backref section
\pdf_pdfusetitle true
\papersize a4paper
\use_geometry false
\use_package amsmath 2
\use_package amssymb 2
\use_package cancel 1
\use_package esint 0
\use_package mathdots 0
\use_package mathtools 1
\use_package mhchem 0
\use_package stackrel 1
\use_package stmaryrd 1
\use_package undertilde 1
\cite_engine basic
\cite_engine_type default
\biblio_style plain
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 0
\use_minted 0
\index Index
\shortcut idx
\color #008000
\end_index
\secnumdepth 3
\tocdepth 3
\paragraph_separation indent
\paragraph_indentation default
\is_math_indent 0
\math_numbering_side default
\quotes_style swiss
\dynamic_quotes 0
\papercolumns 1
\papersides 2
\paperpagestyle default
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\author 241130791 "Sylvain RUBENTHALER"
\end_header

\begin_body

\begin_layout Standard
\begin_inset Graphics
	filename figures/logo-_uns_membre_uca_quadri.png
	lyxscale 4
	scale 3.5

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
\align center

\shape smallcaps
\size huge
Séries chronologiques (avec 
\family typewriter
R
\family default
)
\begin_inset Newline newline
\end_inset

(Cours et exercices)
\begin_inset Newline newline
\end_inset

M1 IM, 2023-2024
\end_layout

\begin_layout Standard
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
\align center

\shape smallcaps
\size large
Sylvain Rubenthaler, Athanasios Vasilieiadis
\end_layout

\begin_layout Standard
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Graphics
	filename figures/couverture-poly.png
	lyxscale 50
	scale 45

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
thispagestyle{empty}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage pagebreak
\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
thispagestyle{empty}
\end_layout

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
null
\backslash
newpage
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage pagebreak
\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
pagenumbering{roman}
\backslash
pagestyle{plain}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset toc
LatexCommand tableofcontents

\end_inset


\end_layout

\begin_layout Chapter*
Préface
\end_layout

\begin_layout Standard
Ce polycopié s'inspire fortement de 
\begin_inset CommandInset citation
LatexCommand cite
key "jacques,oppenheim-philippe-viano"
literal "true"

\end_inset

.
 Les TP se feront en 
\family typewriter
R
\family default
,
\family typewriter
 
\family default
les exemples de programmes seront aussi donnés en 
\family typewriter
R
\family default
.
 Les corrigés des exercices sur tables sont inclus dans ce polycopié.
 Pour les corrigés des exercices sur ordinateur
\begin_inset space ~
\end_inset

: voir sur 
\begin_inset Flex URL
status open

\begin_layout Plain Layout

https://www.math.unice.fr/~rubentha/cours.html
\end_layout

\end_inset

.
 
\end_layout

\begin_layout Standard
Prérequis
\begin_inset space ~
\end_inset

: cours de L3 MASS d'introduction aux séries chronologiques et cours de
 L3 MASS de probabilités.
 
\end_layout

\begin_layout Standard
Important
\begin_inset space ~
\end_inset

: les fichiers sources sont disponibles sur : 
\begin_inset Flex URL
status open

\begin_layout Plain Layout

https://www.math.unice.fr/~rubentha/cours.html
\end_layout

\end_inset


\begin_inset Foot
status open

\begin_layout Plain Layout
sous licence 
\begin_inset Graphics
	filename figures/licence-cc.png

\end_inset


\end_layout

\end_inset

.
 J’encourage toute personne enseignant ce cours à utiliser ces fichiers
 et à ajouter son nom à la liste d’auteurs de ce polycopié.
 
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Standard
\begin_inset space ~
\end_inset


\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
pagenumbering{arabic}
\backslash
pagestyle{plain}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{otherlanguage}{french}
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
pagestyle{headings}
\end_layout

\end_inset


\end_layout

\begin_layout Chapter
Introduction
\begin_inset CommandInset label
LatexCommand label
name "chap:Introduction"

\end_inset


\end_layout

\begin_layout Definition
Une série temporelle (ou série chronologique) est une suite réelle finie
 
\begin_inset Formula $(x_{t})_{1\leq t\leq n}$
\end_inset

 (
\begin_inset Formula $n\in\N^{*}$
\end_inset

).
 L'indice 
\begin_inset Formula $t$
\end_inset

 représente une unité de temps (qui peut être le mois, l'année \SpecialChar ldots
).
 
\end_layout

\begin_layout Example
La figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:AirPassengers"

\end_inset

 représente le total mondial des passagers aériens par mois entre 1949 et
 1960.
 Noter que les points sont reliés par des traits (qui sont là pour faire
 joli et n'ont pas de signification particulière).
 Les données (
\family typewriter
AirPassengers
\family default
) sont disponibles dans 
\family typewriter
R
\family default
.
 
\begin_inset Float figure
placement h
wide false
sideways false
status open

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/airpassengers.png
	scale 70

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout

\family typewriter
\begin_inset CommandInset label
LatexCommand label
name "fig:AirPassengers"

\end_inset

AirPassengers
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Example
L'objectif de l'étude des séries temporelles est de faire des prédictions
 sur l'évolution de la série.
 Voici une liste non-exhaustive des modèles mathématiques que l'on pourra
 utiliser
\begin_inset space ~
\end_inset

:
\end_layout

\begin_layout Itemize
Régression.
 On suppose que 
\begin_inset Formula $x_{t}$
\end_inset

 est polynomial en 
\begin_inset Formula $t$
\end_inset

, par exemple 
\begin_inset Formula $x_{t}=\alpha_{2}t^{2}+\alpha_{1}t+\alpha_{0}+\epsilon_{t}$
\end_inset

 (avec 
\begin_inset Formula $\epsilon_{t}$
\end_inset

 un bruit aléatoire).
 On estime les coefficients par 
\begin_inset Formula $\widehat{\alpha}_{2}$
\end_inset

, 
\begin_inset Formula $\widehat{\alpha}_{1}$
\end_inset

, 
\begin_inset Formula $\widehat{\alpha}_{0}$
\end_inset

 (à partir des valeurs 
\begin_inset Formula $x_{1},\dots,x_{n}$
\end_inset

).
 Ainsi, avec la donnée de 
\begin_inset Formula $x_{1},\dots,x_{n}$
\end_inset

, on fera la prédiction 
\begin_inset Formula $\widehat{x}_{n+1}=\widehat{\alpha}_{2}(n+1)^{2}+\widehat{\alpha}_{1}(n+1)+\widehat{\alpha}_{0}$
\end_inset

 de la valeur 
\begin_inset Formula $x_{n+1}$
\end_inset

.
\end_layout

\begin_layout Itemize
Lissages exponentiels (voir chapitre suivant).
\end_layout

\begin_layout Itemize
Modèles ARMA, qui consistent à enlever de la série les tendances et la saisonnal
ité (=périodicité).
 Ces modèles sont plus lourds numériquement, mais plus performants.
 
\end_layout

\begin_layout Standard
Les défis à relever (dans l'ordre)
\begin_inset space ~
\end_inset

:
\end_layout

\begin_layout Itemize
Définir un modèle avec un nombre fini de paramètres.
\end_layout

\begin_layout Itemize
Estimer les paramètres du modèle.
\end_layout

\begin_layout Itemize
Vérifier la qualité de l'ajustement du modèle, comparer différents modèles
 (on pourra découper les données en un échantillon d'apprentissage et un
 échantillon de test).
\end_layout

\begin_layout Itemize
Effectuer des prédictions.
\end_layout

\begin_layout Section
Tendances et composantes saisonnières 
\end_layout

\begin_layout Definition
On dit que la série admet une tendance
\begin_inset Index idx
status open

\begin_layout Plain Layout
Tendance
\end_layout

\end_inset

 si on peut écrire 
\begin_inset Formula $x_{t}=f(t)+\epsilon_{t}$
\end_inset

 avec 
\begin_inset Formula $f$
\end_inset

 une fonction fixée et 
\begin_inset Formula $(\epsilon_{t})$
\end_inset

 des bruits aléatoires.
 
\end_layout

\begin_layout Itemize
Si 
\begin_inset Formula $f(t)=\alpha t+\beta$
\end_inset

, on dit que la tendance est linéaire.
 Plus généralement, si 
\begin_inset Formula $x_{t}=\sum_{i=0}^{p}\alpha_{i}t^{i}$
\end_inset

, on dit que la tendance est polynomiale.
\end_layout

\begin_layout Itemize
Si 
\begin_inset Formula $f(t)$
\end_inset

 est périodique, on dit que la tendance est périodiqe.
 
\end_layout

\begin_layout Itemize
Si 
\begin_inset Formula $f(t)=s(t)+\alpha t+\beta$
\end_inset

 avec 
\begin_inset Formula $s$
\end_inset

 une fonction périodique on dit que la série a une tendance linéaire et
 une composante périodique (/saisonnière).
 (On remarque que ces définitions ne sont pas très cohérentes.)
\end_layout

\begin_layout Section
Indices descriptifs d'une série temporelle
\end_layout

\begin_layout Subsection
Indice de tendance centrale
\end_layout

\begin_layout Standard
Moyenne empirique
\begin_inset Index idx
status open

\begin_layout Plain Layout
Moyenne empirique
\end_layout

\end_inset


\begin_inset space ~
\end_inset

:
\begin_inset Formula $\overline{x}_{n}=\frac{1}{n}\sum_{t=1}^{n}x_{t}$
\end_inset

 .
\end_layout

\begin_layout Subsection
Indices de dispersion
\end_layout

\begin_layout Standard
Variance empirique
\begin_inset Index idx
status open

\begin_layout Plain Layout
Variance empirique
\end_layout

\end_inset


\begin_inset space ~
\end_inset

:
\begin_inset Formula $\widehat{\sigma}_{n}(0)=\frac{1}{n}\sum_{t=1}^{n}(x_{t}-\overline{x}_{n})^{2}$
\end_inset

 (sa racine carrée est l'écart-type empirique).
\end_layout

\begin_layout Subsection
Indices de dépendance
\end_layout

\begin_layout Standard
(qui renseignent sur la dépendance entre les données 
\begin_inset Formula $x_{t}$
\end_inset

)
\end_layout

\begin_layout Standard
Auto-covariance
\begin_inset Index idx
status open

\begin_layout Plain Layout
Auto-covariance empirique
\end_layout

\end_inset

 empirique d'ordre 
\begin_inset Formula $h$
\end_inset

 (
\begin_inset Formula $h$
\end_inset

 dans 
\begin_inset Formula $\N^{*}$
\end_inset

)
\begin_inset space ~
\end_inset

: 
\begin_inset Formula $\widehat{\sigma}_{n}(h)=\frac{1}{n-h}\sum_{t=1}^{n-h}(x_{t}-\overline{x}_{n})(x_{t+h}-\overline{x}_{n})$
\end_inset

 (
\begin_inset Formula $h<n$
\end_inset

 pour que la formule ait un sens).
\begin_inset Newline newline
\end_inset

Fonction d'auto-covariance empirique
\begin_inset Index idx
status open

\begin_layout Plain Layout
Fonction d'auto-covariance empirique
\end_layout

\end_inset


\begin_inset space ~
\end_inset

: 
\begin_inset Formula $h\mapsto\widehat{\sigma}_{n}(h)$
\end_inset

.
 
\end_layout

\begin_layout Standard
Auto-corrélation empirique
\begin_inset Index idx
status open

\begin_layout Plain Layout
Auto-corrélation empirique
\end_layout

\end_inset


\begin_inset space ~
\end_inset

: 
\begin_inset Formula $\widehat{\rho}_{n}(h)=\frac{\widehat{\sigma}_{n}(h)}{\widehat{\sigma}_{n}(0)}$
\end_inset

 (prend ses valeurs dans 
\begin_inset Formula $[-1;1]$
\end_inset

).
\end_layout

\begin_layout Standard
Fonction d'auto-corrélation empirique 
\begin_inset Index idx
status open

\begin_layout Plain Layout
Fonction d'auto-corrélation empirique
\end_layout

\end_inset


\begin_inset space ~
\end_inset

: 
\begin_inset Formula $h\mapsto\widehat{\rho}_{n}(h)$
\end_inset

.
\end_layout

\begin_layout Remark
Les quantités empiriques ci-dessus sont des estimateurs consistants de certaines
 grandeurs (c'est à dire qu'elles convergent vers certaines grandeurs quand
 
\begin_inset Formula $n\rightarrow+\infty$
\end_inset

).
 Les convergences sont basées sur des applications de la loi des grands
 nombres.
 En particulier, pour 
\begin_inset Formula $h$
\end_inset

 proche de 
\begin_inset Formula $n$
\end_inset

 (disons 
\begin_inset Formula $|n-h|<50$
\end_inset

), la quantité 
\begin_inset Formula $\widehat{\sigma}_{n}(h)$
\end_inset

 n'a pas beaucoup d'intérêt.
 
\end_layout

\begin_layout Remark
La représentation graphique deux nuage de points 
\begin_inset Formula $(x_{t},x_{t+1})_{1\leq t\leq n-1}$
\end_inset

 illustre la valeur de 
\begin_inset Formula $\widehat{\rho}_{n}(1)$
\end_inset

 (voir figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Auto-corrélations-empiriques"

\end_inset

).
 Plus le nuage est arrondi, plus 
\begin_inset Formula $\widehat{\rho}_{n}(1)$
\end_inset

 est proche de 
\begin_inset Formula $0$
\end_inset

.
 Plus le nuage est allongé, plus 
\begin_inset Formula $\widehat{\rho}_{n}(1)$
\end_inset

 est proche de 
\begin_inset Formula $1$
\end_inset

.
 Cette remarque est aussi valable pour les 
\begin_inset Formula $\widehat{\rho}_{n}(h)$
\end_inset

 avec 
\begin_inset Formula $h\geq2$
\end_inset

.
 
\begin_inset Float figure
placement h
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/cours-1-2.pdf
	scale 70

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Auto-corrélations empiriques
\begin_inset CommandInset label
LatexCommand label
name "fig:Auto-corrélations-empiriques"

\end_inset

 
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Proposition
\begin_inset CommandInset label
LatexCommand label
name "prop:conv-rho-chapeau"

\end_inset

Supposons 
\begin_inset Formula $x_{t}=a+bt+\epsilon_{t}$
\end_inset

, avec 
\begin_inset Formula $(\epsilon_{t})_{t\geq1}$
\end_inset

 une suite de variable aléatoires i.i.d.
 
\begin_inset Index idx
status open

\begin_layout Plain Layout
i.i.d.
\end_layout

\end_inset

 (indépendantes et identiquement distribuées) et 
\begin_inset Formula $a\neq0$
\end_inset

.
 Supposons que 
\begin_inset Formula $\E(\epsilon_{1}^{2})<\infty$
\end_inset

.
 Alors, pour 
\begin_inset Formula $h$
\end_inset

 fixé dans 
\begin_inset Formula $\N^{*}$
\end_inset

, 
\begin_inset Formula 
\[
\widehat{\rho}_{n}(h)\convps1\,.
\]

\end_inset


\end_layout

\begin_layout Proof
Notons 
\begin_inset Formula $\overline{\epsilon}_{n}=\frac{1}{n}(\epsilon_{1}+\epsilon_{2}+\dots+\epsilon_{n})$
\end_inset

.
 Nous avons
\begin_inset Formula 
\[
\overline{x}_{n}=\frac{1}{n}\sum_{t=1}^{n}(at+b+\epsilon_{t})=\frac{a(n+1)}{2}+b+\overline{\epsilon}_{t}\,.
\]

\end_inset

Fixons 
\begin_inset Formula $h\in\{1,2,\dots,n-1\}$
\end_inset

.
 Nous avons
\begin_inset Formula 
\begin{eqnarray*}
\widehat{\sigma}_{n}(h) & = & \frac{1}{n-h}\sum_{t=1}^{n-h}\left(a\left(t-\frac{n+1}{2}\right)+\epsilon_{t}-\overline{\epsilon}_{n}\right)\left(a\left(t+h-\frac{n+1}{2}\right)+\epsilon_{t+h}-\overline{\epsilon}_{n}\right)\\
 & = & \frac{1}{n-h}\sum_{t=1}^{n-h}\left[a^{2}\left(t-\frac{n+1}{2}\right)\left(t+h-\frac{n+1}{2}\right)+(\epsilon_{t}-\overline{\epsilon}_{n})(\epsilon_{t+h}-\overline{\epsilon}_{n})\right.\\
 &  & \left.+(\epsilon_{t}-\overline{\epsilon}_{n})a\left(t+h-\frac{n+1}{2}\right)+a\left(t-\frac{n+1}{2}\right)(\epsilon_{t+h}-\overline{\epsilon}_{n})\right]\,.
\end{eqnarray*}

\end_inset

Nous avons 
\begin_inset Formula 
\begin{eqnarray*}
\frac{1}{n-h}\sum_{t=1}^{n-h}(\epsilon_{t}-\overline{\epsilon}_{n})(\epsilon_{t+h}-\overline{\epsilon}_{n}) & = & \frac{1}{n-h}\left(\sum_{t=1}^{n}\epsilon_{t}\epsilon_{t+h}+\overline{\epsilon}_{n}^{2}-\overline{\epsilon}_{n}\epsilon_{t+h}-\epsilon_{t}\overline{\epsilon}_{n}\right)\,,
\end{eqnarray*}

\end_inset

et (par application de la loi de grands nombres), 
\begin_inset Formula 
\[
\frac{1}{n-h}\sum_{t=1}^{n-h}\epsilon_{t}\epsilon_{t+h}\convps\E(\epsilon_{1}\epsilon_{1+h})\,,
\]

\end_inset


\begin_inset Formula 
\[
\frac{n\overline{\epsilon}_{n}^{2}}{n-h}\convps\E(\epsilon_{1}^{2})\,,
\]

\end_inset


\begin_inset Formula 
\[
\frac{1}{n-h}\sum_{t=1}^{n-h}\overline{\epsilon}_{n}\epsilon_{t+h}\convps\E(\epsilon_{1})^{2}\,,
\]

\end_inset


\begin_inset Formula 
\[
\frac{1}{n-h}\sum_{t=1}^{n-h}\overline{\epsilon}_{n}\epsilon_{t}\convps\E(\epsilon_{1})^{2}\,.
\]

\end_inset

De plus, par Cauchy-Schwartz, 
\begin_inset Formula 
\begin{eqnarray*}
\left|\frac{1}{n-h}\sum_{t=1}^{n-h}(\epsilon_{t}-\overline{\epsilon}_{n})a\left(t+h-\frac{n+1}{2}\right)\right| & \leq & a\left(\frac{1}{n-h}\sum_{t=1}^{n-h}(\epsilon_{t}-\overline{\epsilon}_{n})^{2}\right)^{1/2}\\
 &  & \times\left(\frac{1}{n-h}\sum_{t=1}^{n-h}\left(t+h-\frac{n+1}{2}\right)^{2}\right)^{1/2}\\
 & \leq & a\left(\frac{1}{n-h}\sum_{t=1}^{n-h}(\epsilon_{t}-\overline{\epsilon}_{n})^{2}\right)^{1/2}\\
 &  & \times\left(\frac{1}{n-h}\left(n+h-\frac{n+1}{2}\right)^{2}\right)^{1/2}\,.
\end{eqnarray*}

\end_inset

Nous avons (par application de la loi de grands nombres)
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
prefix "v"
symbol "$\\Var$"
description "Variance"
literal "true"

\end_inset


\begin_inset CommandInset nomenclature
LatexCommand nomenclature
prefix "c"
symbol "$\\cov$"
description "Covariance"
literal "true"

\end_inset


\begin_inset Formula 
\[
\frac{1}{n-h}\sum_{t=1}^{n-h}(\epsilon_{t}-\overline{\epsilon}_{n})^{2}\convps\Var(\epsilon_{1})\,.
\]

\end_inset

Donc, p.s., 
\begin_inset Formula 
\[
\frac{1}{n-h}\sum_{t=1}^{n-h}(\epsilon_{t}-\overline{\epsilon}_{n})a\left(t+h-\frac{n+1}{2}\right)=O(n)\,.
\]

\end_inset

De même
\begin_inset Formula 
\[
\frac{1}{n-h}\sum_{t=1}^{n-h}a\left(t-\frac{n+1}{2}\right)(\epsilon_{t+h}-\overline{\epsilon}_{n})=O(n)\,.
\]

\end_inset

Nous avons
\begin_inset Formula 
\begin{multline*}
\frac{1}{n-h}\sum_{t=1}^{n-h}a^{2}\left(t-\frac{n+1}{2}\right)\left(t+h-\frac{n+1}{2}\right)\\
=\frac{a^{2}}{n-h}\sum_{t=1}^{n-h}\left[t^{2}+\frac{(n+1)^{2}}{4}+(h-(n+1))t+h\times\frac{n+1}{2}\right]\\
\mbox{(formule pour la somme des carrés)}=\frac{a^{2}}{n-h}\left(\frac{(2(n-h)+1)(n-h+1)(n-h)}{6}\right)+a^{2}\frac{(n+1)^{2}}{4}\\
-\frac{a^{2}(h-n-1)}{n-h}\frac{n(n+1)}{2}+a^{2}\frac{(n+1)}{2}=\frac{a^{2}}{3}n^{2}+\frac{a^{2}}{4}n^{2}+o(n^{2})\,.
\end{multline*}

\end_inset

Donc, p.s., 
\begin_inset Formula 
\[
\widehat{\sigma}_{n}(h)\underset{n\rightarrow+\infty}{\sim}\frac{7a^{2}}{12}n^{2}\,.
\]

\end_inset

Donc 
\begin_inset Formula 
\[
\widehat{\rho}_{n}(h)\convps1\,.
\]

\end_inset


\end_layout

\begin_layout Proposition
Sous les mêmes hypothèse que dans la proposition 
\begin_inset CommandInset ref
LatexCommand ref
reference "prop:conv-rho-chapeau"

\end_inset

, si 
\begin_inset Formula $x_{t}=a\cos(2\pi t/T)+\epsilon_{t}$
\end_inset

, avec 
\begin_inset Formula $a\neq0$
\end_inset

 et 
\begin_inset Formula $T\in\N^{*}$
\end_inset

, alors 
\begin_inset Formula 
\[
\widehat{\rho}_{n}(h)\convn\cos(2\pi h/T)
\]

\end_inset


\end_layout

\begin_layout Remark
\begin_inset CommandInset label
LatexCommand label
name "rem:analyse-sigma"

\end_inset

On admet ensuite que si l'auto-corrélation d'une série est constante, c'est
 qu'elle a une tendance linéaire et que si cette auto-corrélation est périodique
 de période 
\begin_inset Formula $T$
\end_inset

, alors la série a une composante périodique de période 
\begin_inset Formula $T$
\end_inset

.
 Les convergences décrites dans les propositions ci-dessus sont plus lentes
 quand 
\begin_inset Formula $h$
\end_inset

 est grand.
 On se limitera donc à 
\begin_inset Formula $h\leq20$
\end_inset

 (tant que cela permet d'observer quelques périodes dans le cas avec saisonnalit
é).
\end_layout

\begin_layout Section
Feuille d'exercices numéro 1 (durée
\begin_inset space ~
\end_inset

: 3h)
\end_layout

\begin_layout Subsection*
Préliminaires
\end_layout

\begin_layout Standard
Créer un fichier texte dans lequel vous répondrez clairement aux questions
 ci-dessous, en incluant vos codes 
\family typewriter
R
\family default
, les résultats obtenus sous 
\family typewriter
R
\family default
 (graphique y compris), vos interprétations, remarques ...
 Une fois ce TP fini, vous metterez en forme votre compte-rendu et l’exporterez
 au format pdf.
 
\end_layout

\begin_layout Subsection
Données de varicelle
\end_layout

\begin_layout Standard
Récupérer le fichier contenant le nombre de cas de varicelle relevés à New-York
 de janvier 1931 à juin 1972
\begin_inset Newline newline
\end_inset

 (
\begin_inset CommandInset href
LatexCommand href
name "https://math.unice.fr/~rubentha/enseignement/varicelle.dat"
target "https://math.unice.fr/~rubentha/enseignement/varicelle.dat"
type "file:"
literal "false"

\end_inset

).
\end_layout

\begin_layout Enumerate
Créer un objet de type série temporelle contenant cette série.
 Représenter graphiquement la série.
 (Voir appendice pour les instructions utiles en 
\family typewriter
R
\family default
.)
\end_layout

\begin_layout Enumerate
Analyser qualitativement cette série, c’est-à-dire repérer d’éventuelles
 tendances et/ou saisonnalités (changer d’échelle si besoin).
 
\end_layout

\begin_layout Enumerate
Quel est le nombre de cas de varicelle mensuel moyen ?
\end_layout

\begin_layout Enumerate
Tracer les 50 premières auto-corrélations.
 Interpréter ces résultats.
 
\end_layout

\begin_layout Enumerate
Tracer sur un même graphique, les évolutions mensuelles du nombre de cas
 de varicelle pour chaque année (une courbe pour chaque année, ce qui nous
 donnera un certain nombre de courbes superposées).
\end_layout

\begin_layout Enumerate
Tracer sur un graphique l’évolution annuelle du nombre de cas de varicelle.
 
\end_layout

\begin_layout Enumerate
Ces deux dernières questions vous permettent-elles d’améliorer vos conclusions
 de la question 2 ? 
\end_layout

\begin_layout Subsection
Simulations de séries temporelles 
\end_layout

\begin_layout Standard
On appelle 
\bar under
bruit blanc gaussien
\bar default
 une suite de variables aléatoires indépendantes et identiquement distribuées
 
\begin_inset Formula $(\epsilon_{t})_{t\in\N}$
\end_inset

 de loi normale centrée réduite.
\end_layout

\begin_layout Enumerate
Quelle est la fonction d’auto-corrélation d’un bruit blanc ? (On demande
 de calculer 
\begin_inset Formula $R(i,j)=\frac{\E(\epsilon_{i}\epsilon_{j})-\E(\epsilon_{i})\E(\epsilon_{j})}{\E(\epsilon_{i}^{2})-\E(\epsilon_{i})^{2}}$
\end_inset

 pour tous 
\begin_inset Formula $i,j$
\end_inset

.)
\end_layout

\begin_layout Enumerate
Simuler un bruit blanc gaussien de taille 100, et représenter le graphiquement.
 
\end_layout

\begin_layout Enumerate
On admet que 
\begin_inset Formula $R(i,j)$
\end_inset

 défini ci-dessus ne dépend que de 
\begin_inset Formula $j-i$
\end_inset

.
 La fonction d’auto-corrélation est la fonction qui à 
\begin_inset Formula $h\geq0$
\end_inset

 associe 
\begin_inset Formula $R(0,h)$
\end_inset

.
 Tracer la fonction d'auto-corrélation 
\emph on
empirique 
\emph default
(voir l'aide dans l'appendice ci-dessous).

\change_deleted 241130791 1694172922

\emph on
 
\change_unchanged

\end_layout

\begin_layout Enumerate
Recommencer les deux questions précédentes et observer la variabilité des
 résultats.
 Jouer sur la longueur de la série.
 
\end_layout

\begin_layout Enumerate
Simuler maintenant la série temporelle 
\begin_inset Formula $X(t)=0.5t+2\epsilon_{t}$
\end_inset

 avec 
\begin_inset Formula $\epsilon_{t}\sim\mathcal{N}(0,1)$
\end_inset

 (taille 
\begin_inset Formula $100$
\end_inset

).
\end_layout

\begin_layout Enumerate
Représenter graphiquement la série et interpréter-la qualitativement.
 
\end_layout

\begin_layout Enumerate
Faites de même pour 
\begin_inset Formula $X(t)=0.5t+\epsilon_{t}+3\cos(t\pi)$
\end_inset

 avec 
\begin_inset Formula $\epsilon_{t}\sim\mathcal{N}(0,1)$
\end_inset

.
 
\end_layout

\begin_layout Subsection
Appendice : mise en 
\begin_inset ERT
status open

\begin_layout Plain Layout

{
\backslash
oe}
\end_layout

\end_inset

uvre sous 
\family typewriter
R
\end_layout

\begin_layout Standard
Quelques fonctions 
\family typewriter
R
\family default
 utiles à l'étude des séries temporelles :
\end_layout

\begin_layout Itemize
Avant de charger le fichier dans 
\family typewriter
R
\family default
, taper l'adresse dans le navigateur pour le visualiser.
 Charger un fichier de données numériques en sautant les 
\family typewriter
k
\family default
 premières lignes (s'il y a du texte au début) : 
\family typewriter

\begin_inset Newline newline
\end_inset

data=scan(file=”donnee.dat”,skip=k)
\family default
.
 Définir le répertoire courant : 
\family typewriter

\begin_inset Newline newline
\end_inset

setwd(”~/Documents/”)
\family default
 (ici on veut ̂etre dans 
\family typewriter
~/Documents
\family default
), savoir quel est le répertoire courant : 
\family typewriter
getwd()
\family default
.

\family typewriter
 
\end_layout

\begin_layout Itemize
Créer un objet de type série temporelle : 
\family typewriter
serie <- ts (data,start,end,frequency)
\family default
.
 
\family typewriter
data
\family default
 contient le vecteur des données (un fichier contenant les données peut
 être mentionné en remplaçant data par 
\family typewriter
file=”donnees.dat”
\family default
), start et end mentionne les dates de début et de fin de la série (ex :
 
\family typewriter
start=c(1990,1)
\family default
 et 
\family typewriter
end=c(1999,6)
\family default
 pour des données allant de janvier 90 à juin 99), et enfin frequency mentionne
 le nombre de données par unité de temps (par exemple, si les dates de début
 et de fin sont des années, et que les données sont mensuelles, il faudra
 indiquer
\family typewriter
 frequency=12
\family default
).
  Découper une série temporelle de 
\family typewriter
c(i,j) 
\family default
à 
\family typewriter
c(k,l)
\family default
 :
\family typewriter
 xd<-window(x,c(i,j),c(k,l))
\family default
.
 Transformer une série temporelle en vecteur de nombres : 
\family typewriter
v=as.numeric(cp)
\family default
.
\end_layout

\begin_layout Itemize
Représenter graphiquement un objet de type série temporelle : 
\family typewriter
plot.ts(serie).
 
\end_layout

\begin_layout Itemize
La fonction 
\family typewriter
acf(x, lag.max = 10, type = c("correlation", "covariance"), plot = TRUE)
\family default
 calcule (et trace si l’option 
\family typewriter
plot
\family default
 est à 
\family typewriter
TRUE
\family default
) les lag.max premières auto-corrélations ou auto-covariances (choisir corrélatio
n OU covariance).
\end_layout

\begin_layout Standard
Quelques conseils utiles pour les graphiques en 
\family typewriter
R
\family default
 : 
\end_layout

\begin_layout Itemize
Pour représenter plusieurs courbes sur le même graphique, tracer la première
 à l’aide de la commande 
\family typewriter
plot
\family default
 qui créé la fenêtre graphique et y insère la courbe, puis tracer les autres
 courbes à l’aide de la commande 
\family typewriter
lines
\family default
 qui trace une courbe sur une fenêtre graphique existante.
 
\end_layout

\begin_layout Itemize
Pour partager la fenêtre graphique en plusieurs (
\family typewriter
n×p
\family default
) sous-graphes, utiliser la commande 
\family typewriter
par(mfrow=c(n,p))
\family default
.
 
\end_layout

\begin_layout Itemize
Préciser les limites des axes des graphiques : 
\family typewriter
plot(...,xlim=c(0,10),ylim=c(-10,10))
\family default
.
 
\end_layout

\begin_layout Itemize
Pour exporter les graphiques en 
\emph on
jpeg
\emph default
 (idem pour 
\emph on
bmp
\emph default
, 
\emph on
png
\emph default
), il faut lui procéder de la sorte 
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Enumerate

\family typewriter
jpeg(filename=“nomfichier%d.jpeg”)
\family default
, 
\end_layout

\begin_layout Enumerate
réaliser le graphique, 
\end_layout

\begin_layout Enumerate
la commande 
\family typewriter
dev.off()
\family default
 permet enfin de rediriger le dernier graphique tracé vers le fichier 
\family typewriter
nomfichier1.jpeg
\family default
, et ainsi de suite après chaque graphique.
 Le nom de fichier sera automatiquement incrémenté.
\end_layout

\end_deeper
\begin_layout Standard
Simulation de variables normales indépendantes : 
\family typewriter
x<-rnorm(n,mean=0,sd=1)
\family default
 renvoie une suite de variables normales indépendantes de moyenne 
\begin_inset Formula $0$
\end_inset

 et d'écart-type 
\begin_inset Formula $1$
\end_inset

.
\end_layout

\begin_layout Section
Corrigé de la feuille d'exercices numéro 1 
\begin_inset Argument 1
status open

\begin_layout Plain Layout
Corrigé de la feuille d'exercices numéro 1
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Données de varicelle
\end_layout

\begin_layout Enumerate
Regarder le fichier sur internet pour voir combien de lignes il faut sauter
 (taper l'adresse 
\family typewriter
http://...
 
\family default
dans la barre d'adresse).
 On peut ensuite le sauver sur l'ordinateur et le charger dans 
\family typewriter
R 
\family default
avec l'instruction 
\family typewriter
scan 
\family default
ou le charger directement dans 
\family typewriter
R 
\family default
(avec l'instruction 
\family typewriter
scan
\family default
 aussi).

\family typewriter
 
\family default
Instruction pour charger le fichier (en sautant la premiere ligne) 
\begin_inset space ~
\end_inset

:
\begin_inset Newline newline
\end_inset


\family typewriter
 data=scan(file=".../series-temp/varicelle.dat",skip=1), 
\begin_inset Newline newline
\end_inset

serie<-ts(data,frequency=12)
\begin_inset Newline newline
\end_inset


\family default
(bien mettre le chemin vers le fichier en entier).
 On choisit frequency=12 pour avoir les années en abscisses (les données
 sont mensuelles).
 Pour dessiner le graphique
\begin_inset space ~
\end_inset

: 
\family typewriter
plot.ts(serie)
\family default
.
 Voir le graphique dans la figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:varicelle"

\end_inset

.
\begin_inset Float figure
placement h
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../tp1/tp1_graphique1.png
	scale 60

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:varicelle"

\end_inset

varicelle
\end_layout

\end_inset


\end_layout

\end_inset

Pour exporter un ou plusieurs graphiques en jpeg : 
\family typewriter
jpeg (filename='~/.../tp1_graphique%d.jpeg') 
\family default
(bien mettre le chemin en entier), 
\family typewriter
plot.ts(serie)
\family default
, 
\family typewriter
plot ..., plot ..., dev.off().
\end_layout

\begin_layout Enumerate
On ne voit pas de tendance mais on voit une saisonnalité.
 Pour mieux voir la saisonnalité, on peut zoomer sur une durée plus petite
 (les 50 premiers mois) 
\begin_inset Newline newline
\end_inset

(
\family typewriter
serie_z<-ts(data,2,50),plot.ts(serie_z)
\family default
).
 Voir le graphique
\begin_inset space ~
\end_inset

: figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:zoom"

\end_inset

.
\begin_inset Float figure
placement h
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../tp1/tp1_graphique2.png
	scale 60

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:zoom"

\end_inset

zoom
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Enumerate
On fait 
\family typewriter
mean(serie) 
\family default
et on trouve 
\begin_inset Formula $732,4076$
\end_inset

.
\end_layout

\begin_layout Enumerate
On rentre l'intruction 
\family typewriter
acf(serie,lag.max=25,type=c('correlation'))
\family default
 et obtient le graphique de la figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:25-premières-autocorrélation"

\end_inset

.
\begin_inset Float figure
placement h
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../tp1/tp1_graphique-autocorrelation.png
	scale 60

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:25-premières-autocorrélation"

\end_inset

25 premières autocorrélation
\end_layout

\end_inset


\end_layout

\end_inset

La fonction d'autocorrélation est périodique, ce qui indique une périodicité
 dans la série temporelle.
 La ligne pointillée bleue indique le niveau en-dessous duquel la corrélation
 n'est plus statistiquement significative.
 
\end_layout

\begin_layout Enumerate
On utilise le code :
\begin_inset Newline newline
\end_inset


\family typewriter
png (filename='~/.../tp1_graphe-multiple.png')
\begin_inset Newline newline
\end_inset

cp<-window(serie,start=c(1,1),end=c(1,12))
\begin_inset Newline newline
\end_inset

v=as.numeric(cp)
\begin_inset Newline newline
\end_inset

plot(c(1:12),v,'l',xlim=c(0,13),ylim=c(0,3100))
\begin_inset Newline newline
\end_inset

for(i in 2:41) 
\begin_inset Newline newline
\end_inset

 {
\begin_inset Newline newline
\end_inset


\begin_inset space ~
\end_inset


\begin_inset space ~
\end_inset

 cp<-window(serie,start=c(i,1),end=c(i,12)) 
\begin_inset Newline newline
\end_inset


\begin_inset space ~
\end_inset


\begin_inset space ~
\end_inset

 v=as.numeric(cp) 
\begin_inset Newline newline
\end_inset


\begin_inset space ~
\end_inset


\begin_inset space ~
\end_inset

 lines(v) 
\begin_inset Newline newline
\end_inset

} 
\begin_inset Newline newline
\end_inset

 dev.off()
\begin_inset Newline newline
\end_inset


\family default
Remarquer la boucle, l'extraction des lignes avec la fonction 
\family typewriter
window
\family default
, la conversion en vecteur avec 
\family typewriter
as.numeric
\family default
.
 Voir le graphique dans la figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Graphes-superposés"

\end_inset

.
 
\begin_inset Float figure
placement h
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../tp1/tp1_graphe-multiple.png
	scale 60

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Graphes-superposés"

\end_inset

Graphes superposés
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Enumerate
Code pour l'évolution annuelle du nombre de cas de varicelle : 
\begin_inset Newline newline
\end_inset


\family typewriter
v=c();
\begin_inset Newline newline
\end_inset

 for (i in 1:41) 
\begin_inset Newline newline
\end_inset

{
\begin_inset Newline newline
\end_inset


\begin_inset space ~
\end_inset


\begin_inset space ~
\end_inset

cp<-window(serie,start=c(i,1),end=c(i,12)) 
\begin_inset Newline newline
\end_inset


\begin_inset space ~
\end_inset


\begin_inset space ~
\end_inset

v=c(v,sum(cp)) 
\begin_inset Newline newline
\end_inset

} 
\begin_inset Newline newline
\end_inset

plot(1:41,v)
\family default

\begin_inset Newline newline
\end_inset

Et on obtient le graphique : voir figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Par-année"

\end_inset

.
\begin_inset Float figure
placement h
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../tp1/tp1_graphe-annuel.png
	scale 60

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Par-année"

\end_inset

Par année
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Enumerate
Le dernier graphique semble indiquer une tendance décroissante.
 
\end_layout

\begin_layout Subsection
Simulation de série temporelle
\end_layout

\begin_layout Enumerate
Si on prend 
\begin_inset Formula $\epsilon_{1}$
\end_inset

, 
\begin_inset Formula $\epsilon_{2}$
\end_inset

, 
\begin_inset Formula $\epsilon_{3}$
\end_inset

 \SpecialChar ldots
 des variables i.i.d.
 de loi 
\begin_inset Formula $\mathcal{N}(0,1)$
\end_inset

 alors, pour tout 
\begin_inset Formula $i$
\end_inset

, 
\begin_inset Formula $\epsilon_{i}$
\end_inset

 est de variance 
\begin_inset Formula $1$
\end_inset

 et pour tout 
\begin_inset Formula $i\neq j$
\end_inset

, 
\begin_inset Formula $\E(\epsilon_{i}\epsilon_{j})-\E(\epsilon_{i})\E(\epsilon_{j})=0$
\end_inset

.
 Donc la fonction d'autocorrélation est la suivante
\begin_inset Formula 
\[
R(i,j)=\frac{\E(\epsilon_{i}\epsilon_{j})-\E(\epsilon_{i})\E(\epsilon_{j})}{\E(\epsilon_{i}^{2})-\E(\epsilon_{i})^{2}}=\begin{cases}
1 & \mbox{ si }i=j\\
0 & \mbox{sinon.}
\end{cases}
\]

\end_inset


\end_layout

\begin_layout Enumerate

\family typewriter
v=rnorm(100, mean = 0, sd = 1), plot(1:100,v) 
\family default
(voir le graphique dans la figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Bruit-blanc-gaussien."

\end_inset

)
\family typewriter

\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\align center

\family typewriter
\begin_inset Graphics
	filename ../tp1/tp1_bruit-blanc.png
	scale 60

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Bruit-blanc-gaussien."

\end_inset

Bruit blanc gaussien.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Enumerate

\family typewriter
acf(v,lag.max=24,type=c("correlation")) 
\family default
(voir le graphique dans la figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Autocorrelation-du-bruit"

\end_inset

)
\family typewriter

\begin_inset Float figure
placement h
wide false
sideways false
status open

\begin_layout Plain Layout
\align center

\family typewriter
\begin_inset Graphics
	filename ../tp1/tp1_correlation-bruit-blanc.png
	scale 60

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Autocorrelation-du-bruit"

\end_inset

Autocorrélation du bruit blanc.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Enumerate
On recommence avec une série de longueur 
\begin_inset Formula $1000$
\end_inset

, les corrélations sont plus petites, ce qui est attendu puisque les corrélation
s empiriques convergent vers la corrélation quand la taille de la série
 tend vers l'infini.
 En 
\begin_inset Formula $0$
\end_inset

, on n'a pas convergence vers 
\begin_inset Formula $0$
\end_inset

 puisque la corrélation vaut 
\begin_inset Formula $1$
\end_inset

.
 Voir le graphique dans la figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Longueur=."

\end_inset

.
 
\begin_inset Float figure
placement h
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "45col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename ../tp1/tp1_bruit-blanc-1000.png
	scale 40

\end_inset


\end_layout

\end_inset


\begin_inset Phantom HPhantom
status open

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "45col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename ../tp1/tp1_correlation-bruit-blanc-1000.png
	scale 40

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Longueur=."

\end_inset

Longueur=
\begin_inset Formula $1000$
\end_inset

.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Enumerate

\family typewriter
v=rnorm(100, mean = 0, sd = 1), t=1:100, x=0.5*t+2*v 
\family default
(Nous utilisons ici des manipulations vectorielles pour construire la suite
 
\begin_inset Formula $(X_{t})$
\end_inset

.)
\end_layout

\begin_layout Enumerate

\family typewriter
xs<-ts(x) 
\family default
(Nous convertissons 
\family typewriter
x 
\family default
en série temporelle par commodité.)
\family typewriter
, 
\begin_inset Newline newline
\end_inset

plot(xs), acf(xs,lag.max=25,type=c("correlation")).
 
\family default
Voir le graphique dans la figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Suite-à-tendance"

\end_inset

.
\begin_inset Float figure
placement h
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "45col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename ../tp1/tp1_tendance-croissante1.png
	scale 40

\end_inset


\end_layout

\end_inset


\begin_inset Phantom HPhantom
status open

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "45col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename ../tp1/tp1_tendance-croissante2.png
	scale 40

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Suite-à-tendance"

\end_inset

Suite à tendance croissante.
\end_layout

\end_inset


\end_layout

\end_inset

On repère une tendance croissante mais pas de saisonnalité (graphe de la
 série à gauche).
 Le graphe des corrélations (à droite) montre que les termes successifs
 de la suite sont très corrélés (et que donc il y a une tendance).
\end_layout

\begin_layout Enumerate

\family typewriter
t=1:100, v=rnorm(100, mean = 0, sd = 1), x=0.5*t+v+3*cos(pi*t),
\begin_inset Newline newline
\end_inset

 acf(xs,lag.max=24,type=c("correlation"))
\family default
(voir le graphique dans la figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Longueur=.-1"

\end_inset

)
\family typewriter
 
\family default

\begin_inset Float figure
placement h
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "45col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename ../tp1/tp1_question_7_1.png
	scale 40

\end_inset


\end_layout

\end_inset


\begin_inset Phantom HPhantom
status open

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "45col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename ../tp1/tp1_question_7_2.png
	scale 40

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Longueur=.-1"

\end_inset

Longueur=
\begin_inset Formula $1000$
\end_inset

.
\end_layout

\end_inset


\end_layout

\end_inset

On observe une tendance et une saisonnalité sur le graphe de gauche.
 On remarque que les deux caractéristiques (tendance et saisonnalité) sont
 mélangées dans le graphe de droite.
 
\end_layout

\begin_layout Chapter
Lissages exponentiels
\end_layout

\begin_layout Section
Lissage exponentiel simple
\begin_inset Index idx
status open

\begin_layout Plain Layout
Lissage exponentiel simple
\end_layout

\end_inset


\end_layout

\begin_layout Standard
On dispose de 
\begin_inset Formula $x_{1},\dots,x_{n}$
\end_inset

 et on veut estimer 
\begin_inset Formula $x_{n+h}$
\end_inset

 (
\begin_inset Formula $h\in\N^{*}$
\end_inset

).
 
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
prefix "n"
symbol "$\\N$"
description "Entiers naturels"
literal "true"

\end_inset


\begin_inset CommandInset nomenclature
LatexCommand nomenclature
prefix "z"
symbol "$\\Z$"
description "Entiers relatifs"
literal "true"

\end_inset


\begin_inset CommandInset nomenclature
LatexCommand nomenclature
prefix "r"
symbol "$\\R$"
description "Nombres réels"
literal "true"

\end_inset


\begin_inset CommandInset nomenclature
LatexCommand nomenclature
prefix "c"
symbol "$\\Comp$"
description "Nombres complexes\\\\"
literal "true"

\end_inset


\begin_inset CommandInset nomenclature
LatexCommand nomenclature
prefix "e"
symbol "$\\E$"
description "Espérance"
literal "true"

\end_inset


\begin_inset CommandInset nomenclature
LatexCommand nomenclature
prefix "p"
symbol "$\\p$"
description "Probabilité"
literal "true"

\end_inset

Pour 
\begin_inset Formula $\alpha\in]0;1[$
\end_inset

, on définit la prévision par lissage exponentiel simple 
\begin_inset Formula 
\[
\widehat{x}_{n,h}=\alpha\sum_{j=0}^{n-1}(1-\alpha)^{j}x_{n-j}
\]

\end_inset

(on fait en fait une moyenne pondérée des observations passées).
 
\end_layout

\begin_layout Remark
\begin_inset space ~
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
Plus 
\begin_inset Formula $\alpha$
\end_inset

 est petit
\begin_inset CommandInset label
LatexCommand label
name "rem:Plus--est"

\end_inset

, plus on donne d'importance aux observations anciennes.
 On remarque que 
\begin_inset Formula $\widehat{x}_{n,h}$
\end_inset

 ne dépend pas de 
\begin_inset Formula $h$
\end_inset

.
\end_layout

\begin_layout Itemize
La somme des poids ne fait pas 
\begin_inset Formula $1$
\end_inset

.
 
\end_layout

\begin_layout Itemize
La prédiction ne dépend pas de 
\begin_inset Formula $h$
\end_inset

.
\end_layout

\end_deeper
\begin_layout Standard
On peut calculer par récurrence à l'aide de la formule de mise à jour
\begin_inset space ~
\end_inset

:
\begin_inset Formula 
\[
\widehat{x}_{n,h}=\alpha x_{n}+(1-\alpha)\widehat{x}_{n-1,h}\,.
\]

\end_inset

Ces formules permettent de calculer rapidement (en limitant la complexité).
\end_layout

\begin_layout Lemma
La prédiction 
\begin_inset Formula $\widehat{x}_{n,h}$
\end_inset

 est (asymptotiquement) la solution de 
\begin_inset Formula 
\[
\widehat{x}_{n,h}=\argmin_{x}\sum_{j=0}^{n-1}(1-\alpha)^{j}(x_{n-j}-x)^{2}\,.
\]

\end_inset

C'est un problème de moindres carrés.
\end_layout

\begin_layout Proof
Soit 
\begin_inset Formula 
\[
f\,:\,x\mapsto\sum_{j=0}^{n-1}(1-\alpha)^{j}(x_{n-j}-x)^{2}\,.
\]

\end_inset

On commence par chercher les points critiques.
 Nous avons
\begin_inset space ~
\end_inset

:
\begin_inset Formula 
\[
f'(x)=-2\sum_{j=0}^{n-1}(1-\alpha)^{j}(x_{n-j}-x)\,.
\]

\end_inset

Donc 
\begin_inset Formula $f'$
\end_inset

 s'annule en 
\begin_inset Formula 
\[
x_{0}=\frac{\sum_{j=0}^{n-1}(1-\alpha)^{j}x_{n-j}}{\sum_{j=0}^{n-1}(1-\alpha)^{j}}=\frac{\alpha\sum_{j=0}^{n-1}(1-\alpha)^{j}x_{n-j}}{1-(1-\alpha)^{n}}\underset{n\rightarrow+\infty}{\sim}\alpha\sum_{j=0}^{n-1}(1-\alpha)^{j}x_{n-j}\,.
\]

\end_inset

Une étude rapide du tableau de variation de 
\begin_inset Formula $f$
\end_inset

 nous dit que 
\begin_inset Formula $x_{0}$
\end_inset

 est le minimum absolu.
 C'est à cause de l'équivalent que l'on dit que 
\begin_inset Formula $\widehat{x}_{n,h}$
\end_inset

 est la solution 
\begin_inset Quotes cld
\end_inset

asymptotique
\begin_inset Quotes crd
\end_inset

 du problème des moindes carrés.
 
\end_layout

\begin_layout Remark
Pour choisir 
\begin_inset Formula $\alpha$
\end_inset

, on peut se servir de la remarque 
\begin_inset CommandInset ref
LatexCommand ref
reference "rem:Plus--est"

\end_inset

 ou calculer, pour tout 
\begin_inset Formula $\alpha$
\end_inset

, les estimateurs calculés avec le paramètre 
\begin_inset Formula $\alpha$
\end_inset


\begin_inset space ~
\end_inset

: 
\begin_inset Formula $\widehat{x}_{t,h}(\alpha)$
\end_inset

.
 On regarde ensuite l'erreur quadratique
\begin_inset Formula 
\[
E_{2}(\alpha)=\sum_{t=1}^{n-h}(x_{t+h}-\widehat{x}_{t,h}(\alpha))^{2}\,.
\]

\end_inset

Si cette erreur est petite, c'est que le paramètre 
\begin_inset Formula $\alpha$
\end_inset

 produit des prédictions performantes, au vu des données 
\begin_inset Formula $x_{1},\dots,x_{n}$
\end_inset

.
 On peut choisir entre plusieurs paramètres 
\begin_inset Formula $\alpha_{1}$
\end_inset

, … , 
\begin_inset Formula $\alpha_{p}$
\end_inset

 en prenant 
\begin_inset Formula 
\[
\alpha=\argmin_{\alpha_{1},\dots,\alpha_{p}}E_{2}(\alpha_{i})\,.
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Comment
status collapsed

\begin_layout Plain Layout
On s'intéresse au prédiction de température maximale à Nice (prévision à
 24h).
 Notons 
\begin_inset Formula $\widehat{x}_{t,1}^{(1)}$
\end_inset

 la prévision de Météo France pour le jour 
\begin_inset Formula $t+1$
\end_inset

 (prévision donnée le jour 
\begin_inset Formula $t$
\end_inset

).
 Notons 
\begin_inset Formula $\widehat{x}_{t,1}^{(2)}=x_{t}$
\end_inset

 la prévision naïve qui consiste à prédire la température du jour (
\begin_inset Formula $x_{t}$
\end_inset

) pour le lendemain.
 Nous proposons deux calculs d'erreur d'évaluer nos prédictions
\begin_inset space ~
\end_inset

:
\begin_inset Formula 
\[
E_{1}(i)=\sum_{t=1}^{n}
\]

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Remark
\begin_inset Index idx
status open

\begin_layout Plain Layout
Prévisions météo
\end_layout

\end_inset

Notons 
\begin_inset Formula $x_{1},x_{2},\dots,x_{n}$
\end_inset

 la température à midi sur la promenade des Anglais (mesurée sous abri)
 pour 
\begin_inset Formula $n$
\end_inset

 jour.
 La série 
\begin_inset Formula $x_{1},\dots,x_{n}$
\end_inset

 est supposée prendre ses valeurs dans les entiers.
 Pour chaque 
\begin_inset Formula $t$
\end_inset

 dans 
\begin_inset Formula $\{1,2,\dots,n\}$
\end_inset

, on peut comparer 
\begin_inset Formula $x_{t+1}$
\end_inset

 avec une prédiction basée sur 
\begin_inset Formula $x_{1},\dots,x_{t}.$
\end_inset

 Nous nous intéressons à deux prédictions : 
\end_layout

\begin_deeper
\begin_layout Itemize
\begin_inset Formula $\widehat{x}_{t,1}^{(1)}$
\end_inset

 est la prédiction de Météo France, 
\end_layout

\begin_layout Itemize
\begin_inset Formula $\widehat{x}_{t,1}^{(2)}=x_{t}$
\end_inset

 (méthode naïve).
 
\end_layout

\end_deeper
\begin_layout Remark
Pour 
\begin_inset Formula $i=1,2$
\end_inset

, nous considérons deux erreurs
\begin_inset space ~
\end_inset

:
\begin_inset Formula 
\[
E_{1}(i)=\sum_{t=1}^{n-1}\1_{\widehat{x}_{t,1}^{(i)}=x_{t+1}}\,\text{(}E_{1}\text{ grand=bien)},
\]

\end_inset


\begin_inset Formula 
\[
E_{2}(i)=\sum_{t=1}^{n-1}(\widehat{x}_{t,1}^{(i)}-x_{t+1})^{2}\,\text{(}E_{2}\text{ petit=bien)}.
\]

\end_inset

En général, 
\begin_inset Formula $E_{1}(2)>E_{1}(1)$
\end_inset

, donc si on s'intéresse au critère 
\begin_inset Formula $E_{1}$
\end_inset

, pas besoin de prévision météo.
\end_layout

\begin_layout Example
Observons l'exemple du Tableau 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:Prévisions-météo"

\end_inset

.
 
\begin_inset Float table
placement h
wide false
sideways false
status open

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="4" columns="8">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Sa
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Di
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Lu
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Ma
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Me
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Je
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Ve
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Prévision de Météo France
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
26
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
24
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
24
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
25
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
25
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
24
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
23
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Température mesurée
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
24
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
25
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
25
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
25
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
23
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
23
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
22
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Température de la veille 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
21
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
24
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
25
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
25
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
25
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
23
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
23
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Prévisions météo
\begin_inset CommandInset label
LatexCommand label
name "tab:Prévisions-météo"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset

Nous avons 
\begin_inset Formula 
\[
E_{1}(1)=1\,,\,E_{1}(2)=3\,.
\]

\end_inset

Donc, pour l'erreur 
\begin_inset Formula $E_{1}$
\end_inset

, la méthode naïve est meilleure que les prévisions de Météo France.
 Par ailleurs
\begin_inset Formula 
\[
E_{2}(1)=4+1+1+0+4+1+1=12\,,
\]

\end_inset


\begin_inset Formula 
\[
E_{2}(2)=9+1+0+0+4+0+1=15\,.
\]

\end_inset

Donc, pour l'erreur 
\begin_inset Formula $E_{2}$
\end_inset

, la méthode naïve est moins bonne que les prévisions de Météo France.
 
\end_layout

\begin_layout Section
Lissage exponentiel double
\begin_inset Index idx
status open

\begin_layout Plain Layout
Lissage exponentiel double
\end_layout

\end_inset


\end_layout

\begin_layout Standard
On cherche à ajuster, à l'instant 
\begin_inset Formula $t$
\end_inset

, une droite d'équation
\begin_inset space ~
\end_inset

: 
\begin_inset Formula $y_{t}=a_{1}+a_{2}(t-n)$
\end_inset

.
 La prévision par lissage exponentiel double est la suivante (où 
\begin_inset Formula $\alpha\in]0;1[$
\end_inset

)
\begin_inset Formula 
\[
\widehat{x}_{n,h}=\widehat{a}_{1}+\widehat{a}_{2}h\,,
\]

\end_inset

où 
\begin_inset Formula $(\widehat{a}_{1},\widehat{a}_{2})$
\end_inset

 solution de 
\begin_inset Formula 
\[
(\widehat{a}_{1},\widehat{a}_{2})=\argmin_{(a_{1},a_{2})\in\R}\sum_{j=0}^{n-1}(1-\alpha)^{j}(x_{n-j}-(a_{1}+a_{2}j))^{2}\,.
\]

\end_inset


\end_layout

\begin_layout Lemma
Les solutions du problème de minimisation ci-dessus sont (asymptotiquement)
\begin_inset Formula 
\[
\left\{ \begin{array}{ccc}
\widehat{a}_{1} & = & -L_{2}(n)+2L_{1}(n)\\
\widehat{a}_{2} & = & \frac{\alpha}{1-\alpha}(-L_{2}(n)+L_{1}(n))\,,
\end{array}\right.
\]

\end_inset

où
\begin_inset Formula 
\[
\left\{ \begin{array}{ccc}
L_{1}(n) & = & \alpha\sum_{j=0}^{n-1}(1-\alpha)^{j}x_{n-j}\\
L_{2}(n) & = & \alpha\sum_{j=0}^{n-1}(1-\alpha)^{j}L_{1}(n-j)\,.
\end{array}\right.
\]

\end_inset

(On remarque qu'on a ici deux lissages exponentiels successifs.)
\end_layout

\begin_layout Remark
C'est parce que 
\begin_inset Formula $L_{2}$
\end_inset

 est un lissage exponentiel de 
\begin_inset Formula $L_{1}$
\end_inset

 qu'on parle de lissage exponentiel double.
 
\end_layout

\begin_layout Proof
Notons
\begin_inset Formula 
\[
C(a_{1},a_{2})=\sum_{j=0}^{n-1}(1-\alpha)^{j}(x_{n-j}-(a_{1}+a_{2}j))^{2}\,.
\]

\end_inset

On commence par chercher les points critiques de 
\begin_inset Formula $C$
\end_inset

.
 Nous avons
\begin_inset Formula 
\begin{eqnarray*}
\frac{\partial C}{\partial a_{1}}(a_{1},a_{2}) & = & -2\sum_{j=0}^{n-1}(1-\alpha)^{j}(x_{n-j}-(a_{1}+a_{2}j))\,,\\
\frac{\partial C}{\partial a_{2}}(a_{1},a_{2}) & = & -2\sum_{j=0}^{n-1}(1-\alpha)^{j}j(x_{n-j}-(a_{1}+aj))\,.
\end{eqnarray*}

\end_inset

Nous cherchons donc 
\begin_inset Formula $(a_{1},a_{2})$
\end_inset

 solutions du système 
\begin_inset Formula 
\begin{equation}
\left\{ \begin{array}{ccccccc}
-\sum_{j=0}^{n-1}(1-\alpha)^{j}x_{n-j} & + & \sum_{j=0}^{n-1}(1-\alpha)^{j}a_{1} & + & \sum_{j=0}^{n-1}(1-\alpha)^{j}ja_{2} & = & 0\\
-\sum_{j=0}^{n-1}(1-\alpha)^{j}jx_{n-j} & + & \sum_{j=0}^{n-1}(1-\alpha)^{j}ja_{1} & + & \sum_{j=0}^{n-1}(1-\alpha)^{j}j^{2}a_{2} & = & 0\,.
\end{array}\right.\label{eq:sys-01}
\end{equation}

\end_inset

Rappelons les formules
\begin_inset Formula 
\begin{eqnarray*}
\sum_{j=0}^{+\infty}(1-\alpha)^{j} & = & \frac{1}{\alpha}\,,\\
\sum_{j=0}^{+\infty}j(1-\alpha)^{j} & = & \frac{1-\alpha}{\alpha^{2}}\,,\\
\sum_{j=0}^{+\infty}j^{2}(1-\alpha)^{j} & = & \frac{(1-\alpha)(2-\alpha)}{\alpha^{3}}
\end{eqnarray*}

\end_inset

(que l'on peut retrouver facilement en manipulant des séries entières).
 On obtient donc, en remplaçant certaines sommes partielles de séries par
 leurs limites, 
\begin_inset Formula 
\begin{equation}
\left\{ \begin{array}{ccccccc}
-\alpha\sum_{j=0}^{n-1}(1-\alpha)^{j}x_{n-j} & + & a_{1} & + & \frac{1-\alpha}{\alpha}a_{2} & = & 0\\
-\alpha^{2}\sum_{j=0}^{n-1}(1-\alpha)^{j}jx_{n-j} & + & (1-\alpha)a_{1} & + & \frac{(1-\alpha)(2-\alpha)}{\alpha}a_{2} & = & 0\,.
\end{array}\right.\label{eq:sys-02}
\end{equation}

\end_inset

Attention, les systèmes (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:sys-01"

\end_inset

) et (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:sys-02"

\end_inset

) ne sont pas équivalents.
 Plus 
\begin_inset Formula $n$
\end_inset

 est grand, plus ils se ressemblent.
 Nous allons continuer le calcul à partir du système (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:sys-02"

\end_inset

) et c'est pour cela que l'on parle de solution 
\begin_inset Quotes cld
\end_inset

asymptotique
\begin_inset Quotes crd
\end_inset

 dans l'énoncé du lemme.
 Posons (pour tout 
\begin_inset Formula $n$
\end_inset

) 
\begin_inset Formula 
\[
\left\{ \begin{array}{cc}
L_{1}(n)= & \alpha\sum_{j=0}^{n-1}(1-\alpha)^{j}x_{n-j}\\
L_{2}(n)= & \alpha\sum_{j=0}^{n-1}(1-\alpha)^{j}L_{1}(n-j)\,.
\end{array}\right.
\]

\end_inset

Nous remarquons que
\begin_inset Formula 
\begin{eqnarray*}
L_{2}(n) & = & \alpha\sum_{j=0}^{n-1}(1-\alpha)^{j}L_{1}(n-j)\\
 & = & \alpha^{2}\sum_{j=0}^{n-1}(1-\alpha)^{j}\sum_{i=0}^{n-j-1}(1-\alpha)^{i}x_{n-j-i}\\
\mbox{(}k=i+j\mbox{)} & = & \alpha^{2}\sum_{k=0}^{n-1}x_{n-k}(1-\alpha)^{k}(k+1)\,.
\end{eqnarray*}

\end_inset

Le système devient alors
\begin_inset Formula 
\[
\left\{ \begin{array}{cc}
-L_{1}(n)+a_{1}+\frac{(1-\alpha)}{\alpha}a_{2} & =0\\
-L_{2}(n)+\alpha L_{1}(n)+(1-\alpha)a_{1}+\frac{(1-\alpha)(2-\alpha)}{\alpha}a_{2} & =0\,.
\end{array}\right.
\]

\end_inset

D'où 
\begin_inset Formula 
\begin{eqnarray*}
-L_{1}(n)(2-\alpha)+a_{1}(2-\alpha)+L_{2}(n)-\alpha L_{1}(n) & -(1-\alpha)a_{1}= & 0\\
-L_{2}(n)+2L_{1}(n) & = & a_{1}\,,
\end{eqnarray*}

\end_inset

et
\begin_inset Formula 
\begin{eqnarray*}
a_{2} & = & \frac{\alpha}{1-\alpha}(L_{1}(n)-a_{1})\\
 & = & \frac{\alpha}{1-\alpha}(L_{2}(n)-L_{1}(n))\,.
\end{eqnarray*}

\end_inset

Montrons que la fonction 
\begin_inset Formula $C$
\end_inset

 est convexe.
 Pour 
\begin_inset Formula $(a_{1},a_{2})$
\end_inset

 et 
\begin_inset Formula $(b_{1,}b_{2})$
\end_inset

 dans 
\begin_inset Formula $\R^{2}$
\end_inset

 et 
\begin_inset Formula $\lambda\in[0;1]$
\end_inset

, nous avons
\begin_inset Formula 
\begin{eqnarray*}
C(\lambda(a_{1},a_{2})+(1-\lambda)(b_{1},b_{2})) & = & \sum_{j=0}^{n-1}(1-\alpha)^{j}(x_{n-j}-(\lambda a_{1}+(1-\lambda)b_{1}+(\lambda a_{2}+(1-\lambda)b_{2})j))^{2}\\
 & = & \sum_{j=0}^{n-1}(1-\alpha)^{j}(\lambda(x_{n-j}-(a_{1}+ja_{2}))+(1-\lambda)(x_{n-j}-(b_{1}+jb_{2}))^{2}\\
\mbox{(convexité de la fonction carré)} & \leq & \sum_{j=0}^{n-1}(1-\alpha)^{j}[\lambda(x_{n-j}-(a_{1}+ja_{2}))^{2}\\
 &  & \,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,+(1-\lambda)(x_{n-j}-(b_{1}+jb_{2}))^{2}]\\
 & = & \lambda C(a_{1},a_{2})+(1-\lambda)C(b_{1},b_{2})\,.
\end{eqnarray*}

\end_inset

Ce qui montre que la fonction 
\begin_inset Formula $C$
\end_inset

 est convexe.
 L'unique point critique est donc le minimum absolu.
 
\end_layout

\begin_layout Standard
Les formules de mise à jour sont
\begin_inset Formula 
\begin{equation}
\left\{ \begin{array}{cc}
\widehat{a}_{1}(n)= & \widehat{a}_{1}(n-1)+\widehat{a}_{2}(n-1)+(2\alpha-\alpha^{2})(x_{n}-\widehat{x}_{n-1,1})\\
\widehat{a}_{2}(n)= & \widehat{a}_{2}(n-1)+\alpha^{2}(x_{n}-\widehat{x}_{n-1,1})\,,
\end{array}\right.\label{eq:maj-lissage-expo-double}
\end{equation}

\end_inset

 avec l'initialisation
\begin_inset Formula 
\[
\left\{ \begin{array}{cc}
\widehat{a}_{1}(0)= & x_{1}\\
\widehat{a}_{2}(0) & =x_{2}-x_{1}\,.
\end{array}\right.
\]

\end_inset

Ces formules permettent de comprendre comment calculer récursivement les
 coefficients (ce qui limite la complexité du calcul).
\end_layout

\begin_layout Section
Méthode de Holt-Winters
\end_layout

\begin_layout Subsection
Méthode non saisonnière
\end_layout

\begin_layout Standard
On cherche, au voisinage de l'instant 
\begin_inset Formula $n$
\end_inset

, à ajuster une droite d'équation
\begin_inset Formula 
\[
y_{t}=a_{1}+a_{2}(t-n)\,.
\]

\end_inset

La prévision en 
\begin_inset Formula $n+h$
\end_inset

 sera
\begin_inset Formula 
\[
\widehat{x}_{n,h}=\widehat{a}_{1}(n)+\widehat{a}_{2}(n)h\,.
\]

\end_inset

On choisit deux constantes de lissage 
\begin_inset Formula $\beta$
\end_inset

 et 
\begin_inset Formula $\alpha$
\end_inset

 dans 
\begin_inset Formula $]0;1[$
\end_inset

.
 Les 
\begin_inset Formula $\widehat{a}_{1}$
\end_inset

, 
\begin_inset Formula $\widehat{a}_{2}$
\end_inset

 sont calculés récursivement par
\begin_inset Formula 
\begin{equation}
\left\{ \begin{array}{cc}
\widehat{a}_{1}(n)= & \alpha x_{n}+(1-\alpha)(\widehat{a}_{1}(n-1)+\widehat{a}_{2}(n-1))\\
\widehat{a}_{2}(n)= & \beta(\widehat{a}_{1}(n)-\widehat{a}_{1}(n-1))+(1-\beta)\widehat{a}_{2}(n-1)\,.
\end{array}\right.\label{eq:maj-lissage-HW}
\end{equation}

\end_inset


\end_layout

\begin_layout Remark
Cette méthode est plus souple que la précédente.
 Le 
\begin_inset Formula $\alpha$
\end_inset

 joue un rôle dans l'estimée de l'ordonnée en 
\begin_inset Formula $n$
\end_inset

 et le 
\begin_inset Formula $\beta$
\end_inset

 joue un rôle dans l'estimée de la pente.
 
\end_layout

\begin_layout Remark
Plus 
\begin_inset Formula $\alpha$
\end_inset

 et 
\begin_inset Formula $\beta$
\end_inset

 sont petits, plus on tient compte du passé lointain.
 
\end_layout

\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Lemma
Pour obtenir un lissage exponentiel double de paramètre 
\begin_inset Formula $1-\alpha'$
\end_inset

 (qui n'a pas d'instruction dédiée dans 
\family typewriter
R
\family default
), il suffit de faire un lissage de Holt-Winters sans composante saisonnière
 avec
\begin_inset Formula 
\begin{equation}
\left\{ \begin{array}{ccc}
\alpha & = & 1-(\alpha')^{2}\\
\beta & = & \frac{1-\alpha'}{1+\alpha'}\,.
\end{array}\right.\label{eq:para-lissage-double}
\end{equation}

\end_inset

On retrouve le lissage exponentiel simple de paramètre 
\begin_inset Formula $\alpha$
\end_inset

 si 
\begin_inset Formula $\beta=0$
\end_inset

 (et 
\begin_inset Formula $\alpha\neq0$
\end_inset

).
 
\end_layout

\begin_layout Proof
\begin_inset Note Comment
status collapsed

\begin_layout Plain Layout
Pour un lissage de Holt-Winters de paramètres 
\begin_inset Formula $\alpha$
\end_inset

, 
\begin_inset Formula $\beta$
\end_inset

 vérifiant l'équation (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:para-lissage-double"

\end_inset

) ci-dessus pour un certain 
\begin_inset Formula $\alpha'$
\end_inset

 dans 
\begin_inset Formula $]0;1[$
\end_inset

, les formules de récursion prennent la forme
\end_layout

\end_inset

 Pour un lissage exponentiel double de paramètre 
\begin_inset Formula $1-\alpha'$
\end_inset

 dans 
\begin_inset Formula $]0;1[$
\end_inset

, on peut écrire les formules de mise à jour (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:maj-lissage-expo-double"

\end_inset

) sous la forme (on remarque au préalable que 
\begin_inset Formula $(1-\alpha')(2-(1-\alpha'))=1-(\alpha')^{2}$
\end_inset

, 
\begin_inset Formula 
\begin{eqnarray*}
\widehat{a}_{1}(n) & = & (\alpha')^{2}(\widehat{a}_{1}(n-1)+\widehat{a}_{2}(n-1))+(1-(\alpha')^{2})(x_{n}-\widehat{x}_{n-1,1}+\widehat{a}_{1}(n-1)+\widehat{a}_{2}(n-1))\\
 & = & (\alpha')^{2}(\widehat{a}_{1}(n-1)+\widehat{a}_{2}(n-1))+(1-(\alpha')^{2})x_{n}\\
\widehat{a}_{2}(n) & = & \widehat{a}_{2}(n-1)+\frac{(1-\alpha')^{2}}{1-(\alpha')^{2}}(\widehat{a}_{1}(n)-(\widehat{a}_{1}(n-1)+\widehat{a}_{2}(n-1))\\
 & = & \widehat{a}_{2}(n-1)+\left(\frac{1-\alpha'}{1+\alpha'}\right)\widehat{a}_{1}(n)\\
 &  & +(\widehat{a}_{1}(n-1)+\widehat{a}_{2}(n-1))\frac{(1-\alpha')}{1+\alpha'}\\
 & = & \widehat{a}_{2}(n-1)+\left(\frac{1-\alpha'}{1+\alpha'}\right)\widehat{a}_{1}(n)-(\widehat{a}_{1}(n-1)+\widehat{a}_{2}(n-1))\left(\frac{1-\alpha'}{1+\alpha'}\right)\\
 & = & (1-\beta)\widehat{a}_{2}(n-1)+\beta(\widehat{a}_{1}(n)-\widehat{a}_{1}(n-1))
\end{eqnarray*}

\end_inset

On retrouve bien la formule de mise à jour (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:maj-lissage-HW"

\end_inset

) avec 
\begin_inset Formula $\alpha=1-(\alpha')^{2}$
\end_inset

, 
\begin_inset Formula $\beta=\frac{1-\alpha'}{1+\alpha'}$
\end_inset

.
\end_layout

\begin_layout Subsection
Méthode saisonnière additive
\end_layout

\begin_layout Standard
On cherche, au voisinage de 
\begin_inset Formula $n$
\end_inset

, à ajuster une courbe d'équation
\begin_inset Formula 
\[
y_{t}=a_{1}+a_{2}(t-n)+s_{t}
\]

\end_inset

(avec 
\begin_inset Formula $s_{.}$
\end_inset

 périodique, de période 
\begin_inset Formula $T$
\end_inset

).
 Il faut choisir 
\begin_inset Formula $\alpha$
\end_inset

, 
\begin_inset Formula $\beta$
\end_inset

, 
\begin_inset Formula $\delta$
\end_inset

 dans 
\begin_inset Formula $]0;1[$
\end_inset

 (et aussi 
\begin_inset Formula $T$
\end_inset

).
 Les formules de récursion sont
\begin_inset Formula 
\[
\left\{ \begin{array}{cc}
\widehat{a}_{1}(n)= & \alpha(x_{n}-\widehat{s}_{n-T})+(1-\alpha)(\widehat{a}_{1}(n-1)+\widehat{a}_{2}(n-1))\\
\widehat{a}_{2}(n)= & \beta(\widehat{a}_{1}(n)-\widehat{a}_{1}(n-1))+(1-\beta)\widehat{a}_{2}(n-1))\\
\widehat{s}_{n}= & \delta(x_{n}-\widehat{a}_{1}(n))+(1-\delta)\widehat{s}_{n-T}\,.
\end{array}\right.
\]

\end_inset

La prévision prend la forme
\begin_inset Formula 
\[
\left\{ \begin{array}{cc}
\widehat{x}_{n,h}= & \widehat{a}_{1}(n)+h\widehat{a}_{2}(n)+\widehat{s}_{n+h-T}\,,\,1\leq h\leq T\\
\widehat{x}_{n,h}= & \widehat{a}_{1}(n)+h\widehat{a}_{2}(n)+\widehat{s}_{n+h-2T}\,,\,T+1\leq h\leq2T\\
\dots & \dots
\end{array}\right.
\]

\end_inset

Les valeurs initiales suivantes permettent de commencer le calcul à 
\begin_inset Formula $T+2$
\end_inset


\begin_inset Formula 
\[
\left\{ \begin{array}{cc}
\widehat{a}_{1}(T+1)= & x_{T+1}\\
\widehat{a}_{2}(T+1)= & \frac{x_{T+1}-x_{1}}{T}\\
\widehat{s}_{j}= & x_{j}-(x_{1}+(T-1)\widehat{a}_{2}(T+1))\,,\,1\leq j\leq T\,.
\end{array}\right.
\]

\end_inset


\end_layout

\begin_layout Subsection
Méthode saisonnière multiplicative
\end_layout

\begin_layout Standard
On cherche, au voisinage de 
\begin_inset Formula $n$
\end_inset

, à ajuster une courbe d'équation
\begin_inset Formula 
\[
y_{t}=\left(a_{1}+a_{2}(t-n)\right)\times s_{t}
\]

\end_inset

(avec 
\begin_inset Formula $s_{.}$
\end_inset

 périodique, de période 
\begin_inset Formula $T$
\end_inset

).
 Il faut choisir 
\begin_inset Formula $\alpha$
\end_inset

, 
\begin_inset Formula $\beta$
\end_inset

, 
\begin_inset Formula $\delta$
\end_inset

 dans 
\begin_inset Formula $]0;1[$
\end_inset

.
 Les formules de récursion sont
\begin_inset Formula 
\[
\left\{ \begin{array}{ccc}
\widehat{a}_{1}(n) & = & (1-\alpha)\frac{x_{n}}{\widehat{s}_{n-T}}+\alpha(\widehat{a}_{1}(n-1)+\widehat{a}_{2}(n-1))\\
\widehat{a}_{2}(n) & = & (1-\beta)(\widehat{a}_{1}(n)-\widehat{a}_{1}(n-1))+\beta\widehat{a}_{2}(n-1)\\
\widehat{s}_{n} & = & (1-\delta)\frac{x_{n}}{\widehat{a}_{1}(n)}+\delta\widehat{s}_{n-T}\,.
\end{array}\right.
\]

\end_inset

La prévision prend la forme
\begin_inset Formula 
\[
\left\{ \begin{array}{cc}
\widehat{x}_{n,h}= & (\widehat{a}_{1}(n)+h\widehat{a}_{2}(n))\times\widehat{s}_{n+h-T}\,,\,1\leq h\leq T\\
\widehat{x}_{n,h}= & (\widehat{a}_{1}(n)+h\widehat{a}_{2}(n))\times\widehat{s}_{n+h-2T}\,,\,T+1\leq h\leq2T\\
\dots & \dots
\end{array}\right.
\]

\end_inset

Initialisation
\begin_inset space ~
\end_inset

: c'est très dur mais on peut se contenter de mettre les premiers 
\begin_inset Formula $\widehat{a}_{2}$
\end_inset

 à 
\begin_inset Formula $0$
\end_inset

 et les premiers 
\begin_inset Formula $\widehat{a}_{1}$
\end_inset

 à 
\begin_inset Formula $1$
\end_inset

 (et le système se corrige par la suite).
\end_layout

\begin_layout Remark
Les deux méthodes ci-dessus (saisonnière additive et saisonnière multiplicative)
 ne peuvent être mises en place que si nous disposons d'un certain nombre
 de période pour estimer la partie périodique.
 Si le nombre de données est insuffisant, 
\family typewriter
R
\family default
 renvoie un message d'erreur.
\end_layout

\begin_layout Remark
On choisit la méthode saisonnière additive ou saisonnière multiplicative
 en fonction de l'aspect graphique des données.
 En gros : amplitudes constantes 
\begin_inset Formula $\rightarrow$
\end_inset

 méthode saisonnière additive, amplitudes non constantes 
\begin_inset Formula $\rightarrow$
\end_inset

 méthode saisonnière nultiplicative.
 
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
section[Feuille d'exercices numéro 2 ]{Feuille d'exercices numéro 2 (durée:
 3h)}
\end_layout

\end_inset


\end_layout

\begin_layout Subsection*
Préliminaires
\end_layout

\begin_layout Standard
Créer un fichier texte dans lequel vous répondrez clairement aux questions
 ci-dessous, en incluant vos codes 
\family typewriter
R
\family default
, les résultats obtenus sous 
\family typewriter
R
\family default
 (graphique y compris), vos interprétations, remarques ...
 Une fois ce TP fini, vous metterez en forme votre compte-rendu et l'exporterez
 au format pdf.
\end_layout

\begin_layout Subsection
Lissage et prévision de données simulées
\end_layout

\begin_layout Standard
Simuler les trois séries temporelles suivantes de taille 100 : 
\end_layout

\begin_layout Itemize
\begin_inset Formula $X_{1}(t)=\epsilon_{t}$
\end_inset

,
\end_layout

\begin_layout Itemize
\begin_inset Formula $X_{2}(t)=0.5t+2\epsilon_{t}$
\end_inset

,
\end_layout

\begin_layout Itemize
\begin_inset Formula $X_{3}(t)=0.5t+\epsilon_{t}+3\cos(t\pi/6)$
\end_inset

,
\end_layout

\begin_layout Standard
où les 
\begin_inset Formula $\epsilon_{t}$
\end_inset

 sont i.d.d .
 de loi 
\begin_inset Formula $\mathcal{N}(0,1)$
\end_inset

.
\end_layout

\begin_layout Enumerate
Pour chaque série, effectuer la prévision 
\begin_inset Formula $\widehat{x}_{t,1}$
\end_inset

 (
\begin_inset Formula $1\leq t\leq99$
\end_inset

) par lissage exponentiel simple et double.
 Tester différentes valeurs du paramètre de lissage 
\begin_inset Formula $\alpha$
\end_inset

 (4 à 5 valeurs), et représenter graphiquement la série ainsi que la prévision.
 Commenter chaque résultat, et essayer de déterminer graphiquement le lissage
 le plus adaptée pour chaque série.
\end_layout

\begin_layout Enumerate
Calculer pour chaque prévision effectuée la somme des carrés des erreurs,
 et sélectionner le meilleur paramètre à l'aide de cette quantité.
 
\end_layout

\begin_layout Enumerate
Tester maintenant le lissage exponentiel de Holt-Winters avec composante
 saisonnière additive puis multiplicative (seulement pour les séries avec
 une composante périodique).
 
\end_layout

\begin_layout Enumerate
Les prédictions obtenues sont-elles meilleures ? 
\end_layout

\begin_layout Subsection
Lissage et prévision de la concentration en co2 
\end_layout

\begin_layout Standard
Le fichier de données 
\family typewriter
co2
\family default
 contenu dans 
\family typewriter
R
\begin_inset Foot
status open

\begin_layout Plain Layout
Il est dans l'espace de travail dès que vous lancez 
\family typewriter
R
\family default
.
\end_layout

\end_inset


\family default
 contient les concentrations en CO2 à proximité du volcan Mauna Loa (Hawaï)
 de 1959 à 1997.
 
\end_layout

\begin_layout Standard
Après avoir représenté graphiquement ces données, quel modèle de lissage
 exponentiel vous semble le mieux approprié ?
\end_layout

\begin_layout Standard
Afin de valider ce modèle, tester la prédiction des données de 1990 à 1997
 en utilisant celles de 1959 à 1989.
 Si cela vous semble graphiquement correct, utilisez cette méthode pour
 prédire les concentrations en CO2 de 1997 à 2007.
 Sinon, tester d'autres méthodes de lissage exponentiel.
 
\end_layout

\begin_layout Subsection
Lissage et prévision du CAC40 
\end_layout

\begin_layout Standard
Récupérer le fichier contenant les valeurs de cloture journalière du CAC40
 de 1991 à 1998 (données 
\family typewriter
R
\family default
 EuStockMarkets).
 Essayer de prédire par lissage exponentiel les valeurs de cloture de 1998
 en utilisant les valeurs de cloture de 1991 à 1997.
 
\end_layout

\begin_layout Subsection*
Appendice : mise en 
\begin_inset ERT
status open

\begin_layout Plain Layout

{
\backslash
oe}
\end_layout

\end_inset

uvre sous R 
\end_layout

\begin_layout Standard
La commande 
\family typewriter
par(mfrow=c(n,p))
\family default
 permet d'afficher 
\family typewriter
n*p
\family default
 graphique sur la même page.
 
\end_layout

\begin_layout Standard
Obtenir un vecteur aléatoire de longueur 
\family typewriter
n
\family default
 de composantes des variables i.i.d.
 
\begin_inset Formula $\sim\mathcal{N}(0,1)$
\end_inset

: 
\family typewriter
e=rnorm(n).
 
\family default
Multiplier/additionner deux vecteurs composante par composante : 
\family typewriter
x*y, x+y
\family default
.
 Prendre la fonction 
\family typewriter
f
\family default
 d'un vecteur 
\family typewriter
x
\family default
 composante par composante : 
\family typewriter
f(x)
\family default
.
 Créer un vecteur par concaténation : 
\family typewriter
v=c(); v=c(v,1,2,3)
\family default
.
 Trouver le type d'une variable : 
\family typewriter
typeof(x)
\family default
.
\end_layout

\begin_layout Standard
Découper une série temporelle de 
\family typewriter
c(i,j) 
\family default
à 
\family typewriter
c(k,l)
\family default
 :
\family typewriter
 xd<-window(x,c(i,j),c(k,l))
\family default
.
\end_layout

\begin_layout Standard
Les méthodes de lissages exponentiels sont disponibles sous R, grâce à la
 fonction HoltWinters.
 Pour une série temporelle x, cette procédure permet : 
\end_layout

\begin_layout Itemize
un lissage exponentiel simple : 
\family typewriter

\begin_inset Newline newline
\end_inset

xlisse <- HoltWinters(x,alpha=
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
alpha$
\end_layout

\end_inset

,beta=FALSE,gamma=FALSE), 
\end_layout

\begin_layout Itemize
un lissage exponentiel double paramètre 
\begin_inset Formula $1-\alpha'$
\end_inset


\begin_inset space ~
\end_inset

:
\begin_inset Newline newline
\end_inset


\family typewriter
xlisse <- HoltWinters(x,alpha=
\family default

\begin_inset Formula $\alpha$
\end_inset

, 
\family typewriter
beta=
\family default

\begin_inset Formula $\beta$
\end_inset

,
\family typewriter
 gamma=FALSE) 
\family default
avec 
\begin_inset Formula $\alpha=1-(\alpha')^{2}$
\end_inset

, 
\begin_inset Formula $\beta=\frac{1-\alpha'}{1+\alpha'}$
\end_inset

,
\end_layout

\begin_layout Itemize
un lissage de Holt-Winters sans composante saisonnière : 
\family typewriter

\begin_inset Newline newline
\end_inset

xlisse <- HoltWinters(x,alpha=
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
alpha$
\end_layout

\end_inset

,beta=
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
beta$
\end_layout

\end_inset

,gamma=FALSE)
\family default
, 
\end_layout

\begin_layout Itemize
un lissage Holt-Winters additif : 
\family typewriter

\begin_inset Newline newline
\end_inset

xlisse <- HoltWinters(x,alpha=
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
alpha$
\end_layout

\end_inset

,beta=
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
beta$
\end_layout

\end_inset

,gamma=
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
gamma$
\end_layout

\end_inset

,seasonal=”add”)
\family default
, 
\end_layout

\begin_layout Itemize
un lissage Holt-Winters multiplicatif : 
\family typewriter

\begin_inset Newline newline
\end_inset

xlisse <- HoltWinters(x,alpha=
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
alpha$
\end_layout

\end_inset

,beta=
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
beta$
\end_layout

\end_inset

,gamma=
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
gamma$
\end_layout

\end_inset

,seasonal=”mul”)
\family default
.
 
\end_layout

\begin_layout Standard
À noter que pour un lissage de Holt-Winters avec composante saisonnière
 la série temporelle 
\family typewriter
x
\family default
 doit être un objet de type série temporelle, défini avec la fonction 
\family typewriter
ts
\family default
 en précisant la saisonnalité.
 
\end_layout

\begin_layout Standard
Les prévisions à l’horizon 
\family typewriter
h 
\family default
sont réalisées à l’aide de la fonction 
\family typewriter
predict
\family default
 :
\begin_inset Newline newline
\end_inset

 
\family typewriter
p<-predict(xlisse,n.ahead=h
\family default
) (attention le 
\family typewriter
n
\family default
 fait partie de la commande et le 
\family typewriter
h
\family default
 est une variable qui peut prendre les valeurs 
\begin_inset Formula $1,2,\dots$
\end_inset

).
 Un intervalle de confiance (dont le fondement théorique n’a pas été étudié
 dans ce cours) peut être obtenu en validant (à TRUE) l’option prediction.interva
l.
 Tracer la prédiction et la série sur le même graphique : 
\family typewriter
xlisse=HoltWinters(x,…); 
\begin_inset Newline newline
\end_inset

p=predict(xlisse,n.ahead=50); plot(xlisse,p)
\family default
.
\end_layout

\begin_layout Standard
Remarque : lorsqu’aucune valeur n’est précisée pour les constantes de lissage,
 un algorithme interne à la procédure HoltWinters se charge d’estimer la
 meilleur constante possible à partir de la série des observations.
\end_layout

\begin_layout Chapter
Estimation et élimination de la tendance et de la saisonnalité
\end_layout

\begin_layout Standard
On observe un processus 
\begin_inset Formula $(X_{t})$
\end_inset

 et on cherche à le modéliser.
 La démarche est la suivante
\begin_inset space ~
\end_inset

:
\end_layout

\begin_layout Itemize
Représenter graphiquement 
\begin_inset Formula $(x_{1},x_{2},\dots,x_{n})$
\end_inset

 pour repérer tendance et saisonnalité.
\end_layout

\begin_layout Itemize
Choisir un modèle pour les résidus (ce qui reste et qui est aléatoire) et
 valider le modèle (ou invalider le modèle).
\end_layout

\begin_layout Itemize
Prédire les réalisations futures à l'aide du modèle.
\end_layout

\begin_layout Section
Bruit blanc
\begin_inset Index idx
status open

\begin_layout Plain Layout
Bruit blanc
\end_layout

\end_inset


\end_layout

\begin_layout Definition
Un processus de bruit blanc est une suite de variables aléatoires 
\begin_inset Formula $(X_{t})$
\end_inset

, d'espérance et de variance constante (c'est à dire 
\begin_inset Formula $\E(X_{t})$
\end_inset

 et 
\begin_inset Formula $\var(X_{t})$
\end_inset

 ne dépendent pas de 
\begin_inset Formula $t$
\end_inset

) et tel que 
\begin_inset Formula $\cov(X_{t},X_{t+h})=0$
\end_inset

, si 
\begin_inset Formula $h\neq0$
\end_inset

.
 Si l'espérance est nulle, le bruit blanc est dit centré.
 Si les variables sont gaussiennes, le bruit blanc est dit gaussien.
\end_layout

\begin_layout Section
Processus stationnaire
\begin_inset Index idx
status open

\begin_layout Plain Layout
Processus stationnaire
\end_layout

\end_inset


\end_layout

\begin_layout Definition
\begin_inset CommandInset label
LatexCommand label
name "def:processus-stationnaire"

\end_inset

Un processus aléatoire 
\begin_inset Formula $(X_{t})_{t\geq0}$
\end_inset

 est stationnaire s'il est d'espérance constante (
\begin_inset Formula $\E(X_{t})$
\end_inset

 ne dépend pas de 
\begin_inset Formula $t$
\end_inset

) et si les convariances sont stables par translation dans le temps (
\begin_inset Formula $\cov(X_{t},X_{t+h})$
\end_inset

 ne dépend pas de 
\begin_inset Formula $t$
\end_inset

, quel que soit 
\begin_inset Formula $h\geq0$
\end_inset

).
 Attention, ce n'est pas la définition usuelle des ouvrages de probabilités.
 
\end_layout

\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Standard
Pour un processus 
\begin_inset Formula $(X_{t})_{t\geq0}$
\end_inset

 stationnaire, on définit la fonction d'auto-covariance
\begin_inset Index idx
status open

\begin_layout Plain Layout
Fonction d'auto-covariance
\end_layout

\end_inset

 par 
\begin_inset Formula 
\[
h\in\Z\mapsto\sigma(h)=\cov(X_{t},X_{t+h})\mbox{ (ne dépend pas de \ensuremath{t})\,,}
\]

\end_inset

et la fonction d'auto-corrélation
\begin_inset Index idx
status open

\begin_layout Plain Layout
auto-corrélation
\end_layout

\end_inset

 par
\begin_inset Formula 
\[
h\in\N^{*}\mapsto\rho(h)=\frac{\sigma(h)}{\sigma(0)}.
\]

\end_inset


\end_layout

\begin_layout Standard
On remarque que la fonction 
\begin_inset Formula $\sigma$
\end_inset

 est paire.
 
\end_layout

\begin_layout Example
Le processus de la figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:stationnaire-01"

\end_inset

 a l'air stationnaire.
 Le processus de la figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:stationnaire-02"

\end_inset

 n'a pas l'air stationnaire car l'espérance des points paraît non constante.
 Le processus de la figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:stationnaire-03"

\end_inset

 n'a pas l'air stationnaire car les 
\begin_inset Formula $X_{2k-1}$
\end_inset

, 
\begin_inset Formula $X_{2k}$
\end_inset

 ont l'air d'être corrélés positivement, ce qui n'est pas le cas des 
\begin_inset Formula $X_{2k}$
\end_inset

, 
\begin_inset Formula $X_{2k+1}$
\end_inset

.
 Le processus de la figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:stationnaire-04"

\end_inset

 n'a pas l'air stationnaire car la variance des points ne paraît pas constante.
 Le processus de la figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:stationnaire-05"

\end_inset

 a l'air stationnaire (mais c'est encore plus difficile à dire avec ce type
 de graphique).
 (Plus de commentaires en cours.) 
\begin_inset Float figure
placement h
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/processus_stationnaire_01.png
	scale 50

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:stationnaire-01"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset Float figure
placement h
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/processus_stationnaire_2.png
	scale 50

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:stationnaire-02"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
placement h
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/processus_stationnaire_03.png
	scale 50

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:stationnaire-03"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
placement h
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/processus_stationnaire_04.png
	scale 50

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:stationnaire-04"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
placement h
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/processus_stationnaire_05.png
	scale 50

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:stationnaire-05"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Section
Estimation paramétrique de la tendance
\end_layout

\begin_layout Standard
On suppose que 
\begin_inset Formula $X_{t}=m_{t}+\epsilon_{t}$
\end_inset

, avec 
\begin_inset Formula $m_{t}$
\end_inset

 déterministe et 
\begin_inset Formula $\epsilon_{t}$
\end_inset

 aléatoire.
 Dans le cas 
\begin_inset Formula $m_{t}=at+b$
\end_inset

, on peut estimer 
\begin_inset Formula $(a,b)$
\end_inset

 par
\begin_inset Formula 
\[
(\widehat{a},\widehat{b})=\argmin_{a,b}\sum_{t=1}^{n}(x_{t}-at-b)^{2}
\]

\end_inset

(méthode des moindres carrés
\begin_inset Index idx
status open

\begin_layout Plain Layout
Moindres carrés
\end_layout

\end_inset

).
 Comme d'habitude, on suppose que l'on dispose des observations 
\begin_inset Formula $x_{1}$
\end_inset

, …,
\begin_inset Formula $x_{n}$
\end_inset

.
 
\end_layout

\begin_layout Lemma
Les solutions au problème de minimisation ci-dessus sont 
\begin_inset Formula 
\[
\left\{ \begin{array}{ccc}
\widehat{a} & = & \frac{6}{n(n-1)}\left(-\sum_{t=1}^{n}tx_{t}+\frac{(2n+1)}{3}n\overline{x}_{n}\right)\\
\widehat{b} & = & \frac{12}{n(n^{2}-1)}\left(\sum_{t=1}^{n}tx_{t}-\frac{(n+1)}{2}n\overline{x}_{n}\right)
\end{array}\right.
\]

\end_inset

(
\begin_inset Formula $\overline{x}_{n}=(x_{1}+\dots+x_{n})/n$
\end_inset

).
\end_layout

\begin_layout Standard
(La démonstration de ce lemme fait partie d'une feuille d'exercices.) On
 pourrait aussi chercher une tendance polynomiale de plus haut degré (par
 exemple 
\begin_inset Formula $m_{t}=a+bt+ct^{2}$
\end_inset

), les calculs sont alors plus compliqués.
 
\end_layout

\begin_layout Fact
(À savoir par c
\begin_inset ERT
status open

\begin_layout Plain Layout

{
\backslash
oe}
\end_layout

\end_inset

ur.) Pour tout 
\begin_inset Formula $n$
\end_inset

 dans 
\begin_inset Formula $\N^{*}$
\end_inset

, 
\begin_inset Formula 
\[
\left\{ \begin{array}{ccc}
1+2+\dots+n & = & \frac{n(n+1)}{2}\\
1^{2}+2^{2}+\dots+n^{2} & = & \frac{n(n+1)(2n+1)}{6}\,.
\end{array}\right.
\]

\end_inset


\end_layout

\begin_layout Section
Estimation non paramétrique
\begin_inset space ~
\end_inset

: moyenne mobile
\begin_inset Index idx
status open

\begin_layout Plain Layout
Moyenne mobile
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Tendance linéaire
\end_layout

\begin_layout Standard
On suppose que 
\begin_inset Formula $X_{t}=m_{t}+\epsilon_{t}$
\end_inset

, avec 
\begin_inset Formula $m_{t}$
\end_inset

 déterministe et 
\begin_inset Formula $\epsilon_{t}$
\end_inset

 aléatoire.
 Si 
\begin_inset Formula $m_{.}$
\end_inset

 est une fonction affine (donc à croissance linéaire) dans un intervalle
 autour de 
\begin_inset Formula $t$
\end_inset

, on peut estimer la moyenne par 
\begin_inset Formula 
\[
\widehat{m}_{t}=\frac{1}{2q+1}\sum_{k=-q}^{q}x_{t+k}\,.
\]

\end_inset

C'est une estimation par moyenne mobile.
 Par convention, 
\begin_inset Formula 
\[
\begin{cases}
x_{t}=x_{1} & \mbox{ si }t\leq0\,,\\
x_{t}=x_{n} & \mbox{ si }t\geq n\,.
\end{cases}
\]

\end_inset

Pourquoi c'est une bonne idée
\begin_inset space ~
\end_inset

:
\begin_inset Formula 
\begin{eqnarray*}
\frac{1}{2q+1}\sum_{k=-q}^{q}x_{t+k} & = & \frac{1}{2q+1}\sum_{k=-q}^{q}m_{t+k}+\frac{1}{2q+1}\sum_{k=-q}^{q}\epsilon_{t+k}
\end{eqnarray*}

\end_inset

et
\begin_inset Formula 
\begin{equation}
\frac{1}{2q+1}\sum_{k=-q}^{q}m_{t+k}=m_{t}\,\text{ si \ensuremath{m} affine,}\label{eq:bonne-idee-01}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\frac{1}{2q+1}\sum_{k=-q}^{q}\epsilon_{t+k}=0\text{ si les }(\epsilon_{t})\text{ sont i.i.d. centrés.}\label{eq:bonne-idee-02}
\end{equation}

\end_inset


\end_layout

\begin_layout Remark
\begin_inset CommandInset label
LatexCommand label
name "rem:epsilon-centres"

\end_inset

Si les 
\begin_inset Formula $(\epsilon_{t})$
\end_inset

 sont i.i.d., on peut toujours les supposer centrés.
 En effet, si 
\begin_inset Formula $\E(\epsilon_{t})=C\neq0$
\end_inset

, posons 
\begin_inset Formula $m'_{t}=m_{t}+C$
\end_inset

 et 
\begin_inset Formula $\epsilon'_{t}=\epsilon_{t}-C$
\end_inset

.
 Nous avons alors 
\begin_inset Formula $X_{t}=m'_{t}+\epsilon'_{t}$
\end_inset

 avec 
\begin_inset Formula $m'_{t}$
\end_inset

 déterministe et les 
\begin_inset Formula $(\epsilon'_{t})$
\end_inset

 qui sont i.i.d.
 et centrés.
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\]

\end_inset


\end_layout

\begin_layout Subsection
Tendance linéaire et composante périodique
\end_layout

\begin_layout Standard
On suppose que 
\begin_inset Formula $X_{t}=m_{t}+s_{t}+\epsilon_{t}$
\end_inset

, avec 
\begin_inset Formula $m_{t}$
\end_inset

 et 
\begin_inset Formula $s_{t}$
\end_inset

 déterministes et 
\begin_inset Formula $\epsilon_{t}$
\end_inset

 aléatoire.
 La fonction 
\begin_inset Formula $m_{.}$
\end_inset

 est supposée affine et la fonction 
\begin_inset Formula $s_{.}$
\end_inset

 est supposée 
\begin_inset Formula $T$
\end_inset

-périodique.
 On peut toujours supposer que
\begin_inset Formula 
\[
\sum_{t=1}^{T}s_{t}=0
\]

\end_inset

(quitte à translater 
\begin_inset Formula $s$
\end_inset

 et 
\begin_inset Formula $m$
\end_inset

 d'une constante, dans l'esprit de la remarque 
\begin_inset CommandInset ref
LatexCommand ref
reference "rem:epsilon-centres"

\end_inset

).
 On peut estimer 
\begin_inset Formula $m_{t}$
\end_inset

 par la formule 
\begin_inset Formula 
\[
\widehat{m}_{t}=\frac{1}{2q+1}\sum_{k=-q}^{q}x_{t+k}
\]

\end_inset

Il est avantageux de choisir 
\begin_inset Formula $2q+1$
\end_inset

 le plus proche possible d'un multiple de 
\begin_inset Formula $T$
\end_inset

.
 Pourquoi est-ce que c'est une bonne idée
\begin_inset space ~
\end_inset

(on suppose 
\begin_inset Formula $2q+1=p\times T$
\end_inset

 pour un certain 
\begin_inset Formula $p$
\end_inset

):
\begin_inset Formula 
\begin{eqnarray*}
\frac{1}{2q+1}\sum_{k=-q}^{q}x_{t+k} & = & \frac{1}{2q+1}\sum_{k=-q}^{q}m_{t+k}+\frac{1}{2q+1}\sum_{k=-q}^{q}s_{t+k}+\frac{1}{2q+1}\sum_{k=-q}^{q}\epsilon_{t+k}
\end{eqnarray*}

\end_inset

avec 
\begin_inset Formula 
\[
\frac{1}{2q+1}\sum_{k=-q}^{q}s_{t+k}=0\,.
\]

\end_inset

Les équations (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:bonne-idee-01"

\end_inset

) et (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:bonne-idee-02"

\end_inset

) achèvent de nous convaincre de la pertinence de faire la moyenne empirique
 sur une fenêtre mobile.
\end_layout

\begin_layout Standard
Puis on estime la composante périodique (on dit aussi
\begin_inset space ~
\end_inset

: saisonnière) en faisant la moyenne sur toutes les périodes
\begin_inset space ~
\end_inset

:
\begin_inset Formula 
\[
\mbox{pour }t\in\{1,2,\dots,T\}\,,\,\widehat{s}_{t}=\frac{\left(x_{t}-\widehat{m}_{t}\right)+\left(x_{t+T}-\widehat{m}_{t+T}\right)+\dots+\left(x_{t+kT}-\widehat{m}_{t+kT}\right)}{k+1}\,,
\]

\end_inset

avec 
\begin_inset Formula $k=\sup\{i\,:\,t+iT\leq n\}$
\end_inset

,
\begin_inset Formula 
\[
\mbox{puis, pour }t\in\{T+1,T+2,\dots,n\}\,,\,\widehat{s}_{t}=\widehat{s}_{t[T]}\,,
\]

\end_inset

où 
\begin_inset Formula $t[T]$
\end_inset

 est le reste de la division euclidienne de 
\begin_inset Formula $t$
\end_inset

 par 
\begin_inset Formula $T$
\end_inset

.
 Cette dernière formule fournit un estimateur raisonnable puisque 
\begin_inset Formula $s_{.}$
\end_inset

 est 
\begin_inset Formula $T$
\end_inset

-périodique.
 
\end_layout

\begin_layout Section
Élimination de la tendance et de la saisonnalité par la méthode des différences
\end_layout

\begin_layout Standard
On peut éliminer la partie déterministe sans l'estimer.
 Fixons 
\begin_inset Formula $T$
\end_inset

 dans 
\begin_inset Formula $\N^{*}$
\end_inset

 et notons
\begin_inset Formula 
\[
\Delta_{T}\,:\,(X_{t})_{t\in\Z}\mapsto(X_{t}-X_{t-T})_{t\in\Z}
\]

\end_inset

(on notera parfois 
\begin_inset Formula $\Delta=\Delta_{T}$
\end_inset

).
 
\end_layout

\begin_layout Proposition
Si 
\begin_inset Formula $(X_{t})$
\end_inset

 est une série temporelle admettant une tendance polynômiale de degré 
\begin_inset Formula $k\geq1$
\end_inset

 alors 
\begin_inset Formula $(\Delta X_{t})$
\end_inset

 admet une tendance polynômiale de degré 
\begin_inset Formula $k-1$
\end_inset

.
 Si 
\begin_inset Formula $(X_{t})$
\end_inset

 est une série temporelle admettant une tendance polynômiale de degré 
\begin_inset Formula $0$
\end_inset

 (c'est à dire une constante) alors 
\begin_inset Formula $(\Delta X_{t})$
\end_inset

 a une tendance égale à 
\begin_inset Formula $0$
\end_inset

.
 
\end_layout

\begin_layout Proof
On écrit 
\begin_inset Formula 
\[
X_{t}=P(t)+\epsilon_{t}
\]

\end_inset

avec des 
\begin_inset Formula $\epsilon_{t}$
\end_inset

 aléatoires et 
\begin_inset Formula $P(t)=a_{0}+a_{1}t+\dots+a_{k}t^{k}$
\end_inset

.
 Nous avons
\begin_inset Formula 
\[
(\Delta_{T}X)_{t}=P(t)-P(t-T)+\epsilon_{t}-\epsilon_{t-T}\,.
\]

\end_inset

La série 
\begin_inset Formula $(\epsilon_{t}-\epsilon_{t-T})_{t}$
\end_inset

 est la partie aléatoire de 
\begin_inset Formula $\Delta_{T}X$
\end_inset

, la partie déterministe est le polynôme suivant en Y
\begin_inset space ~
\end_inset

:
\begin_inset Formula 
\begin{eqnarray*}
P(Y-T)-P(Y) & = & a_{k}(Y-T)^{k}-a_{k}Y^{k}+\sum_{i=0}^{k-1}a_{i}(Y-T)^{i}-a_{i}Y^{i}\,.
\end{eqnarray*}

\end_inset

On voit que le degré de 
\begin_inset Formula $\sum_{i=0}^{k-1}a_{i}(Y-T)^{i}-a_{i}Y^{i}$
\end_inset

 est 
\begin_inset Formula $k-1$
\end_inset

.
 Regardons
\begin_inset Formula 
\begin{eqnarray*}
a_{k}(Y-T)^{k}-a_{k}Y^{k} & = & a_{k}\sum_{i=0}^{k}\left[C_{k}^{i}Y^{k-i}T^{i}\right]-Y^{k}\\
 & = & \sum_{i=1}^{k}C_{k}^{i}Y^{k-i}T^{i}\,,
\end{eqnarray*}

\end_inset

qui est bien de degré 
\begin_inset Formula $k-1$
\end_inset

 (car 
\begin_inset Formula $a_{k}\neq0$
\end_inset

).
 Les termes 
\begin_inset Formula $\sum_{i=0}^{k-1}a_{i}(Y-T)^{i}-a_{i}Y^{i}$
\end_inset

 sont de degré 
\begin_inset Formula $\leq k-2$
\end_inset

 (les termes en degré 
\begin_inset Formula $k-1$
\end_inset

 se simplifiant).
 Donc 
\begin_inset Formula $P(t)-P(t-T)$
\end_inset

 est exactement de degré 
\begin_inset Formula $k-1$
\end_inset

.
\end_layout

\begin_layout Lemma
Si les 
\begin_inset Formula $(\epsilon_{t})$
\end_inset

 forment un processus stationnaire centré, alors les 
\begin_inset Formula $(\epsilon_{t}-\epsilon_{t-T})$
\end_inset

 forment aussi un processus stationnaire centré.
\end_layout

\begin_layout Proof
Nous allons utiliser abondemment la formule suivante
\begin_inset space ~
\end_inset

:
\begin_inset Formula 
\[
\text{si }X,Y\text{ centrés, alors }\cov(X,Y)=\E(XY)\,.
\]

\end_inset

Nous calculons pour tout 
\begin_inset Formula $t$
\end_inset


\begin_inset space ~
\end_inset

:
\end_layout

\begin_layout Proof
\begin_inset Formula $\E(\epsilon_{t}-\epsilon_{t-T})=\E(\epsilon_{t})-\E(\epsilon_{t-T})=0\,\text{(ne dépend pas de \ensuremath{t}),}$
\end_inset


\begin_inset Formula 
\begin{eqnarray*}
\var(\epsilon_{t}-\epsilon_{t-T}) & = & \E((\epsilon_{t}-\epsilon_{T-t})^{2})\\
 & = & \E(\epsilon_{t}^{2})+\E(\epsilon_{t-T}^{2})-2\E(\epsilon_{t}\epsilon_{t-T})\\
 & = & 2\var(\epsilon_{t})-2\cov(\epsilon_{t},\epsilon_{t-T})\text{ (ne dépend pas de \ensuremath{t}),}
\end{eqnarray*}

\end_inset

et, pour tout 
\begin_inset Formula $h$
\end_inset

,
\begin_inset Formula 
\begin{eqnarray*}
\cov(\epsilon_{t}-\epsilon_{t-T},\epsilon_{t+h}-\epsilon_{t-T+h}) & = & \E((\epsilon_{t}-\epsilon_{t-T})(\epsilon_{t+h}-\epsilon_{t-T+h}))\\
 & = & \cov(\epsilon_{t},\epsilon_{t+h})+\cov(\epsilon_{t-T},\epsilon_{t-T+h})\\
 &  & -\cov(\epsilon_{t},\epsilon_{t-T+h})-\cov(\epsilon_{t-T},\epsilon_{t+h})\\
 &  & \text{(ne dépend pas de \ensuremath{t}})
\end{eqnarray*}

\end_inset


\begin_inset Formula 
\[
\]

\end_inset


\end_layout

\begin_layout Remark
Si on applique 
\begin_inset Formula $k+1$
\end_inset

 fois 
\begin_inset Formula $\Delta$
\end_inset

 une série dont la tendance est un polynôme de degré 
\begin_inset Formula $k$
\end_inset

, on tombe sur un processus dont la tendance est égale à 
\begin_inset Formula $0$
\end_inset

 et dont les bruits sont centrés.
 Donc on ne tombe par sur un processus nul mais sur un processus qui ne
 contient que du bruit (qui est en général d'un ordre de grandeur inférieur
 au processus de départ).
\end_layout

\begin_layout Remark
Dans la pratique, on travaille avec la donnée de 
\begin_inset Formula $(x_{1},\dots,x_{n})$
\end_inset

.
 Pour appliquer 
\begin_inset Formula $\Delta_{T}$
\end_inset

, 
\family typewriter
R
\family default
 utilise la convention
\begin_inset space ~
\end_inset

: 
\begin_inset Formula $x_{k}=x_{1}$
\end_inset

 si 
\begin_inset Formula $k\leq0$
\end_inset

 et 
\begin_inset Formula $x_{k}=x_{n}$
\end_inset

 si 
\begin_inset Formula $k\geq n$
\end_inset

.
 On a ainsi prolongé la série par des constantes.
 En particulier, 
\begin_inset Formula $(\Delta_{T}^{i}x)_{j}$
\end_inset

 avec 
\begin_inset Formula $j\leq iT$
\end_inset

 ou 
\begin_inset Formula $|j-n|\leq iT$
\end_inset

 est calculé avec des différences qui contiennent qui viennent du prolongement
 par des constantes.
 Donc, pour ces termes, la proposition ci-dessus n'est pas valable.
 Quand on regarde l'allure du graphe de 
\begin_inset Formula $(\Delta_{T}^{i}x)$
\end_inset

, il faut donc s'assurer que 
\begin_inset Formula $iT$
\end_inset

 est petit devant 
\begin_inset Formula $n$
\end_inset

.
\end_layout

\begin_layout Remark
Quand 
\begin_inset Formula $(\Delta_{T}^{i}x)$
\end_inset

 et
\begin_inset Formula $(\Delta_{T}^{i+1}x)$
\end_inset

 sont 
\begin_inset Quotes cld
\end_inset

petits
\begin_inset Quotes crd
\end_inset

 et du même ordre, on considère qu'ils sont constitués de bruit.
 On en déduit que 
\begin_inset Formula $(x_{t})$
\end_inset

 a une tendance polynômiale de degré 
\begin_inset Formula $i-1$
\end_inset

.
 Pour comparer les ordres de grandeur de deux séries temporelles, on peut
 regarder les graphes ou les moyennes empiriques.
 
\end_layout

\begin_layout Proposition
Dans le cas 
\begin_inset Formula $X_{t}=m_{t}+s_{t}+\epsilon_{t}$
\end_inset

 avec 
\begin_inset Formula $m_{t}$
\end_inset

 et 
\begin_inset Formula $s_{t}$
\end_inset

 déterministe, 
\begin_inset Formula $\epsilon_{t}$
\end_inset

 un bruit et 
\begin_inset Formula $s_{.}$
\end_inset

 qui est 
\begin_inset Formula $T$
\end_inset

-périodique, le processus 
\begin_inset Formula $\Delta_{T}X$
\end_inset

 est un processus qui ne contient plus de partie périodique.
 De plus, si la tendance est linéaire, elle est également supprimée.
\end_layout

\begin_layout Proof
Nous avons
\begin_inset Formula 
\[
X_{t}-X_{t-T}=m_{t}-m_{t-T}+\epsilon_{t}-\epsilon_{t-T}\,.
\]

\end_inset

Si, de plus, 
\begin_inset Formula $m_{t}=at+b$
\end_inset

, alors
\begin_inset Formula 
\begin{eqnarray*}
X_{t}-X_{t-T} & = & at+b-a(t-T)-b+\epsilon_{t}-\epsilon_{t-T}\\
 & = & aT+\epsilon_{t}-\epsilon_{t-T}\,.
\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Example
\begin_inset CommandInset label
LatexCommand label
name "exa:On-considère-"

\end_inset

On considère 
\begin_inset Formula $x_{t}=\frac{t}{2}+3\cos\left(\frac{t\pi}{6}\right)$
\end_inset

 avec 
\begin_inset Formula $\epsilon_{t}\sim\mathcal{N}(0;1)$
\end_inset

.
 Voir la figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:En-haut:-,"

\end_inset

 pour les dessins.
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement h
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/Screenshot from 2015-10-19 17:02:04.png
	scale 50

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:En-haut:-,"

\end_inset

En haut
\begin_inset space ~
\end_inset

: 
\begin_inset Formula $x_{t}$
\end_inset

, au milieu
\begin_inset space ~
\end_inset

: 
\begin_inset Formula $x_{t}-x_{t-1}$
\end_inset

, en bas
\begin_inset space ~
\end_inset

: 
\begin_inset Formula $x_{t}-x_{t-12}$
\end_inset

 (exemple 
\begin_inset CommandInset ref
LatexCommand ref
reference "exa:On-considère-"

\end_inset

).
 
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Section
Test sur la série résiduelle
\begin_inset CommandInset label
LatexCommand label
name "sec:Test-sur-la-serie-residuelle"

\end_inset


\end_layout

\begin_layout Standard
On aimerait savoir si on est en présence d'un bruit blanc.
\end_layout

\begin_layout Lemma
Si 
\begin_inset Formula $(\epsilon_{k})_{k\ge1}$
\end_inset

 est un bruit blanc, alors ses fonctions d'auto-corrélation empiriques vérifient
\begin_inset Formula 
\[
\sqrt{n}\widehat{\rho}_{n}(h)\underset{n\rightarrow+\infty}{\overset{\mbox{loi}}{\longrightarrow}}\mathcal{N}(0;1)\,,
\]

\end_inset

pour tout 
\begin_inset Formula $h$
\end_inset

 dans 
\begin_inset Formula $\N^{*}$
\end_inset

.
 De plus, les 
\begin_inset Formula $(\widehat{\rho}_{n}(h))_{h\geq1}$
\end_inset

 sont asymptotiquement indépendant (quand 
\begin_inset Formula $n\rightarrow+\infty$
\end_inset

).
\end_layout

\begin_layout Subsection
Test d'hypothèses 
\begin_inset Index idx
status open

\begin_layout Plain Layout
Test d'hypothèses
\end_layout

\end_inset

 simple
\end_layout

\begin_layout Standard
Toute convergence en loi nous donne une idée pour construire un test.
 On veut tester 
\begin_inset Formula 
\[
\mbox{\textbf{(H0) }Les \ensuremath{(\epsilon_{k})} forment un bruit blanc.}
\]

\end_inset

contre
\begin_inset Formula 
\[
\mbox{\textbf{(H1)} Les \ensuremath{(\epsilon_{k})} ne forment pas un bruit blanc.}
\]

\end_inset

On commence par fixer un niveau 
\begin_inset Formula $\alpha$
\end_inset

.
 La quantité 
\begin_inset Formula $\widehat{\rho}_{n}(1)$
\end_inset

 s'appelle une 
\bar under
statistique
\bar default

\begin_inset Index idx
status open

\begin_layout Plain Layout
Statistique
\end_layout

\end_inset

 (c'est une quantité que l'on peut calculer à partir des données).
 Disons 
\begin_inset Formula $\alpha=0,05$
\end_inset

.
 Le lemme ci-dessus nous dit que, si 
\series bold
(H0)
\series default
 est vraie, 
\begin_inset Formula 
\[
\p(\sqrt{n}\widehat{\rho}_{n}(1)\in\left[-1,96;1,96\right])\convn\p(Z\in\left[-1,96;1,96\right])=0,95\,,
\]

\end_inset

avec 
\begin_inset Formula $Z\sim\mathcal{N}(0;1)$
\end_inset

 (la dernière égalité se lisant dans la table de la loi normale).
 La procédure de test est donc la suivante
\end_layout

\begin_layout Itemize
si 
\begin_inset Formula $\widehat{\rho}_{n}(1)\in\left[-\frac{1,96}{\sqrt{n}};\frac{1,96}{\sqrt{n}}\right]$
\end_inset

 alors on considère que 
\series bold
(H0) 
\series default
est vraie,
\end_layout

\begin_layout Itemize
dans le cas contraire, on considère que 
\series bold
(H0) 
\series default
n'est pas vraie.
\end_layout

\begin_layout Standard
Si 
\series bold
(H0)
\series default
 est vraie, la probabilité de rejeter 
\series bold
(H0)
\series default
 à tort est
\begin_inset Formula 
\begin{eqnarray*}
\p(\mbox{rejeter \textbf{(H0)}}|\mbox{ \textbf{(H0) })} & \approx & \p(Z\notin\left[-1,96;1,96\right])\\
 & = & 0,05\,.
\end{eqnarray*}

\end_inset

La probabilité de rejeter à tort 
\series bold
(H0) 
\series default
est donc inférieure ou égale à 
\begin_inset Formula $\alpha$
\end_inset

.
 Donc nous avons construit un test de valeur 
\begin_inset Formula $\alpha$
\end_inset

.
 La probabilité calculée ci-dessus est la probabilité 
\begin_inset Quotes cld
\end_inset

d'erreur de première espèce
\begin_inset Quotes crd
\end_inset

.
 Il serait intéressante de bormer aussi la probabilité de l'erreur de seconde
 espèce 
\begin_inset Formula 
\[
\p(\mbox{rejeter \textbf{(H1) }|}\mbox{ \textbf{(H1) }})\,,
\]

\end_inset

mais c'est plus compliqué.
 
\end_layout

\begin_layout Exercise
Proposer un test de niveau 
\begin_inset Formula $0,01$
\end_inset

 (c'est à dire pour lequel 
\begin_inset Formula $\p(\text{rejeter \textbf{(H0)}}|\text{\textbf{(H0)}})\leq0,01$
\end_inset

).
\end_layout

\begin_layout Remark
Dans le test ci-dessus, 
\series bold
(H0) 
\series default
et 
\series bold
(H1)
\series default
 n'ont pas le même statut.
 L'esprit est qu'on suppose 
\series bold
(H0)
\series default
.
 Sous 
\series bold
(H0)
\series default
, une certaine statistique doit suivre une loi 
\begin_inset Formula $\mathcal{N}(0;1)$
\end_inset

, donc ne doit pas être trop loin de 
\begin_inset Formula $0$
\end_inset

.
 Si cette statisque est trop grande en valeur absolue, il n'est pas crédible
 qu'elle soit de loi 
\begin_inset Formula $\mathcal{N}(0;1)$
\end_inset

 et on doit donc rejeter 
\series bold
(H0)
\series default
 (à contre-c
\begin_inset ERT
status open

\begin_layout Plain Layout

{
\backslash
oe}
\end_layout

\end_inset

ur).
\end_layout

\begin_layout Remark
Si nous voulons faire un test de niveau (ou valeur 
\begin_inset Formula $\alpha$
\end_inset

) (on dit aussi : de niveau de confiance 
\begin_inset Formula $1-\alpha$
\end_inset

), il faut trouver 
\begin_inset Formula $M$
\end_inset

 tel que 
\begin_inset Formula $\p(Z\in[-M;M])\geq1-\alpha$
\end_inset

 et rejeter 
\series bold
(H0)
\series default
 si 
\begin_inset Formula $|\sqrt{n}\widehat{\rho}_{n}(1)|\geq M$
\end_inset

.
 Ceci assure que la probabilité de rejeter 
\series bold
(H0)
\series default
 à tort est plus petite que 
\begin_inset Formula $\alpha$
\end_inset

.
 Dans la pratique, on regarde dans une table de la loi gaussienne et on
 prend le 
\begin_inset Formula $M$
\end_inset

 le plus petit possible tel que 
\begin_inset Formula $\p(Z\in]-\infty;M])\geq1-\alpha/2$
\end_inset

 (il n'y a pas forcément de 
\begin_inset Formula $M$
\end_inset

 dans la table tel que nous ayons l'égalité).
\end_layout

\begin_layout Remark
Nous pourrions prendre 
\begin_inset Formula $M'>M$
\end_inset

, ce qui conduirait aussi à 
\begin_inset Formula $\p(|Z|>M')<\alpha$
\end_inset

 et donc à un test avec 
\begin_inset Formula $\p(\text{rejeter \textbf{(H0)}}|\text{\textbf{(H0)}})<\alpha$
\end_inset

.
 Mais ce test aurait une erreur de seconde espèce (
\begin_inset Formula $\p(\mbox{rejeter \textbf{(H1) }|}\mbox{ \textbf{(H1) }})$
\end_inset

) plus grande.
 C'est pourquoi nous cherchons 
\begin_inset Formula $M$
\end_inset

 le plus petit possible tele que 
\begin_inset Formula $\p(Z\in]-\infty;M])\geq1-\alpha/2$
\end_inset

 .
\end_layout

\begin_layout Subsection
Test d'hypothèses plus sophistiqués
\end_layout

\begin_layout Standard
Dans la pratique, on utilise des statistiques plus compliquées (qui ont
 des limites en loi remarquables).
 Par exemple,
\begin_inset Formula 
\[
Q_{n}=n\sum_{j=1}^{h}\widehat{\rho}_{n}^{2}(j)
\]

\end_inset

converge en loi (quand 
\begin_inset Formula $n\rightarrow+\infty$
\end_inset

) vers une loi 
\begin_inset Formula $\chi^{2}(h)$
\end_inset

 (une loi du chi-deux à 
\begin_inset Formula $h$
\end_inset

 degrés de liberté)
\begin_inset Index idx
status open

\begin_layout Plain Layout
Chi-deux
\end_layout

\end_inset

.
 On peut tester les hypothèses ci-dessus en disant que l'on rejette 
\series bold
(H0)
\series default
 quand 
\begin_inset Formula $Q_{n}\geq\chi_{h,1-\alpha}^{2}$
\end_inset

 (qui est le 
\begin_inset Formula $\alpha$
\end_inset

-quantile de la loi limite).
 Voir le cours de statistiques pour la définition du mot 
\begin_inset Quotes cld
\end_inset

quantile
\begin_inset Quotes crd
\end_inset

.
 Le langage 
\family typewriter
R
\family default
 utilise la statistique
\begin_inset Formula 
\[
Q_{n,LB}=n(n+2)\sum_{j=1}^{h}\frac{\widehat{\rho}_{n}^{2}(j)}{n-j}
\]

\end_inset

(qui est aussi, asymptotiquement, de loi 
\begin_inset Formula $\chi^{2}(h)$
\end_inset

 (voir les feuilles de TP et la fonction 
\family typewriter
Box.test
\family default
).
\end_layout

\begin_layout Remark
Pour des raisons de vitesse de convergence, on se limitera à un 
\family typewriter
lag
\family default
 inférieur à 
\begin_inset Formula $10$
\end_inset

 dans l'utilisation de 
\family typewriter
Box.test
\family default
.
 Soit 
\begin_inset Formula $X$
\end_inset

 de loi 
\begin_inset Formula $\chi^{2}(h)$
\end_inset

.
 La fonction 
\family typewriter
Box.test
\family default
 avec un 
\family typewriter
lag
\family default
 égal à 
\begin_inset Formula $h$
\end_inset

 renvoie la valeur numérique de 
\begin_inset Formula $\p(X>Q_{n,LB})$
\end_inset

.
 Notre test (de niveau 
\begin_inset Formula $\alpha$
\end_inset

) consiste à rejeter 
\series bold
(H0) 
\series default
quand 
\begin_inset Formula $Q_{n,LB}>\chi_{h,1-\alpha}$
\end_inset

.
 Nous remarquons que 
\begin_inset Formula 
\[
Q_{n,LB}>\chi_{h,1-\alpha}\Longleftrightarrow\p(X>Q_{n,LB})<\alpha\,.
\]

\end_inset

Donc notre test revient à rejeter 
\series bold
(H0)
\series default
 quand 
\begin_inset Formula $\p(X>Q_{n,LB})<\alpha$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Note Comment
status collapsed

\begin_layout Plain Layout
On commence par chercher les points critiques de 
\begin_inset Formula $F(a,b)=\sum_{t=1}^{n}(x_{t}-a-bt)^{2}$
\end_inset

.
 Nous calculons
\begin_inset Formula 
\[
\left\{ \begin{array}{ccc}
\frac{\partial F}{\partial a}(a,b) & = & \sum_{t=1}^{n}-2(x_{t}-a-bt)\\
\frac{\partial F}{\partial b}(a,b) & = & \sum_{t=1}^{n}-2t(x_{t}-a-bt)\,.
\end{array}\right.
\]

\end_inset

Nous cherchons à résoudre le système 
\begin_inset Formula 
\[
\left\{ \begin{array}{ccc}
-\overline{x}_{n}+an+b\frac{n(n+1)}{2} & = & 0\\
-\overline{s}_{n}+a\frac{n(n+1)}{2}+b\frac{n(n+1)(2n+1)}{6} & = & 0\,.
\end{array}\right.
\]

\end_inset

Nous calculons la valeur de l'unique solution
\begin_inset space ~
\end_inset

:
\begin_inset Formula 
\begin{eqnarray*}
\left(-\overline{x}_{n}+an\right)\times\frac{(2n+1)}{3}-\left(-\overline{s}_{t}+a\frac{n(n+1)}{2}\right) & = & 0\\
an\left(\frac{(2n+1)}{3}-\frac{(n+1)}{2}\right) & = & \overline{x}_{n}\times\frac{(2n+1)}{3}-\overline{s}_{n}\\
a & = & \frac{2(2n+1)\overline{x}_{n}-6\overline{s}_{n}}{n-1}\,,
\end{eqnarray*}

\end_inset


\begin_inset Formula 
\begin{eqnarray*}
\left(-\overline{x}_{n}+b\frac{n(n+1)}{2}\right)\times\frac{(n+1)}{2}-\left(-\overline{s}_{n}+b\frac{n(n+1)(2n+1)}{6}\right) & = & 0\\
b\frac{n(n+1)}{2}\left(\frac{n+1}{2}-\frac{2n+1}{3}\right) & = & \frac{(n+1)}{2}\overline{x}_{n}-\overline{s}_{n}\\
b & = & \frac{6(n+1)\overline{x}_{n}-12\overline{s}_{n}}{n(n+1)(n-1)}\,.
\end{eqnarray*}

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Section
Exemple
\begin_inset space ~
\end_inset

: un système proies-prédateurs
\begin_inset Index idx
status open

\begin_layout Plain Layout
Proies-prédateurs
\end_layout

\end_inset


\begin_inset Index idx
status open

\begin_layout Plain Layout
Lokta-Volterra
\end_layout

\end_inset


\end_layout

\begin_layout Standard
On s'intéresse aux nombre de lynx capturés par la compagnie de la Baie d'Hudson,
 données annuelles de 1821 à 1934
\begin_inset Foot
status open

\begin_layout Plain Layout
pour télécharger le fichier 
\begin_inset space ~
\end_inset

:
\bar under

\begin_inset Newline newline
\end_inset


\begin_inset Flex URL
status open

\begin_layout Plain Layout

https://math.unice.fr/~rubentha/enseignement/annual-numer-of-lynx-trapped-ma.txt
\end_layout

\end_inset


\end_layout

\end_inset

.
 Nous noterons 
\family typewriter

\begin_inset Formula $x$
\end_inset


\family default
 la série (voir le graphique des données dans la figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Lynx-capturés"

\end_inset

).
\begin_inset Float figure
placement h
wide false
sideways false
status open

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/lynx-01.png
	scale 60

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Lynx capturés
\begin_inset CommandInset label
LatexCommand label
name "fig:Lynx-capturés"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset

Nous traçons les auto-corrélations dans la figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Auto-corrélations"

\end_inset

.
 
\begin_inset Float figure
placement h
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/lynx-02.png
	scale 60

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Auto-corrélations
\begin_inset CommandInset label
LatexCommand label
name "fig:Auto-corrélations"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset

Au vu des auto-corrélations, la série semble être périodique de période
 
\begin_inset Formula $10$
\end_inset

.
 Nous utilisons ensuite la méthode des moyennes mobiles pour faire appaître
 la composante saisonnière, la tendance et la partie aléatoire de la série
 
\begin_inset Formula $x$
\end_inset

 (voir figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Décomposition-par-moyenne"

\end_inset

).
\begin_inset Float figure
placement h
wide false
sideways false
status open

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/lynx-03.png
	scale 75

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Décomposition par moyenne mobile
\begin_inset CommandInset label
LatexCommand label
name "fig:Décomposition-par-moyenne"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset

Testons maintenant la blancheur des résidus au niveau 
\begin_inset Formula $\alpha=0,05$
\end_inset

.
 Nous obtenons une 
\begin_inset Formula $p$
\end_inset

-valeur inférieur à 
\begin_inset Formula $2,2.10^{-16}$
\end_inset

 donc inférieure à 
\begin_inset Formula $\alpha$
\end_inset

.
 Il y a donc quelque chose qui ne va pas dans notre modèle.
 C'est a priori surprenant puisque nous avons fait peu d'hypothèses.
 En fait, la seule hypothèse que nous faisons c'est qu'il y a quelque chose
 de périodique dans 
\begin_inset Formula $x$
\end_inset

.
 Et c'est justement cette assertion qui est fausse.
 
\end_layout

\begin_layout Standard
La taille de la population de lynx suit une équation de Lotka-Volterra (dans
 un système proies-prédateurs).
 Le nombre de prises est proportionnel à la taille de la population.
 Les lynx se nourrissent essentiellement de lièvres.
 En gros, quand il y a beaucoup de lièvres à manger, la population de lynx
 augmente, jusqu'à ce que les lynx mangent une grande partie des lièvres
 et se retrouvent affamés.
 La population de lynx baisse alors.
 Les lièvres étant moins chassés, leur population se met à augmenter et
 le cycle recommence.
 Voir les livres 
\begin_inset CommandInset citation
LatexCommand cite
key "berthelin,hirsch-smale-2013,hubbard-west"
literal "true"

\end_inset

 pour plus de détail sur ce système proies-prédateurs (en temps continu,
 mais c'est pareil en temps dicret).
\end_layout

\begin_layout Standard
La taille de la population a un comportement quasi-périodique mais n'est
 pas périodique, ce qui fait que notre méthode de moyenne mobile fonctionne
 mal.
\end_layout

\begin_layout Section
Feuille d'exercices numéro 3 (durée
\begin_inset space ~
\end_inset

: 3h)
\begin_inset Argument 1
status open

\begin_layout Plain Layout
Feuille d'exercices numéro 3
\end_layout

\end_inset


\end_layout

\begin_layout Subsection*
Préliminaires
\end_layout

\begin_layout Standard
Créer un fichier texte dans lequel vous répondrez clairement aux questions
 ci-dessous, en incluant vos codes 
\family typewriter
R
\family default
, les résultats obtenus sous 
\family typewriter
R
\family default
 (graphique y compris), vos interprétations, remarques ...
 Une fois ce TP fini, vous metterez en forme votre compte-rendu et l'exporterez
 au format pdf.
 
\end_layout

\begin_layout Subsection
Données 
\family typewriter
AirPassengers
\family default
 
\end_layout

\begin_layout Standard
Nous étudions la série chronologique du nombre de passagers par mois (en
 milliers) dans les transports aériens, de 1949 à 1960.
 Cette série est disponible sous 
\family typewriter
R
\family default
 (
\family typewriter
AirPassengers
\family default
).
 
\end_layout

\begin_layout Enumerate
Estimation paramétrique de la tendance 
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Enumerate
Représenter graphiquement la série.
 Ce processus vous semble-t-il stationnaire ? Présente-t-il des tendances
 et saisonnalités ? 
\end_layout

\begin_layout Enumerate
Estimer les paramètres d’une tendance linéaire 
\begin_inset Formula $at+b$
\end_inset

 par la méthode des moindres carrés (voir exercice 
\begin_inset CommandInset ref
LatexCommand ref
reference "enu:regression-lineaire"

\end_inset

 de la section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Feuille-d-exercices-numero-4"

\end_inset

) 
\end_layout

\begin_layout Enumerate
Supprimer cette tendance et représenter graphiquement la série ainsi obtenue.
 Vérifier que la série des résidus est de moyenne nulle.
 
\end_layout

\begin_layout Enumerate
\begin_inset CommandInset label
LatexCommand label
name "enu:Calculer-et-représenter"

\end_inset

Calculer et représenter l’auto-corrélation de la série des résidus.
 
\end_layout

\end_deeper
\begin_layout Enumerate
Méthode des différences 
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Enumerate
\begin_inset CommandInset label
LatexCommand label
name "enu:Appliquer-la-méthode"

\end_inset

Appliquer la méthode des différences pour enlever la tendance et la saisonnalité.
 Préciser la période de la saisonnalité, le degré du polynôme de tendance.
 
\end_layout

\begin_layout Enumerate
La série obtenue semble-t-elle stationnaire ? 
\end_layout

\end_deeper
\begin_layout Enumerate
Méthode des moyennes mobiles 
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Enumerate
\begin_inset CommandInset label
LatexCommand label
name "enu:Appliquer-la-méthode3"

\end_inset

Appliquer la méthode des moyennes mobiles pour enlever la tendance et la
 saisonnalité.
 
\end_layout

\begin_layout Enumerate
\begin_inset CommandInset label
LatexCommand label
name "enu:La-série-obtenue"

\end_inset

 Faire un test pour savoir si la série obtenue est une bruit blanc (utiliser
 fonction 
\family typewriter
Box.test
\family default
).
 On prendra (H0)=bruit blanc, (H1)=pas bruit blanc, probabilité de rejeter
 (H0) à tort=
\begin_inset Formula $\alpha$
\end_inset

 avec 
\begin_inset Formula $\alpha=0,05$
\end_inset

.
 
\end_layout

\end_deeper
\begin_layout Subsection
Données simulées 
\end_layout

\begin_layout Standard
Récupérer la série temporelle contenue dans le fichier
\family typewriter

\begin_inset Newline newline
\end_inset

https://math.unice.fr/~rubentha/enseignement/simulation.da
\family default
t.
 Cette série a été simulée à partir d’un processus relativement simple.
 Essayer de le retrouver
\begin_inset space ~
\end_inset

! 
\end_layout

\begin_layout Enumerate
Analyser qualitativement cette série temporelle.
 
\end_layout

\begin_layout Enumerate
Pouvez-vous proposer une modélisation pour cette série (c’est-à-dire définir
 le processus 
\begin_inset Formula $X_{t}$
\end_inset

 qui a généré cette série)
\begin_inset space ~
\end_inset

? Indication : la partie saisonnière est de la forme 
\begin_inset Formula $a\cos(t\pi/b)$
\end_inset

 ou 
\begin_inset Formula $a\sin(t\pi/b)$
\end_inset

 … à vous de deviner
\begin_inset space ~
\end_inset

! 
\end_layout

\begin_layout Subsection*
Appendice : mise en 
\begin_inset ERT
status open

\begin_layout Plain Layout

{
\backslash
oe}
\end_layout

\end_inset

uvre sous 
\family typewriter
R
\family default
 
\end_layout

\begin_layout Standard
Les indications concernent le premier exercice (on réutilisera les mêmes
 commandes pour l'exercice suivant).
 Nous mentionnons ici des commandes utiles dans les questions où on en a
 besoin pour la première fois.
\end_layout

\begin_layout Quote
La commande 
\family typewriter
as.numeric 
\family default
transforme une série temporelle en vecteur (ce qui est utile pour certaines
 opérations).
 
\end_layout

\begin_layout Quote
Question 
\begin_inset CommandInset ref
LatexCommand ref
reference "enu:Calculer-et-représenter"

\end_inset

.
 Utiliser la commande 
\family typewriter
acf
\family default
(...) pour calculer les autocorrelations empiriques (voir corrigé du premier
 TP).
 
\end_layout

\begin_layout Quote
Question 
\begin_inset CommandInset ref
LatexCommand ref
reference "enu:Appliquer-la-méthode"

\end_inset

.
 La fonction 
\family typewriter
diff.ts(serie,lag=T,difference=k
\family default
) (ou 
\family typewriter
diff
\family default
 tout court) permet d’appliquer l’opérateur de différenciation 
\begin_inset Formula $\Delta_{T}^{k}$
\end_inset

.
\end_layout

\begin_layout Quote
Question 
\begin_inset CommandInset ref
LatexCommand ref
reference "enu:Appliquer-la-méthode3"

\end_inset

.
 La fonction 
\family typewriter
decompose
\family default
 permet d’extraire d’une série temporelle (via la méthode de la moyenne
 mobile)
\begin_inset Newline newline
\end_inset

 (
\family typewriter
serie_decomp<-decompose(serie,type=c(”additive”,”mutltiplicative”)
\family default
, choisir 
\family typewriter
”additive”,”multiplicative”
\family default
 mais pas les deux en même temps)
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Quote
– la composante saisonnière : 
\family typewriter
serie_decomp$seasonal
\family default
, que l’on suppose additive ou multiplicative dans l’option type,
\end_layout

\begin_layout Quote
– la tendance : 
\family typewriter
serie_decomp$trend
\family default
,
\end_layout

\begin_layout Quote
– la partie aléatoire stationnaire de la série : 
\family typewriter
serie_decomp$random
\family default
.
 
\end_layout

\end_deeper
\begin_layout Quote
Question 
\begin_inset CommandInset ref
LatexCommand ref
reference "enu:La-série-obtenue"

\end_inset

.
 La fonction 
\family typewriter
Box.test(serie,lag=H)
\family default
 examine l’hypothèse nulle de nullité des H première auto-covariance, à
 l’aide du test du portemanteau.
 Par défaut H est fixé à 1, et seule la nullité de l’auto-covariance d’ordre
 1 est testée.
 Pour tester si la série peut-être apparentée à un bruit blanc, nous fixerons
 arbitrairement un H de l’ordre de 20 (nous considérerons abusivement que
 si les 20 premières auto-corrélations sont nulles, la série est indépendante).
 La première valeur affichée est la statistique du test.
 La 
\begin_inset Formula $p$
\end_inset

-value est la probabilité d'obtenir une valeur aussi élevée sous l'hypothèse
 nulle.
 Si nous voulons faire un test au niveau de confiance 
\begin_inset Formula $0,95$
\end_inset

 : dans le cas où cette valeur est 
\begin_inset Formula $<0,05$
\end_inset

, nous rejetons l'hypothèse nulle.
\end_layout

\begin_layout Standard
\begin_inset Note Comment
status collapsed

\begin_layout Section
Corrigé de la feuille d'exercices numéro 3 (code 
\family typewriter
R
\family default
 + commentaires)
\begin_inset Argument 1
status open

\begin_layout Plain Layout
Corrigé de la feuille d'exercices numéro 3
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\family typewriter
#Données AirPAssengers
\begin_inset Newline newline
\end_inset

#1
\begin_inset Newline newline
\end_inset

#1a
\begin_inset Newline newline
\end_inset

t=1:144; x=AirPassengers; n=length(x); y=t*x
\begin_inset Newline newline
\end_inset

#1b
\begin_inset Newline newline
\end_inset

#On utilise les formules des moindres carrés.
\begin_inset Newline newline
\end_inset

a=(6/(n*(n-1)))*(-sum(y)+(2*n+1)*n*mean(x)/3)
\begin_inset Newline newline
\end_inset

b=(12/(n*(n^2-1)))*(sum(y)-(n+1)*n*mean(x)/2)
\begin_inset Newline newline
\end_inset

print(a); print(b)
\begin_inset Newline newline
\end_inset

z=b*t+a
\begin_inset Newline newline
\end_inset

xn=as.numeric(x) #on transforme en vecteur pour contrôler l'échelle en abscisse
\begin_inset Newline newline
\end_inset

plot(t,xn,type='l'); lines(t,z,type='l',col='red')
\begin_inset Newline newline
\end_inset

#1c
\begin_inset Newline newline
\end_inset

xvect=as.numeric(x) 
\begin_inset Newline newline
\end_inset

#On met x sous forme vectorielle pour simplifier les manipulations.
\begin_inset Newline newline
\end_inset

residu=xvect-a-b*t
\begin_inset Newline newline
\end_inset

plot(t,residu,'l') 
\begin_inset Newline newline
\end_inset

print(mean(residu))
\begin_inset Newline newline
\end_inset

#1d
\begin_inset Newline newline
\end_inset

autoco=acf(residu,lag.max=40,type=c("correlation")); plot(autoco)
\begin_inset Newline newline
\end_inset


\end_layout

\begin_layout Plain Layout

\family typewriter
#2
\begin_inset Newline newline
\end_inset

 #2a 
\begin_inset Newline newline
\end_inset

T=12 
\begin_inset Newline newline
\end_inset

x1=diff.ts(x,lag=T,difference=1) 
\begin_inset Newline newline
\end_inset

x2=diff.ts(x,lag=T,difference=2) 
\begin_inset Newline newline
\end_inset

x3=diff.ts(x,lag=T,difference=3) 
\begin_inset Newline newline
\end_inset

print(mean(x1)); print(mean(x2)); print(mean(x3))
\begin_inset Newline newline
\end_inset

 # mean(x2) et mean(x3) sont du même ordre donc on en déduit que x2 est
 de moyenne nulle, donc la tendance est un polynôme d'ordre 1 et que la
 période est 12 (on peut aussi regarder les graphiques pour s'en convaincre)
\begin_inset Newline newline
\end_inset

 par(mfrow=c(3,1)); plot(x1); plot(x2); plot(x3) 
\begin_inset Newline newline
\end_inset

#2b Oui.
\begin_inset Newline newline
\end_inset


\end_layout

\begin_layout Plain Layout

\family typewriter
#3
\family default

\begin_inset Newline newline
\end_inset


\family typewriter
#3a 
\begin_inset Newline newline
\end_inset

x_dec=decompose(x,type=c("multiplicative"))
\begin_inset Newline newline
\end_inset

#3b 
\begin_inset Newline newline
\end_inset

plot(x_dec$random) 
\begin_inset Newline newline
\end_inset

xrw=window(x_dec$random,c(1949,7),c(1960,6)) 
\begin_inset Newline newline
\end_inset

#On enlève les valeurs non définies.
 
\begin_inset Newline newline
\end_inset

#Effectuons un test de niveau 0,05 
\begin_inset Newline newline
\end_inset

Box.test(xrw,lag=20) 
\begin_inset Newline newline
\end_inset

#On voit que la valeur de la statistique est au-dessus du seuil (0,05) donc
 on rejette l'hypothèse "bruit blanc".
 
\begin_inset Newline newline
\end_inset

autoco=acf(xrw,lag.max=40,type=c("correlation"))
\begin_inset Newline newline
\end_inset

#----------------------------------------------------------------------#
\begin_inset Newline newline
\end_inset


\end_layout

\begin_layout Plain Layout

\family typewriter
#Données simulées
\end_layout

\begin_layout Plain Layout

\family typewriter
#1 
\begin_inset Newline newline
\end_inset

data=scan(file="http://math.unice.fr/~rubentha/enseignement/simulation.dat")
\begin_inset Newline newline
\end_inset

x=ts(data,frequency=1); plot(x)
\begin_inset Newline newline
\end_inset

#2 
\begin_inset Newline newline
\end_inset

T=20 
\begin_inset Newline newline
\end_inset

x1=diff.ts(x,lag=T,difference=1) 
\begin_inset Newline newline
\end_inset

x2=diff.ts(x,lag=T,difference=2) 
\begin_inset Newline newline
\end_inset

x3=diff.ts(x,lag=T,difference=3) 
\begin_inset Newline newline
\end_inset

print(mean(x1)); print(mean(x2)); print(mean(x3)); 
\begin_inset Newline newline
\end_inset

# mean(x2) et mean(x3) sont du même ordre donc on en déduit que x2 est de
 moyenne nulle, donc la tendance est un polynôme d'ordre 1 et que la période
 est 20 
\begin_inset Newline newline
\end_inset

# on peut aussi regarder les graphiques pour s'en convaincre 
\begin_inset Newline newline
\end_inset

x=ts(x,frequency=20) 
\begin_inset Newline newline
\end_inset

x_dec=decompose(x,type=c("additive")) 
\begin_inset Newline newline
\end_inset

par(mfrow=c(4,1)) plot(x) plot(x_dec$trend) 
\begin_inset Newline newline
\end_inset

plot(x_dec$seasonal) 
\begin_inset Newline newline
\end_inset

plot(x_dec$random)
\family default
 
\end_layout

\end_inset


\end_layout

\begin_layout Chapter
Modélisation des séries stationnaires et des séries non-stationnaires
\end_layout

\begin_layout Section
Auto-corrélation partielle
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
Auto-corrélation partielle
\end_layout

\end_inset


\end_layout

\begin_layout Definition
Pour un processus stationnaire 
\begin_inset Formula $(X_{t})$
\end_inset

, le coefficient de corrélation partielle (on dit aussi corrélation partielle)
 entre 
\begin_inset Formula $X_{n}$
\end_inset

 et 
\begin_inset Formula $X_{1}$
\end_inset

 est 
\begin_inset Formula 
\[
r_{X_{2},\dots,X_{n}}(X_{1},X_{n})=\frac{1}{\sigma(0)}\cov(X_{1}-\E(X_{1}|X_{2},\dots,X_{n-1}),X_{n}-\E(X_{n}|X_{2},\dots,X_{n}))\,,
\]

\end_inset

le coefficient d'auto-corrélation partielle en 
\begin_inset Formula $h$
\end_inset

 est défini par 
\begin_inset Formula 
\[
\begin{cases}
r(h)=r_{X_{2},\dots,X_{h-1}}(X_{1},X_{h}) & \mbox{ pour }h\geq2\mbox{,}\\
r(1)=\rho(1)\mbox{,}\\
r(0)=1\mbox{,}\\
r(-h)=r(h) & \mbox{ pour }h\leq-1\mbox{.}
\end{cases}
\]

\end_inset

Pour un processus stationnaire, 
\begin_inset Formula 
\[
r(h)=r_{X_{n+1},\dots,X_{n+h-1}}(X_{n},X_{n+h})\mbox{ pour tout }n\mbox{.}
\]

\end_inset

Donc on va pouvoir estimer ces coefficients en faisant des moyennes empiriques
 (c'est ce que fait la fonction 
\family typewriter
pacf 
\family default
de 
\family typewriter
R
\family default
) 
\end_layout

\begin_layout Section
Les processus linéaires généraux
\end_layout

\begin_layout Standard
Soit 
\begin_inset Formula $(Y_{t})$
\end_inset

 une série qui est observée et soit 
\begin_inset Formula $(e_{t})$
\end_inset

 une série de bruit qui n’est pas observée.
\begin_inset Note Comment
status open

\begin_layout Plain Layout
 Le bruit satisfait les hypothèses classiques.
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Nous voulons écrire 
\begin_inset Formula $(Y_{t})$
\end_inset

 comme une combinaison linéaire des 
\begin_inset Formula $(e_{t})$
\end_inset

, c’est-à-dire que 
\shape italic
 nous voulons expliquer la série observée par les perturbations aléatoires
 passées
\shape default
.
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
Y_{t}=e_{t}+\psi_{1}e_{t-1}+\psi_{2}e_{t-2}+\cdots\label{eq: gen lin}
\end{equation}

\end_inset

Si c’est une somme infinie, des conditions spécifiques doivent être placés
 sur les coefficients pour que la somme soit convergeante.
\end_layout

\begin_layout Example
Supposons que (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq: gen lin"
plural "false"
caps "false"
noprefix "false"

\end_inset

) a la forme spécifique suivante 
\end_layout

\begin_layout Example
\begin_inset Formula 
\begin{equation}
Y_{t}=e_{t}+\psi e_{t-1}+\psi^{2}e_{t-2}+\cdots=\sum_{i=0}^{\infty}\psi^{i}e_{t-i}\quad\psi^{0}=1\label{eq: q-lin}
\end{equation}

\end_inset


\end_layout

\begin_layout Example
Ici, la condition pour que la somme dans (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq: q-lin"
plural "false"
caps "false"
noprefix "false"

\end_inset

) soit convergeante est
\begin_inset space ~
\end_inset

: 
\begin_inset Formula $|\psi|<1$
\end_inset

.
 Nous avons
\end_layout

\begin_layout Example
\begin_inset Formula $\E(Y_{t})=0$
\end_inset

 (
\begin_inset Formula $\forall t$
\end_inset

) 
\end_layout

\begin_layout Example
\begin_inset Formula $\var(Y_{t})=\frac{\sigma_{e}^{2}}{1-\psi^{2}}$
\end_inset

 (
\begin_inset Formula $\forall t$
\end_inset

)
\end_layout

\begin_layout Example
\begin_inset Formula $\cov(Y_{t},Y_{t-1})=\frac{\psi\sigma_{e}^{2}}{1-\psi^{2}}$
\end_inset

 et 
\begin_inset Formula $\cov(Y_{t},Y_{t-k})=\frac{\psi^{k}\sigma_{e}^{2}}{1-\psi^{2}}$
\end_inset

 (
\begin_inset Formula $\forall t$
\end_inset

)
\end_layout

\begin_layout Example
\begin_inset Formula $\frac{\cov(Y_{t},Y_{t-1})}{\var(Y_{t})}=\psi$
\end_inset

 et 
\begin_inset Formula $\frac{\cov(Y_{t},Y_{t-k})}{\var(Y_{t})}=\psi^{k}$
\end_inset

 (
\begin_inset Formula $\forall t$
\end_inset

)
\end_layout

\begin_layout Example
La processus est stationnaire
\begin_inset space ~
\end_inset

: l’autocovariance ne dépend pas au temps 
\begin_inset Formula $t$
\end_inset

, seulement du décalage du temps (lag) 
\begin_inset Formula $k$
\end_inset

.
\end_layout

\begin_layout Standard
Avant de nous lancer dans le reste de la section, nous avons besoin de définir
 quelques notions.
 On définit l'opérateur de décalage sur les suites stationnaires:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
L\,:\,(Y_{t})_{t\geq0}\mapsto\left(L(Y)_{t}=\begin{cases}
Y_{t-1} & \mbox{ si }t\geq1\\
0 & \mbox{ si }t=0
\end{cases}\right)_{t\geq0}
\]

\end_inset

(ici, 
\begin_inset Formula $(Y_{t})$
\end_inset

 est une suite stationnaire).
 Pour un polynôme 
\begin_inset Formula $P\in\mathbb{C}[X]$
\end_inset

 (
\begin_inset Formula $P(X)=\alpha_{0}+\alpha_{1}X+\dots+\alpha_{n}X$
\end_inset

, 
\begin_inset Formula $n$
\end_inset

 étant le degré de 
\begin_inset Formula $P$
\end_inset

), nous définissons l'opérateur 
\begin_inset Formula $P(L)$
\end_inset

 par
\begin_inset space ~
\end_inset

: 
\begin_inset Formula 
\[
P(L)\,:\,(Y_{t})_{t\geq0}\mapsto(P(L)(Y)_{t})\text{ avec }P(L)(Y)_{t}=\begin{cases}
\alpha Y_{t}+\alpha_{1}Y_{t-1}+\dots+\alpha_{n}Y_{t-n} & \text{ si }t\geq n\,,\\
0 & \text{ sinon.}
\end{cases}
\]

\end_inset

Nous remarquons que pour deux polynômes 
\begin_inset Formula $P$
\end_inset

 et Q
\begin_inset space ~
\end_inset

: 
\begin_inset Formula 
\[
P(L)Q(L)=(PQ)(L)\,,
\]

\end_inset

où le produit de gauche est la composition.
\end_layout

\begin_layout Lemma
Pour 
\begin_inset Formula $\lambda$
\end_inset

 un nombre complexe de module 
\begin_inset Formula $<1$
\end_inset

, l’opérateur 
\begin_inset Formula $1-\lambda L$
\end_inset

 admet pour inverse 
\begin_inset Formula 
\[
(1-\lambda L)^{-1}=\sum_{k=0}^{+\infty}(\lambda L)^{k}\,.
\]

\end_inset


\end_layout

\begin_layout Proof
Pour toute suite stationnaire 
\begin_inset Formula $(Y_{t})_{t\geq0}$
\end_inset

, nous regardons à 
\begin_inset Formula $t$
\end_inset

 fixé
\begin_inset space ~
\end_inset

: 
\begin_inset Formula 
\[
\sum_{k=0}^{+\infty}\left((\lambda L)^{k}Y\right)_{t}=\sum_{k=0}^{t}\lambda^{k}Y_{t-k}\,,
\]

\end_inset

qui est une somme finie.
 Donc la suite 
\begin_inset Formula 
\[
\left(\sum_{k=0}^{+\infty}(\lambda L)^{k}Y\right)_{t\geq0}
\]

\end_inset

est bien définie.
 Nous avons 
\begin_inset Formula 
\begin{multline*}
Y=(Y_{0},Y_{1},\dots)\overset{\sum_{k=0}^{+\infty}(\lambda L)^{k}}{\longmapsto}(Y_{0},Y_{1}+\lambda Y_{0},Y_{2}+\lambda Y_{1}+\lambda^{2}Y_{2},\dots)\\
\overset{1-\lambda L}{\longmapsto}(Y_{0},(Y_{1}+\lambda Y_{0})-\lambda Y_{0},(Y_{2}+\lambda Y_{1}+\lambda^{2}Y_{2})-\lambda(Y_{1}+\lambda Y_{0})-\lambda^{2}Y_{0},\dots)\\
=(Y_{0},Y_{1},Y_{2},\dots)\,.
\end{multline*}

\end_inset

Donc 
\begin_inset Formula $(1-\lambda L)\sum_{k=0}^{+\infty}(\lambda L)^{k}=\Id$
\end_inset

.
 On montre facilement de même que 
\begin_inset Formula $\sum_{k=0}^{+\infty}(\lambda L)^{k}(1-\lambda L)=\Id$
\end_inset

.
 
\end_layout

\begin_layout Section
Les processus auto-régressifs 
\end_layout

\begin_layout Definition
Un processus 
\begin_inset Formula $(X_{t})$
\end_inset

 est dit auto-régressif
\begin_inset Index idx
status open

\begin_layout Plain Layout
Processus auto-régressif
\end_layout

\end_inset

 d'ordre 
\begin_inset Formula $p$
\end_inset

 centré s'il vérifie 
\begin_inset Formula 
\begin{equation}
X_{t}=\epsilon_{t}+\sum_{j=1}^{p}a_{j}X_{t-j}\,,\,\mbox{pour tout }t\geq0\label{eq:ARp-1}
\end{equation}

\end_inset

(avec 
\begin_inset Formula $p\in\N^{*}$
\end_inset

, 
\begin_inset Formula $a_{p}\neq0$
\end_inset

) avec des 
\begin_inset Formula $\epsilon_{t}$
\end_inset

 qui forment un bruit blanc centré de variance 
\begin_inset Formula $\sigma^{2}$
\end_inset

 (
\begin_inset Formula $p\in\N^{*}$
\end_inset

, 
\begin_inset Formula $a_{1},\dots,a_{p}\in\R$
\end_inset

), tels que 
\begin_inset Formula $\epsilon_{t}$
\end_inset

 est indépendant de 
\begin_inset Formula $X_{t-1}$
\end_inset

, 
\begin_inset Formula $X_{t-2}$
\end_inset

, … pour tout 
\begin_inset Formula $t$
\end_inset

.
 Par convention
\begin_inset space ~
\end_inset

: 
\begin_inset Formula $X_{-k}=0$
\end_inset

 pour tout 
\begin_inset Formula $k$
\end_inset

 dans 
\begin_inset Formula $\N^{*}$
\end_inset

.
 On dira aussi que 
\begin_inset Formula $(X_{t})$
\end_inset

 est un processus 
\begin_inset Formula $AR(p)$
\end_inset


\begin_inset Index idx
status open

\begin_layout Plain Layout
AR(...)
\end_layout

\end_inset

.
\end_layout

\begin_layout Definition
On dit que le 
\begin_inset Formula $X_{t}$
\end_inset

 "s'explique " par les 
\begin_inset Formula $p$
\end_inset

 observations précédentes (
\begin_inset Formula $X_{t-1},X_{t-2},\cdots,X_{t-p}$
\end_inset

).
 Dans cette définition, le processus 
\begin_inset Formula $(\epsilon_{t})$
\end_inset

 s'appelle processus des innovations
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
Innovations
\end_layout

\end_inset

.
 
\end_layout

\begin_layout Example

\series bold
AR(1)
\series default

\begin_inset Formula 
\begin{equation}
Y_{t}=aY_{t-1}+e_{t}\label{eq: AR1}
\end{equation}

\end_inset

Nous supposons que la série 
\begin_inset Formula $(Y_{t})$
\end_inset

 est stationnaire, et de moyenne zéro.
\end_layout

\begin_layout Example
\begin_inset Formula $\var(Y_{t})=\frac{\sigma_{e}^{2}}{1-a^{2}}$
\end_inset

 (
\begin_inset Formula $\forall t$
\end_inset

)
\end_layout

\begin_layout Example
\begin_inset Formula $\cov(Y_{t},Y_{t-1})=\frac{a\sigma_{e}^{2}}{1-a^{2}}$
\end_inset

 et 
\begin_inset Formula $\cov(Y_{t},Y_{t-k})=a^{k}\frac{\sigma_{e}^{2}}{1-a^{2}}$
\end_inset

 (
\begin_inset Formula $\forall t$
\end_inset

)
\end_layout

\begin_layout Example
\begin_inset Formula $\frac{\cov(Y_{t},Y_{t-1})}{\var(Y_{t})}=a$
\end_inset

 et 
\begin_inset Formula $\frac{\cov(Y_{t},Y_{t-k})}{\var(Y_{t})}=a^{k}$
\end_inset

 
\end_layout

\begin_layout Example
Vu la forme de la covariance, on pourrait suspecter que 
\begin_inset Formula $|a|<1$
\end_inset

 si la série est stationnaire.
 Mais pour le justifier rigoureusement, nous devons aller plus loin dans
 l'étude des propriétés d’un modèle AR.
\end_layout

\begin_layout Example

\series bold
L’inversion d’un modèle AR(1) et la condition pour la stationnarité 
\end_layout

\begin_layout Example
Nous écrivons récursivement 
\begin_inset Formula 
\begin{align*}
Y_{t}= & aY_{t-1}+e_{t}=e_{t}+a\underbrace{(aY_{t-2}+e_{t-1})}_{Y_{t-1}}
\end{align*}

\end_inset

Si nous répétons la substitution 
\begin_inset Formula $k-1$
\end_inset

 fois, nous arrivons à 
\begin_inset Formula 
\begin{equation}
Y_{t}=e_{t}+ae_{t-1}+a^{2}e_{t-2}+\cdots+a^{k-1}e_{t-k+1}+a^{k}Y_{t-k}\label{eq: rec AR}
\end{equation}

\end_inset

Ce qui resemble l'équation (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq: q-lin"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
 Si nous laissons 
\begin_inset Formula $k\to\infty$
\end_inset

, il y a convergence si et seulement si 
\begin_inset Formula $|a|<1$
\end_inset

 et nous l'équation (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq: q-lin"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
 Dpnc la condition pour la stationnarité semble être 
\begin_inset Formula $|a|<1$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Example

\series bold
AR(2)
\series default
 
\begin_inset Formula 
\begin{equation}
Y_{t}=a_{1}Y_{t-1}+a_{2}Y_{t-2}+e_{t}\label{eq: AR2}
\end{equation}

\end_inset

En utilisant l' opérateur de décalage 
\begin_inset Formula $L$
\end_inset

, avec 
\begin_inset Formula $L(Y_{t})=Y_{t-1}$
\end_inset

 et en general 
\begin_inset Formula $L^{k}(Y_{t})=Y_{t-k}$
\end_inset

 alors (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq: AR2"
plural "false"
caps "false"
noprefix "false"

\end_inset

) peut s'écrire
\begin_inset space ~
\end_inset

: 
\begin_inset Formula 
\begin{equation}
(1-a_{1}L-a_{2}L^{2})Y_{t}=e_{t}\label{eq: LAR2}
\end{equation}

\end_inset

On défini le polynôme caractéristique de la relation (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq: AR2"
plural "false"
caps "false"
noprefix "false"

\end_inset

)
\begin_inset space ~
\end_inset

: 
\begin_inset Formula 
\begin{equation}
P(X)=1-a_{1}X-a_{2}X^{2}\label{eq: pol char}
\end{equation}

\end_inset


\end_layout

\begin_layout Example
Pour que l'opérateur 
\begin_inset Formula $(1-\phi_{1}L-\phi_{2}L^{2})$
\end_inset

 soit invertible, il faut placer des conditions sur les racines de 
\begin_inset Formula $P$
\end_inset

 (nous verrons plus loin quelles sont ces conditions).
 Après, nous transformons (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq: LAR2"
plural "false"
caps "false"
noprefix "false"

\end_inset

) 
\begin_inset Formula 
\begin{align}
 & \psi(L):=(1-a_{1}L-a_{2}L^{2})^{-1}\label{psiL}\\
 & Y_{t}=\psi(L)e_{t}\label{AR noise}
\end{align}

\end_inset

Pour inverser 
\begin_inset Formula $\psi(L)$
\end_inset

, on fait comme si on développait une fraction en série entière
\begin_inset space ~
\end_inset

:
\end_layout

\begin_layout Example
\begin_inset Formula 
\[
\frac{1}{1-a_{1}L-a_{2}L^{2}}=1+a_{1}L+a_{2}L^{2}+(a_{1}L+a_{2}L^{2})^{2}+\dots
\]

\end_inset

Ainsi, (
\begin_inset CommandInset ref
LatexCommand ref
reference "AR noise"
plural "false"
caps "false"
noprefix "false"

\end_inset

) devient 
\begin_inset Formula 
\begin{equation}
Y_{t}=e_{t}+a_{1}e_{t-1}+a_{2}e_{t-2}+\cdots\label{eq: AR2 inv}
\end{equation}

\end_inset

Nous arrivons à la forme inversée infinie.
 Pour préciser la forme des coefficients dans (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq: AR2 inv"
plural "false"
caps "false"
noprefix "false"

\end_inset

) , nous appelons 
\begin_inset Formula $r_{1},r_{2}$
\end_inset

 les racines du polynôme caractéristique et 
\begin_inset Formula $R_{1}=\frac{1}{r_{1}}$
\end_inset

, 
\begin_inset Formula $R_{2}=\frac{1}{r_{2}}$
\end_inset

.
 Nous avons alors la factorisation
\end_layout

\begin_layout Example
\begin_inset Formula 
\[
\frac{1}{1-a_{1}z-a_{2}z^{2}}=\frac{1}{(1-R_{1}z)(1-R_{2}z)}=\frac{A}{1-R_{1}z}+\frac{B}{1-R_{2}z}
\]

\end_inset


\end_layout

\begin_layout Example
\begin_inset Formula 
\[
A=\frac{r_{2}}{r_{2}-r_{2}}\quad B=\frac{-r_{1}}{r_{2}-r_{1}}
\]

\end_inset


\end_layout

\begin_layout Example
\begin_inset Formula 
\begin{equation}
\frac{1}{1-a_{1}z-a_{2}z^{2}}=\sum_{i=0}^{\infty}(AR_{1}^{i}+BR_{2}^{i})z^{i}\label{eq: inversion pol}
\end{equation}

\end_inset

Il est donc clair qu'on a besoin d’ étudier les racines du polynôme caractéristi
que.
\end_layout

\begin_layout Example
\begin_inset Note Comment
status collapsed

\begin_layout Plain Layout
Pour AR(2) d’être invertible et alors stationnaire il faut que ses racines
 sont hors du circle unitaire.
\end_layout

\end_inset

 
\begin_inset Note Comment
status collapsed

\begin_layout Plain Layout
Nous montrerons quelques conditions pour les coefficients de 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq: AR2"
plural "false"
caps "false"
noprefix "false"

\end_inset

 
\end_layout

\end_inset

Nous savons que.
 
\begin_inset Formula 
\[
r_{1}=\frac{a_{1}+\sqrt{a_{1}^{2}+4a_{2}}}{2a_{2}}\,,\,r_{2}=\frac{a_{1}-\sqrt{a_{1}^{2}+4a_{2}}}{2a_{2}}
\]

\end_inset

Et (puisque 
\begin_inset Formula $r_{1}\times r_{2}=-1/a_{2})$
\end_inset


\begin_inset Formula 
\[
R_{1}=-r_{2}\times a_{2}=\frac{-a_{1}+\sqrt{a_{1}^{2}+4a_{2}}}{2}\quad R_{2}=-r_{1}\times a_{2}=\frac{-a_{1}-\sqrt{a_{1}^{2}+4a_{2}}}{2}
\]

\end_inset

Par (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq: inversion pol"
plural "false"
caps "false"
noprefix "false"

\end_inset

), il est clair qu’il faut 
\begin_inset Formula $|R_{i}|<1$
\end_inset

 for 
\begin_inset Formula $i=1,2$
\end_inset

 
\end_layout

\begin_layout Example
Racines 
\series bold
réelles.

\series default
 Pour avoir deux solutions réelles il faut 
\begin_inset Formula $a_{1}^{2}+4a_{2}\geq0$
\end_inset

.
 Nous voulons
\begin_inset space ~
\end_inset

:
\begin_inset Formula 
\[
-1<\frac{a_{1}-\sqrt{a_{1}^{2}+4a_{2}}}{2}<\frac{a_{1}+\sqrt{a_{1}^{2}+4a_{2}}}{2}<1\,.
\]

\end_inset


\begin_inset Note Comment
status collapsed

\begin_layout Plain Layout
en faisant les calcules nécessaires on arrive à les conditions 
\begin_inset Formula 
\[
a_{2}-a_{1}<1\quad et\quad a_{2}+a_{1}<1
\]

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Example
Racines 
\series bold
complexes.
 
\series default
Pour avoir deux solutions complexes il faut 
\begin_inset Formula $a_{1}^{2}+4a_{2}<0$
\end_inset

 Ici, les 
\begin_inset Formula $R_{1}$
\end_inset

, 
\begin_inset Formula $R_{2}$
\end_inset

 sont complexes conjuguées et donc 
\begin_inset Formula 
\[
|R_{1}|=|R_{2}|<1\Leftrightarrow|R_{1}|^{2}<1
\]

\end_inset


\begin_inset Formula 
\[
|R_{1}|^{2}=\frac{a_{1}^{2}+(-a_{1}^{2}-4a_{2})}{4}=-a_{2}
\]

\end_inset

Et alors, la condition est
\begin_inset space ~
\end_inset

: 
\begin_inset Formula $|a_{2}|<1$
\end_inset

.
 
\end_layout

\begin_layout Standard

\end_layout

\begin_layout Proposition
\begin_inset CommandInset label
LatexCommand label
name "prop:existence-AR-stationnaire-1"

\end_inset

On associe le polynôme de 
\begin_inset Formula $\R[X]$
\end_inset

 suivant à l'équation (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:ARp-1"
plural "false"
caps "false"
noprefix "false"

\end_inset

) 
\begin_inset Formula 
\[
A(X)=1-a_{1}X-\dots-a_{p}X^{p}\,.
\]

\end_inset

Si les racines (dans 
\begin_inset Formula $\mathbb{C}$
\end_inset

) de ce polynôme sont toutes de module strictement supérieur à 
\begin_inset Formula $1$
\end_inset

 alors il existe un processus stationnaire 
\begin_inset Formula $(X_{t})$
\end_inset

 vérifiant (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:ARp-1"
plural "false"
caps "false"
noprefix "false"

\end_inset

) et tel que 
\begin_inset Formula $\epsilon_{t}$
\end_inset

 est le bruit d'innovation 
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
Bruit d'innovation
\end_layout

\end_inset

 pour ce processus (c'est à dire que, pour tout 
\begin_inset Formula $t$
\end_inset

, 
\begin_inset Formula $\epsilon_{t}$
\end_inset

 est indépendant de 
\begin_inset Formula $X_{t-1},X_{t-2},\dots$
\end_inset

).
 
\end_layout

\begin_layout Remark
La condition " racines de 
\begin_inset Formula $A$
\end_inset

 de module 
\begin_inset Formula $>$
\end_inset

 1 " n'est pas nécessaire à l'existence d'une suite stationnaire vérifiant
 (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:ARp-1"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
 Voir le chapitre 5 de l'édition en anglais de 
\begin_inset CommandInset citation
LatexCommand cite
key "gourieroux-montfort-1997"
literal "true"

\end_inset

 pour plus de détails.
 
\end_layout

\begin_layout Proof
On peut toujours développer la fraction rationnelle 
\begin_inset Formula $1/A(z)$
\end_inset

 (
\begin_inset Formula $z\in\mathbb{C}$
\end_inset

) dans un voisinage de 
\begin_inset Formula $0$
\end_inset

 
\begin_inset Formula 
\begin{multline*}
\frac{1}{A(z)}=\frac{1}{1-a_{1}z-\dots-a_{p}z^{p}}=1-(a_{1}z+\dots+a_{p}z^{p})-(a_{1}z+\dots+a_{p}z^{p})^{2}-\dots\\
=1+\alpha_{1}z+\alpha_{2}z^{2}+\dots
\end{multline*}

\end_inset

pour certains coefficients 
\begin_inset Formula $\alpha_{1}$
\end_inset

, 
\begin_inset Formula $\alpha_{2}$
\end_inset

, … (on remarque que ces coefficients sont dans 
\begin_inset Formula $\R$
\end_inset

).
 Plus précisément, nous avons pour tout 
\begin_inset Formula $z$
\end_inset

, 
\begin_inset Formula 
\[
\frac{1}{A(z)}=\prod_{i=1}^{p}\left(\frac{1}{1-u_{i}z}\right),
\]

\end_inset

où l'ensemble des racines de 
\begin_inset Formula $A$
\end_inset

 est 
\begin_inset Formula $\{1/u_{1},\dots,1/u_{p}\}$
\end_inset

 (les racines apparaissent avec leur multiplicité).
 Donc, pour 
\begin_inset Formula $z$
\end_inset

 tel que 
\begin_inset Formula $|z|<\inf_{i}(1/|u_{i}|)$
\end_inset

, nous pouvons développer en produit de séries entières 
\begin_inset Formula 
\[
\frac{1}{A(z)}=\prod_{i=1}^{p}\left(\sum_{k=0}^{+\infty}u_{i}^{k}z^{k}\right)\,.
\]

\end_inset

Quand on développe le produit ci-dessus, le coefficient de 
\begin_inset Formula $z^{n}$
\end_inset

 est 
\begin_inset Formula 
\[
\alpha_{n}=\sum_{\begin{array}{c}
j_{1},\dots,j_{p}\geq0\\
j_{1}+\dots+j_{p}=n
\end{array}}u_{1}^{j_{1}}\dots u_{p}^{j_{p}}\,.
\]

\end_inset

Donc 
\begin_inset Formula 
\begin{equation}
|\alpha_{n}|\leq(\sup_{i}|u_{i}|)^{n}\frac{(n+1)^{p}}{p!}\label{eq:maj-alpha-1}
\end{equation}

\end_inset

(nous utilisons
\begin_inset space ~
\end_inset

: 
\begin_inset Formula $\#\{(j_{1},\dots,j_{p})\in(\N)^{p}\,:\,j_{1}+\dots+j_{p}=n\}=\frac{(n+1)^{p}}{p!}$
\end_inset

 , qui nécessite un petit calcul).
\end_layout

\begin_layout Proof
On suppose que l'on dispose d'un bruit blanc 
\begin_inset Formula $(\epsilon_{k})_{k\in\Z}$
\end_inset

.
 On fixe 
\begin_inset Formula $t$
\end_inset

 dans 
\begin_inset Formula $\N$
\end_inset

 et on s'intéresse à la suite 
\begin_inset Formula $(Y_{k}=\epsilon_{t}+\alpha_{1}\epsilon_{t-1}+\dots+\alpha_{k}\epsilon_{t-k})_{k\geq1}$
\end_inset

.
 La série 
\begin_inset Formula $\sum_{n\geq1}|\alpha_{n}|$
\end_inset

 est convergente (petit exercice sur la convergence des séries, c'est ici
 que l'on utilise que 
\begin_inset Formula $\sup_{i}|u_{i}|<1$
\end_inset

) donc la série 
\begin_inset Formula $\sum_{n\geq1}\alpha_{n}^{2}$
\end_inset

 aussi.
 En particulier, pour tout 
\begin_inset Formula $\delta>0$
\end_inset

, il existe 
\begin_inset Formula $N$
\end_inset

 dans 
\begin_inset Formula $\N$
\end_inset

 tel que 
\begin_inset Formula 
\[
n\geq N\Rightarrow\forall k\geq0\,,\,\alpha_{n}^{2}+\alpha_{n+1}^{2}+\dots+\alpha_{n+k}^{2}<\delta\,.
\]

\end_inset

Pour tout 
\begin_inset Formula $n>N$
\end_inset

 et 
\begin_inset Formula $k\geq0$
\end_inset

, nous avons alors 
\begin_inset Formula 
\begin{eqnarray*}
\E((Y_{n}-Y_{n+k})^{2}) & = & \E((\alpha_{n+1}\epsilon_{t-n-1}+\dots+\alpha_{n+k}\epsilon_{t-n-k})^{2})\\
 & = & (\alpha_{n+1}^{2}+\dots+\alpha_{n+k}^{2})\sigma^{2}\\
 & < & \delta
\end{eqnarray*}

\end_inset

Donc la suite 
\begin_inset Formula $(Y_{n})_{n\geq1}$
\end_inset

 est une suite de Cauchy dans 
\begin_inset Formula $L^{2}(\p)$
\end_inset

 (l'espace des variables aléatoire réelles de carré intégrable, muni de
 la norme 
\begin_inset Formula $L^{2}$
\end_inset

).
 Comme cette espace est complet, la suite 
\begin_inset Formula $(Y_{n})_{n\geq1}$
\end_inset

 converge dans 
\begin_inset Formula $L^{2}$
\end_inset

 vers une limite que nous noterons 
\begin_inset Formula $X_{t}$
\end_inset

.
 Nous pouvons écrire 
\begin_inset Formula 
\begin{equation}
X_{t}=\epsilon_{t}+\alpha_{1}\epsilon_{t-1}+\alpha_{2}\epsilon_{t-2}+\dots\label{eq:AM-ordre-infini-1}
\end{equation}

\end_inset

(en considérant le terme de droite comme une limite dans 
\begin_inset Formula $L^{2}$
\end_inset

).
\end_layout

\begin_layout Proof
Nous aimerions montrer que cette limite a aussi lieu p.s.
 Soit 
\begin_inset Formula $\delta>0$
\end_inset

.
 For all 
\begin_inset Formula $n\geq1$
\end_inset

, 
\begin_inset Formula 
\begin{eqnarray*}
\p(|Y_{n}-X_{t}|\geq\delta) & = & \p((\alpha_{n+1}\epsilon_{t-n-1}+\alpha_{n+2}\epsilon_{t-n-1}+\dots)^{2}\geq\delta^{2})\\
\mbox{(inégalité de Markov)} & \leq & \frac{\E((\alpha_{n+1}\epsilon_{t-n-1}+\alpha_{n+2}\epsilon_{t-n-2}+\dots)^{2})}{\delta^{2}}\\
 & = & \frac{\sigma^{2}(\alpha_{n+1}^{2}+\alpha_{n+2}^{2}+\dots)}{\delta^{2}}\,.
\end{eqnarray*}

\end_inset

Et donc 
\begin_inset Formula 
\begin{eqnarray*}
\sum_{n\geq1}\p(|Y_{n}-X_{t}|\geq\delta) & \leq & \sum_{n\geq1}\frac{\sigma^{2}(\alpha_{n+1}^{2}+\alpha_{n+2}^{2}+\dots)}{\delta^{2}}\\
 & = & \frac{\sigma^{2}}{\delta^{2}}\sum_{n\geq2}(n-1)\alpha_{n}^{2}\\
 & < & \infty
\end{eqnarray*}

\end_inset

(petit exercices sur les séries à partir de l'équation (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:maj-alpha-1"
plural "false"
caps "false"
noprefix "false"

\end_inset

)).
 Le lemme de Borel-Cantelli nous dit que, p.s., il existe un 
\begin_inset Formula $N$
\end_inset

 tel que, pour 
\begin_inset Formula $n>N$
\end_inset

, 
\begin_inset Formula $|Y_{n}-X_{t}|<\delta$
\end_inset

.
 Ceci est valable pour tout 
\begin_inset Formula $\delta>0$
\end_inset

, donc (attention, nous sautons une étape de la démonstration) 
\begin_inset Formula $Y_{n}\convps X_{t}$
\end_inset

.
\end_layout

\begin_layout Proof
Montrons que les 
\begin_inset Formula $X_{t}$
\end_inset

 que nous venons de définir vérifient la relation de récurrence (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:ARp-1"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
 Nous avons, pour tout 
\begin_inset Formula $t$
\end_inset

, 
\begin_inset Formula 
\begin{eqnarray*}
X_{t}-a_{1}X_{t-1}-\dots-a_{p}X_{t-p} & = & \epsilon_{t}+\alpha_{1}\epsilon_{t-1}+\alpha_{2}\epsilon_{t-2}+\dots\\
 &  & -a_{1}(\epsilon_{t-1}+\alpha_{1}\epsilon_{t-2}+\alpha_{2}\epsilon_{t-3}+\dots)\\
 &  & -\dots\\
 &  & -a_{p}(\epsilon_{t-p}+\alpha_{1}\epsilon_{t-p-1}+\alpha_{2}\epsilon_{t-p-2}+\dots)\\
\mbox{(convention }\alpha_{0}=1\mbox{)} & = & \epsilon_{t}+\epsilon_{t-1}(\alpha_{1}-a_{1})+\epsilon_{t-2}(\alpha_{2}-a_{1}\alpha_{1}-a_{3})\\
 &  & +\dots\\
 &  & +\epsilon_{t-k}(\alpha_{k}-\sum_{1\leq i\leq k\wedge p}\alpha_{k-i}a_{i})\\
 &  & +\dots
\end{eqnarray*}

\end_inset

Nous avons, pour tout 
\begin_inset Formula $z$
\end_inset

 dans un voisinage adéquat de 
\begin_inset Formula $0$
\end_inset

, 
\begin_inset Formula 
\begin{eqnarray*}
1 & = & A(z)\times\frac{1}{A(z)}\\
 & = & (1-a_{1}z-\dots-a_{p}z^{p})\times(1+\alpha_{1}z+\alpha_{2}z^{2}+\dots)\,.
\end{eqnarray*}

\end_inset

Si nous développons ce dernier produit, nous trouvons une série entière
 dans laquelle le coefficient de 
\begin_inset Formula $z^{n}$
\end_inset

 (
\begin_inset Formula $n\geq1$
\end_inset

) est 
\begin_inset Formula 
\[
\alpha_{n}-\sum_{1\leq i\leq n\wedge p}\alpha_{k-i}a_{i},
\]

\end_inset

qui doit être nul puisque la série vaut 
\begin_inset Formula $1$
\end_inset

.
 Donc 
\begin_inset Formula 
\[
X_{t}-a_{1}X_{t-1}-\dots-a_{p}X_{t-p}=\epsilon_{t}\,.
\]

\end_inset

On montre facilement que la suite 
\begin_inset Formula $(X_{t})_{t\geq1}$
\end_inset

 est sationnaire (exercice) (voir la définition 
\begin_inset CommandInset ref
LatexCommand ref
reference "def:processus-stationnaire"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
 
\end_layout

\begin_layout Proposition
S'il existe un processus stationnaire 
\begin_inset Formula $(X_{t})_{t\geq0}$
\end_inset

 satisfaisant la relation de récurrence de l'équation (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:ARp-1"
plural "false"
caps "false"
noprefix "false"

\end_inset

) alors sa fonction d'auto-covariance vérifie
\begin_inset space ~
\end_inset

: 
\begin_inset Formula 
\begin{equation}
\text{pour \ensuremath{h>0}, }\sigma(h)=a_{1}\sigma(h-1)+a_{2}\sigma(h-2)+\dots+a_{p}\sigma(h-p)\,,\label{eq:rec-cov-AR-1}
\end{equation}

\end_inset


\begin_inset Formula 
\[
\text{et }\sigma(0)=\sigma^{2}+a_{1}\sigma(1)+a_{2}\sigma(2)+\dots+a_{p}\sigma(p)\,,
\]

\end_inset


\end_layout

\begin_layout Proposition
et sa fonction d'auto-corrélation vérifie 
\begin_inset Formula 
\[
\text{pour }h>1\text{, }\rho(h)=a_{1}\rho(h-1)+a_{2}\rho(h-2)+\dots+a_{p}\rho(h-p)\,.
\]

\end_inset


\end_layout

\begin_layout Proof
Nous avons pour tout 
\begin_inset Formula $t$
\end_inset

 et tout 
\begin_inset Formula $h\geq1$
\end_inset

, 
\begin_inset Formula 
\begin{eqnarray*}
\cov(X_{t}X_{t+h}) & = & \E(X_{t}X_{t+h})\\
\sigma(h) & = & \E(X_{t}(\epsilon_{t+h}+\sum_{i=1}^{p}a_{i}X_{t+h-i}))\\
\sigma(h) & = & 0+\sum_{i=1}^{p}a_{i}\sigma(h-i)
\end{eqnarray*}

\end_inset

et 
\begin_inset Formula 
\begin{eqnarray*}
\sigma(0)=\var(X_{t}) & = & \E(X_{t}(\epsilon_{t}+\sum_{i=1}^{p}a_{i}X_{t-i}))\\
 & = & \E(X_{t}\epsilon_{t})+\sum_{i=1}^{p}a_{i}\sigma(i)\\
 & = & \E((\epsilon_{t}+\sum_{i=1}^{p}a_{i}X_{t-i})\epsilon_{t})+\sum_{i=1}^{p}a_{i}\sigma(i)\\
\text{(car }\epsilon_{t}\text{ ind. de }X_{j}\text{ pour }j<t\text{)} & = & \sigma^{2}+\sum_{i=1}^{p}a_{i}\sigma(i)\,.
\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Standard
Le polynôme caractéristique de la relation de récurrence de l'équation (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:rec-cov-AR-1"
plural "false"
caps "false"
noprefix "false"

\end_inset

) est 
\begin_inset Formula 
\begin{eqnarray*}
B(X)=X^{p}-a_{1}X^{p-1}-\dots-a_{p} & = & X^{p}\left(1-\frac{a_{1}}{X}-\dots-\frac{a_{p}}{X^{p}}\right)\\
 & = & X^{p}A\left(\frac{1}{X}\right)\,.
\end{eqnarray*}

\end_inset

Donc, si les racines de 
\begin_inset Formula $A$
\end_inset

 sont de modules 
\begin_inset Formula $>1$
\end_inset

, alors celle de 
\begin_inset Formula $B$
\end_inset

 sont de module 
\begin_inset Formula $<1$
\end_inset

.
 Si les racines de 
\begin_inset Formula $B$
\end_inset

 sont distinctes égales à 
\begin_inset Formula $\lambda_{1},\lambda_{2},\dots,\lambda_{p}$
\end_inset

, les solutions de (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:rec-cov-AR-1"
plural "false"
caps "false"
noprefix "false"

\end_inset

) sont de la forme 
\begin_inset Formula 
\[
\sigma(h)=\sum_{i=1}^{p}c_{i}\lambda_{i}^{h}
\]

\end_inset

(voir 
\begin_inset CommandInset citation
LatexCommand cite
key "gourdon-2008"
literal "true"

\end_inset

, p.
 196 pour plus de détails).
 On en déduit le résultat suivant.
\end_layout

\begin_layout Lemma
S'il existe un processus stationnaire 
\begin_inset Formula $(X_{t})_{t\geq0}$
\end_inset

 satisfaisant la relation de récurrence de l'équation (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:ARp-1"
plural "false"
caps "false"
noprefix "false"

\end_inset

) et si le polynôme de la relation de récurrence a des racines qui sont
 toutes de module 
\begin_inset Formula $>1$
\end_inset

, alors la fonction d'auto-covariance du processus décroît exponentiellement
 quand 
\begin_inset Formula $h\rightarrow+\infty$
\end_inset

 (et donc sa fonction d'auto-corrélation a le même comportement).
 
\end_layout

\begin_layout Proposition
S'il existe un processus stationnaire 
\begin_inset Formula $(X_{t})_{t\geq0}$
\end_inset

 satisfaisant la relation de récurrence de l'équation (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:ARp-1"
plural "false"
caps "false"
noprefix "false"

\end_inset

) alors sa fonction d'auto-corrélation partielle vérifie
\begin_inset space ~
\end_inset

: 
\begin_inset Formula 
\[
r(h)=0\text{ si }h\geq p+1\,.
\]

\end_inset


\end_layout

\begin_layout Proof
Soit 
\begin_inset Formula $h\geq p+1$
\end_inset

.
 Nous calculons pour 
\begin_inset Formula $t$
\end_inset

 quelconque
\begin_inset space ~
\end_inset

: 
\begin_inset Formula 
\begin{eqnarray*}
\E(X_{t+h}|X_{t+1},\dots,X_{t+h-1}) & = & \E(\epsilon_{t+h}+a_{1}X_{t+h-1}+\dots+a_{p}X_{t+h-p}|X_{t+1},\dots,X_{t+h-1})\\
 & = & a_{1}X_{t+h-1}+\dots+a_{p}X_{t+h-p}\,,
\end{eqnarray*}

\end_inset


\begin_inset Formula 
\[
X_{t+h}-\E(X_{t+h}|X_{t+1},\dots,X_{t+h-1})=\epsilon_{t+h}\,,
\]

\end_inset


\begin_inset Formula 
\begin{multline*}
\E(X_{t}|X_{t+1},\dots,X_{t+h-1})=\\
\E\left(-\frac{1}{a_{p}}(X_{t+p}-\epsilon_{t+p}-a_{1}X_{t+p-1}-\dots-a_{p-1}X_{t+1})|X_{t+1},\dots,X_{t+h-1}\right)=\\
-\frac{1}{a_{p}}(X_{t+p}-a_{1}X_{t+p-1}-\dots-a_{p-1}X_{t+1})\,,
\end{multline*}

\end_inset


\begin_inset Formula 
\[
X_{t}-\E(X_{t}|X_{t+1},\dots,X_{t+h-1})=\frac{\epsilon_{t+p}}{a_{p}}\,.
\]

\end_inset

Donc 
\begin_inset Formula 
\[
\cov(X_{t+h}-\E(X_{t+h}|X_{t+1},\dots,X_{t+h-1}),X_{t}-\E(X_{t}|X_{t+1},\dots,X_{t+h-1}))=0\,.
\]

\end_inset


\end_layout

\begin_layout Section
Les processus moyennes mobiles
\end_layout

\begin_layout Definition
Les processus en moyenne mobile
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
Processus en moyenne mobile
\end_layout

\end_inset


\end_layout

\begin_layout Definition
Un processus en moyenne mobile d'ordre 
\begin_inset Formula $q$
\end_inset

 est un processus de la forme 
\begin_inset Formula 
\begin{equation}
X_{t}=\epsilon_{t}+b_{1}\epsilon_{t-1}+\dots+b_{q}\epsilon_{t-q}\,,\,\mbox{pour tout }t\geq0\label{eq:MA(q)-1}
\end{equation}

\end_inset

(avec 
\begin_inset Formula $q\in\N^{*}$
\end_inset

, 
\begin_inset Formula $b_{q}\neq0$
\end_inset

) avec des 
\begin_inset Formula $(\epsilon_{t})$
\end_inset

 qui forment un bruit blanc centré de variance 
\begin_inset Formula $\sigma^{2}$
\end_inset

.
 Par convention
\begin_inset space ~
\end_inset

: 
\begin_inset Formula $\epsilon_{-k}=0$
\end_inset

 pour tout 
\begin_inset Formula $k$
\end_inset

 dans 
\begin_inset Formula $\N^{*}$
\end_inset

.
 On dira aussi que 
\begin_inset Formula $(X_{t})$
\end_inset

 est un processus 
\begin_inset Formula $MA(q)$
\end_inset

.
 
\end_layout

\begin_layout Standard
Pour un bruit blanc centré 
\begin_inset Formula $(\epsilon_{t})$
\end_inset

, un tel processus existe toujours et est toujours stationnaire.
\end_layout

\begin_layout Proposition
L'auto-covariance d'un processus 
\begin_inset Formula $MA(q)$
\end_inset

 vérifiant l'équation (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:MA(q)-1"
plural "false"
caps "false"
noprefix "false"

\end_inset

) vérifie, pour 
\begin_inset Formula $h\geq0$
\end_inset

, 
\begin_inset Formula 
\[
\sigma(h)=\begin{cases}
\sigma^{2}\sum_{k=0}^{q-h}b_{k}b_{k+h} & \mbox{ si }h\leq q\,,\\
0 & \mbox{ si }h>q\,,
\end{cases}
\]

\end_inset

sous la convention 
\begin_inset Formula $b_{0}=1$
\end_inset

.
 
\end_layout

\begin_layout Proof
Nous calculons 
\begin_inset Formula 
\begin{eqnarray*}
\E(X_{t}X_{t+h}) & = & \E\left(\left(\sum_{k=0}^{q}\epsilon_{t-k}b_{k}\right)\times\left(\sum_{k=0}^{q}\epsilon_{t+h-k}b_{k}\right)\right)\\
 & = & \begin{cases}
0 & \mbox{ si }h>q\,,\\
\sum_{k=q}^{q-h}\E(\epsilon_{t-k}b_{k}\epsilon_{t-k}b_{k+h}) & \mbox{ sinon .}
\end{cases}
\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Standard
De la proposition 
\begin_inset CommandInset ref
LatexCommand ref
reference "prop:existence-AR-stationnaire-1"
plural "false"
caps "false"
noprefix "false"

\end_inset

 et de l'équation (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:AM-ordre-infini-1"
plural "false"
caps "false"
noprefix "false"

\end_inset

), nous déduisons le corollaire suivant.
\end_layout

\begin_layout Corollary
Sous les hypothèses de la proposition 
\begin_inset CommandInset ref
LatexCommand ref
reference "prop:existence-AR-stationnaire-1"
plural "false"
caps "false"
noprefix "false"

\end_inset

, le processus 
\begin_inset Formula $AR(p)$
\end_inset

 stationnaire vérifiant l'équation de récurrence (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:ARp-1"
plural "false"
caps "false"
noprefix "false"

\end_inset

) peut s'écrire comme un processus 
\begin_inset Formula $AM$
\end_inset

 d'ordre infini (au sens de l'équation (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:AM-ordre-infini-1"
plural "false"
caps "false"
noprefix "false"

\end_inset

) (dans laquelle la limite a lieu p.s.
 et dans 
\begin_inset Formula $L^{2}$
\end_inset

).
 
\end_layout

\begin_layout Standard
La démonstration du résultat suivant étant similaire à la démonstration
 de la proposition 
\begin_inset CommandInset ref
LatexCommand ref
reference "prop:existence-AR-stationnaire-1"
plural "false"
caps "false"
noprefix "false"

\end_inset

, nous le citons comme un simple corollaire.
\end_layout

\begin_layout Corollary
Si 
\begin_inset Formula $(X_{t})_{t\geq0}$
\end_inset

 est un processus 
\begin_inset Formula $AM(q)$
\end_inset

 satisfaisant l'équation (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:MA(q)-1"
plural "false"
caps "false"
noprefix "false"

\end_inset

) et si le polynôme 
\begin_inset Formula $B(X)=1+b_{1}X+\dots+b_{q}X^{q}$
\end_inset

 n'admet que des racines de module 
\begin_inset Formula $>1$
\end_inset

 , alors 
\begin_inset Formula $(X_{t})$
\end_inset

 peut s'écrire comme un processus 
\begin_inset Formula $AR$
\end_inset

 d'ordre infini et tel que 
\begin_inset Formula $\epsilon_{t}$
\end_inset

 est le bruit d'innovation pour ce processus.
\begin_inset Newline newline
\end_inset

 En particulier, sa fonction d'auto-corrélation partielle vérifie
\begin_inset space ~
\end_inset

: 
\begin_inset Formula 
\[
r(h)\underset{h\rightarrow+\infty}{\longrightarrow}0\,.
\]

\end_inset


\end_layout

\begin_layout Standard
En effet, en partant de l'équation (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:MA(q)-1"
plural "false"
caps "false"
noprefix "false"

\end_inset

), on peut exprimer 
\begin_inset Formula $\epsilon_{t}$
\end_inset

 en fonction de 
\begin_inset Formula $X_{t}$
\end_inset

, 
\begin_inset Formula $X_{t-1}$
\end_inset

, … pour tout 
\begin_inset Formula $t$
\end_inset

 (de même qu'en partant de l'équation (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:ARp-1"
plural "false"
caps "false"
noprefix "false"

\end_inset

), on peut exprimer 
\begin_inset Formula $X_{t}$
\end_inset

 en fonction de 
\begin_inset Formula $\epsilon_{t}$
\end_inset

, 
\begin_inset Formula $\epsilon_{t-1}$
\end_inset

, … pour tout 
\begin_inset Formula $t$
\end_inset

).
 Pour plus de détail voir 
\begin_inset CommandInset citation
LatexCommand cite
key "gourieroux-montfort-1997"
literal "true"

\end_inset

 (ces questions sont développées au chapitre 5 de l'édition en anglais de
 ce livre).
\end_layout

\begin_layout Section
Les processus mixtes ARMA(p,q).
 
\end_layout

\begin_layout Definition
Un processus auto-régressif en moyenne mobile
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
Processus auto-régressif en moyenne mobile
\end_layout

\end_inset

 d'ordres 
\begin_inset Formula $p$
\end_inset

, 
\begin_inset Formula $q$
\end_inset

 (tels que 
\begin_inset Formula $p\times q\neq0$
\end_inset

) est un processus qui peut s'écrire 
\begin_inset Formula 
\begin{equation}
X_{t}=\sum_{k=1}^{p}a_{k}X_{t-k}+\sum_{j=0}^{q}b_{j}\epsilon_{t-j}\,,\,\mbox{pour tout }t\geq0\,,\label{eq:def-ARMA-1}
\end{equation}

\end_inset

où les 
\begin_inset Formula $(\epsilon_{j})$
\end_inset

 sont des bruits blancs centrés de variance 
\begin_inset Formula $\sigma^{2}$
\end_inset

.
 Par convention
\begin_inset space ~
\end_inset

: 
\begin_inset Formula $X_{-k}=\epsilon_{-k}$
\end_inset

 pour tout 
\begin_inset Formula $k$
\end_inset

 dans 
\begin_inset Formula $\N^{*}$
\end_inset

.
 On dira aussi que 
\begin_inset Formula $(X_{t})$
\end_inset

 est un processus 
\begin_inset Formula $ARMA(p,q)$
\end_inset

.
\end_layout

\begin_layout Definition
On peut toujours écrire 
\begin_inset Formula 
\[
X_{t}-a_{1}X_{t-1}-\dots-a_{p}X_{t-p}=\epsilon_{t}+b_{1}\epsilon_{t-1}+\dots+b_{q}\epsilon_{t-q}\,,
\]

\end_inset

d'où la relation 
\begin_inset Formula 
\begin{eqnarray*}
\cov(X_{t+h}-a_{1}X_{t+h-1}-\dots-a_{p}X_{t+h-p},X_{t}) & = & \sigma(h)-a_{1}\sigma(h-1)-\dots-a_{p}\sigma(h-p)\\
 & = & \cov(\epsilon_{t+h}+b_{1}\epsilon_{t+h-1}+\dots+b_{q}\epsilon_{t+h-q},X_{t})\,.
\end{eqnarray*}

\end_inset

Cette dernière quantité est nulle dès que 
\begin_inset Formula $h>q$
\end_inset

.
 Les auto-covariances d'un processus 
\begin_inset Formula $ARMA(p,q)$
\end_inset

 vérifie donc la même relation de récurrence que celles d'un processus 
\begin_inset Formula $AR(p)$
\end_inset

 à partir d'un certain rang.
 Donc ces auto-covariances (ainsi que les auto-corrélations correspondantes)
 convergent exponentiellement vite vers 
\begin_inset Formula $0$
\end_inset

 à l'infini.
 
\end_layout

\begin_layout Proposition
\begin_inset CommandInset label
LatexCommand label
name "prop:racines-communes-1"

\end_inset

On s'intéresse à la relation de récurrence (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:def-ARMA-1"
plural "false"
caps "false"
noprefix "false"

\end_inset

) ci-dessus.
 On définit les polynômes 
\begin_inset Formula 
\[
A(X)=1-a_{1}X-\dots-a_{p}X^{p}\,,\,B(X)=1+b_{1}X+\dots+b_{q}X^{q}\,.
\]

\end_inset

Si les racines de 
\begin_inset Formula $A$
\end_inset

 et 
\begin_inset Formula $B$
\end_inset

 sont de modules 
\begin_inset Formula $>1$
\end_inset

, alors il existe un processus stationnaire vérifiant la relation (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:def-ARMA-1"
plural "false"
caps "false"
noprefix "false"

\end_inset

) et tel que 
\begin_inset Formula $\epsilon_{t}$
\end_inset

 est le bruit d'innovation pour ce processus.
\end_layout

\begin_layout Proposition
Si les racines de 
\begin_inset Formula $A$
\end_inset

 et 
\begin_inset Formula $B$
\end_inset

 sont de module 
\begin_inset Formula $>1$
\end_inset

 alors : " 
\begin_inset Formula $(X_{t})$
\end_inset

 ne vérifie pas de relation de récurrence plus courte que (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:def-ARMA-1"
plural "false"
caps "false"
noprefix "false"

\end_inset

) " implique " 
\begin_inset Formula $A$
\end_inset

 et 
\begin_inset Formula $B$
\end_inset

 n'ont pas de racine commune ".
 Si on suppose, de plus, que les 
\begin_inset Formula $(\epsilon_{t})$
\end_inset

 on des densités par rapport à la mesure de Lebesgue, alors les deux proposition
s sont équivalentes.
 
\end_layout

\begin_layout Remark
Pour plus de détail voir 
\begin_inset CommandInset citation
LatexCommand cite
key "gourieroux-montfort-1997"
literal "true"

\end_inset

 (ces questions sont développées au chapitre 5 de l'édition en anglais de
 ce livre).
 
\end_layout

\begin_layout Proof
[Démonstration partielle de la proposition 
\begin_inset CommandInset ref
LatexCommand ref
reference "prop:racines-communes-1"
plural "false"
caps "false"
noprefix "false"

\end_inset

] Supposons que 
\begin_inset Formula $A$
\end_inset

 et 
\begin_inset Formula $B$
\end_inset

 n’ont que des racines de module 
\begin_inset Formula $>1$
\end_inset

.
 Supposons, de plus, que 
\begin_inset Formula $A$
\end_inset

 et 
\begin_inset Formula $B$
\end_inset

 ont une racine commune, nous allons montrer que 
\begin_inset Formula $(X_{t})$
\end_inset

 et 
\begin_inset Formula $(\epsilon_{t})$
\end_inset

 vérifie une relation plus courte que (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:def-ARMA-1"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
 Notons 
\begin_inset Formula $1/\lambda$
\end_inset

 une racine commune à 
\begin_inset Formula $A$
\end_inset

 et 
\begin_inset Formula $B$
\end_inset

.
 Nous avons donc 
\begin_inset Formula $p\geq1$
\end_inset

 et 
\begin_inset Formula $q\geq1$
\end_inset

.
 Nous pouvons écrire 
\begin_inset Formula 
\[
A(X)=(1-\lambda X)A_{1}(X)\,,\,B(X)=(1-\lambda X)B_{1}(X)
\]

\end_inset

avec 
\begin_inset Formula $A_{1}$
\end_inset

 polynôme de degré 
\begin_inset Formula $p-1$
\end_inset

 et 
\begin_inset Formula $B_{1}$
\end_inset

 polynôme de degré 
\begin_inset Formula $q-1$
\end_inset

.
 Nous avons 
\begin_inset Formula 
\begin{eqnarray*}
A(L)X & = & B(L)\epsilon\\
(1-\lambda L)A_{1}(L)X & = & (1-\lambda L)B_{1}(L)\epsilon\\
(1-\lambda L)^{-1}(1-\lambda L)A_{1}(L)X & = & (1-\lambda L)^{-1}(1-\lambda L)B_{1}(L)\epsilon\\
A_{1}(L)(X) & = & B_{1}(L)\epsilon\,.
\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Example
Soient 
\begin_inset Formula 
\[
A(X)=\left(1-\frac{X}{2}\right)\left(1-\frac{X}{3}\right)\,,\,B(X)=\left(1-\frac{X}{2}\right)\left(1+\frac{X}{4}\right)\,.
\]

\end_inset

Nous avons 
\begin_inset Formula 
\begin{eqnarray*}
A(X) & = & 1-\frac{5}{6}X+\frac{X^{2}}{6}\,,\\
B(X) & = & 1-\frac{X}{4}-\frac{X^{2}}{8}\,.
\end{eqnarray*}

\end_inset

On s’intéresse au processus 
\begin_inset Formula $ARMA(2,2)$
\end_inset

 (stationnaire) vérifiant la relation de récurrence
\begin_inset space ~
\end_inset

: 
\begin_inset Formula 
\begin{equation}
X_{t}-\frac{5}{6}X_{t-1}+\frac{1}{6}X_{t-2}=\epsilon_{t}-\frac{1}{4}\epsilon_{t-1}-\frac{1}{8}\epsilon_{t-2}\,.\label{eq:rec-01-1}
\end{equation}

\end_inset

Les polynômes caractéristiques de cette relation sont les 
\begin_inset Formula $A$
\end_inset

, 
\begin_inset Formula $B$
\end_inset

 ci-dessus.
 Ils ont une racine commune (
\begin_inset Formula $2$
\end_inset

).
 Nous allons montrer que 
\begin_inset Formula $(X_{t})$
\end_inset

, 
\begin_inset Formula $(\epsilon_{t})$
\end_inset

 vérifient une relation de récurrence plus courte que (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:rec-01-1"
plural "false"
caps "false"
noprefix "false"

\end_inset

).Soit la suite 
\begin_inset Formula 
\begin{eqnarray*}
(Y_{0},Y_{1},Y_{2,}\dots,Y_{t},\dots) & = & (X_{0},X_{1}-\frac{5}{6}X_{0},X_{2}-\frac{5}{6}X_{1}+\frac{1}{6}X_{0},\dots,X_{t}-\frac{5}{6}X_{t-1}+\frac{1}{6}X_{t-2},\dots)\\
 & = & (\epsilon_{0},\epsilon_{1}-\frac{1}{4}\epsilon_{0},\epsilon_{2}-\frac{1}{4}\epsilon_{1}-\frac{1}{8}\epsilon_{0},\dots,\epsilon_{t}-\frac{1}{4}\epsilon_{t-1}-\frac{1}{8}\epsilon_{t-2},\dots)\,.
\end{eqnarray*}

\end_inset

Par convention, 
\begin_inset Formula $X_{-k}=\epsilon_{-k}=0$
\end_inset

 pour tout 
\begin_inset Formula $k$
\end_inset

 dans 
\begin_inset Formula $\N^{*}$
\end_inset

.
 Et donc
\begin_inset space ~
\end_inset

: 
\begin_inset Formula 
\[
X_{0}=X_{0}-\frac{5}{6}X_{-1}+\frac{1}{6}X_{-2}\,,\,X_{1}=X_{1}-\frac{5}{6}X_{0}+\frac{1}{6}X_{-1}\,.
\]

\end_inset

Calculons maintenant 
\begin_inset Formula 
\[
(Y_{0},Y_{1}+\frac{1}{2}Y_{0},Y_{2}+\frac{1}{2}Y_{1}+\frac{1}{2^{2}}Y_{2},\dots,Y_{t}+\frac{1}{2}Y_{t-1}+\dots+\frac{1}{2^{t}}Y_{0},\dots)\,.
\]

\end_inset

Le terme général de cette suite est 
\begin_inset Formula 
\[
Y_{t}+\frac{1}{2}Y_{t-1}-\dots+\frac{1}{2^{t}}Y_{0}=\sum_{k=0}^{+\infty}\frac{1}{2^{k}}Y_{t-k}\,,
\]

\end_inset

puisque les termes de la somme sont nuls à parti d’un certain rang.
 Donc, pour tout 
\begin_inset Formula $t\geq0$
\end_inset


\begin_inset space ~
\end_inset

: 
\begin_inset Formula 
\begin{eqnarray*}
Y_{t}+\frac{1}{2}Y_{t-1}-\dots+\frac{1}{2^{t}}Y_{0} & = & \sum_{k=0}^{+\infty}\frac{1}{2^{k}}\left(X_{t-k}-\frac{5}{6}X_{t-k-1}+\frac{1}{6}X_{t-k-2}\right)\\
 & = & X_{t}+\left(-\frac{5}{6}X_{t-1}+\frac{1}{2}X_{t-1}\right)+\sum_{j=2}^{+\infty}X_{t-j}\left(\frac{1}{2^{j}}-\frac{1}{2^{j-1}}\frac{5}{6}+\frac{1}{2^{j-2}}\frac{1}{6}\right)\\
 & = & X_{t}-\frac{1}{3}X_{t-1}+\sum_{j=2}^{+\infty}X_{t-j}\frac{1}{2^{j}}A(2)\\
 & = & X_{t}-\frac{1}{3}X_{t-1}\,.
\end{eqnarray*}

\end_inset

De même
\begin_inset space ~
\end_inset

: 
\begin_inset Formula 
\begin{eqnarray*}
Y_{t}+\frac{1}{2}Y_{t-1}-\dots+\frac{1}{2^{t}}Y_{0} & = & \sum_{k=0}^{+\infty}\frac{1}{2^{k}}\left(\epsilon_{t-k}-\frac{1}{4}\epsilon_{t-k-1}-\frac{1}{8}\epsilon_{t-k-2}\right)\\
 & = & \epsilon_{t}+\left(-\frac{1}{4}\epsilon_{t-1}+\frac{1}{2}\epsilon_{t-1}\right)+\sum_{j=2}^{+\infty}\epsilon_{t-j}\left(\frac{1}{2^{j}}-\frac{1}{2^{j-1}}\frac{1}{4}-\frac{1}{2^{j-2}}\frac{1}{8}\right)\\
 & = & \epsilon_{t}+\frac{1}{4}\epsilon_{t-1}+\sum_{j=2}^{+\infty}\epsilon_{t-j}\frac{1}{2^{j}}B(2)\\
 & = & \epsilon_{t}+\frac{1}{4}\epsilon_{t-1}\,.
\end{eqnarray*}

\end_inset

Nous avons donc la relation
\begin_inset space ~
\end_inset

: 
\begin_inset Formula 
\[
X_{t}-\frac{1}{3}X_{t-1}=\epsilon_{t}+\frac{1}{4}\epsilon_{t-1}\,,\,\mbox{pour tout }t\in\N^{*}\,.
\]

\end_inset


\end_layout

\begin_layout Section
Tableau des propriétés
\end_layout

\begin_layout Standard
\begin_inset Float table
placement h
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="4">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Modèle 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $MA(q)$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $AR(p)$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $ARMA(p,q)$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
auto-corrélation 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\rho(h)=0$
\end_inset

 si 
\begin_inset Formula $h>q$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\rho(h)\underset{h\rightarrow+\infty}{\longrightarrow}0$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\rho(h)\underset{h\rightarrow+\infty}{\longrightarrow}0$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
auto-corrélation partielle 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $r(h)\underset{h\rightarrow+\infty}{\longrightarrow}0$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $r(h)=0$
\end_inset

 si 
\begin_inset Formula $h>p$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $r(h)\underset{h\rightarrow+\infty}{\longrightarrow}0$
\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Tableau des propriétés
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Voir à la fin du chapitre pour des illustrations de ce tableau (pages tirées
 du polycopié 
\begin_inset CommandInset citation
LatexCommand cite
key "jacques"
literal "true"

\end_inset

).
\end_layout

\begin_layout Standard
Ces propriétés servent à identifier la nature des séries temporelles.
 Sous 
\family typewriter
R
\family default
, on utilisera les fonctions 
\family typewriter
acf
\family default
, 
\family typewriter
pacf 
\family default
qui tracent, respectivement, les 
\begin_inset Formula $\widehat{\rho}(h)$
\end_inset

 et les 
\begin_inset Formula $\widehat{r}(h)$
\end_inset

 (les auto-corrélations empiriques et les auto-corrélations partielles empirique
s).
 Le logiciel trace en plus un niveau bleu horizontal en 
\begin_inset Formula $y=m_{\alpha}$
\end_inset

 tel que pour tout 
\begin_inset Formula $h$
\end_inset

, 
\begin_inset Formula $\p(|\widehat{\rho}(h)|\geq m_{\alpha}|\rho(h)=0)=\alpha$
\end_inset

 (en général, le niveau 
\begin_inset Formula $\alpha$
\end_inset

 est fixé à 
\begin_inset Formula $0,05$
\end_inset

) (la situation est la même pour les auto-corrélations partielles empiriques).
 On peut fixer 
\begin_inset Formula $\alpha$
\end_inset

 en ajoutant l’option : 
\family typewriter
acf(…,ci=alpha)
\family default
.
 Un 
\begin_inset Formula $\widehat{\rho}(h)$
\end_inset

 sous la courbe bleue est donc non significatif (au niveau 
\begin_inset Formula $\alpha$
\end_inset

).
 Le raisonnement est le suivant : on suppose 
\begin_inset Formula $\rho(h)=0$
\end_inset

, si 
\begin_inset Formula $|\widehat{\rho}(h)|<m_{\alpha}$
\end_inset

, on considère qu’il n’est pas nécessaire de revenir sur cette hypothèse
 de départ.
 La probabilité de rejeter à tort l’hypothèse " nulle " (
\begin_inset Formula $\rho(h)=0$
\end_inset

) est 
\begin_inset Formula $\alpha$
\end_inset

.
\end_layout

\begin_layout Standard
Mais quand on veut utiliser le tableau ci-dessus, on cherche à savoir à
 partir de quel indice les 
\begin_inset Formula $\rho(h)$
\end_inset

 sont nuls (par exemple), pas si l’un d’eux est nul
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
Voir 
\begin_inset Flex URL
status collapsed

\begin_layout Plain Layout

https://xkcd.com/882/
\end_layout

\end_inset

 sur le problème des tests multiples.
\end_layout

\end_inset

.
 Si on s’intéresse à la nullité de 
\begin_inset Formula $(\rho(n),\rho(n+1),\dots,\rho(n+l-1))$
\end_inset

, on pourrait vouloir trouver 
\begin_inset Formula $\beta$
\end_inset

 tel que 
\begin_inset Formula 
\[
\p(\exists h\in\{n,n+1,\dots,n+l-1\}\mbox{ , }\widehat{\rho}(h)\geq m_{\beta}|(\rho(n),\dots,\rho(n+l-1))=(0,\dots,0))\leq\alpha\mbox{ .}
\]

\end_inset

Les 
\begin_inset Formula $\widehat{\rho}(h)$
\end_inset

 sont supposés indépendants donc la probabilité ci-dessus est 
\begin_inset Formula 
\begin{eqnarray*}
1-\p(\forall h,|\widehat{\rho}(h)|<m_{\beta}|\dots) & = & 1-(1-\beta)^{l}\\
 & = & l\beta+o(\beta)
\end{eqnarray*}

\end_inset

(quand 
\begin_inset Formula $\beta$
\end_inset

 est petit).
 Donc on prend, en général, 
\begin_inset Formula $\beta=\alpha/l$
\end_inset

.
\end_layout

\begin_layout Standard
Si on appelle les fonctions 
\family typewriter
acf
\family default
 ou 
\family typewriter
pacf
\family default
 sans préciser le 
\family typewriter
lag.max
\family default
, le logiciel le fixe par défaut à 
\begin_inset Formula $10\log_{10}(n)$
\end_inset

 (où 
\begin_inset Formula $n$
\end_inset

 est la longueur de la série).
 La raison est que l’on ne veut pas prendre le 
\family typewriter
lag.max 
\family default
trop grand parce que les moyennes empiriques ne convergent pas bien pour
 
\begin_inset Formula $h$
\end_inset

 grand.
 On conseille en général de prendre 
\begin_inset Formula $n\geq50$
\end_inset

 et 
\begin_inset Formula $h\leq n/4$
\end_inset

 (voir 
\begin_inset CommandInset citation
LatexCommand cite
key "brockwell-davis-2002"
literal "true"

\end_inset

, p.
 60 et 
\begin_inset CommandInset citation
LatexCommand cite
key "box-jenkins-reinsel-2008"
literal "true"

\end_inset

, p.
 32).
\end_layout

\begin_layout Section
Les modèles des séries non-stationnaires
\end_layout

\begin_layout Subsection
Définitions théoriques
\begin_inset space ~
\end_inset

: ARIMA et SARIMA 
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
ARIMA
\end_layout

\end_inset


\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
SARIMA
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Comment
status open

\begin_layout Example
Nous disposons d’une série temporelle 
\begin_inset Formula $(x_{1},\dots,x_{n})$
\end_inset

 qui a une saisonnalité de période 
\begin_inset Formula $12$
\end_inset

.
 On étudie 
\begin_inset Formula $y_{t}=x_{t}-x_{t-12}$
\end_inset

 (pour supprimer la saisonnalité).
 L’ajustement d’un modèle 
\begin_inset Formula $ARMA$
\end_inset

 et les prévisions sont réalisées sur la série 
\begin_inset Formula $(y_{t})$
\end_inset

.
 On écrit ensuite les 
\begin_inset Formula $(x_{t})$
\end_inset

 en fonction des 
\begin_inset Formula $(y_{t})$
\end_inset


\begin_inset space ~
\end_inset

: 
\begin_inset Formula 
\begin{eqnarray*}
x_{t} & = & y_{t}+x_{t-12}\\
 & = & y_{t}+y_{t-12}+x_{t-24}\\
 & = & \dots\\
 & = & y_{t}+y_{t-12}+\dots+y_{r+12}+x_{r}\,,
\end{eqnarray*}

\end_inset

avec 
\begin_inset Formula $r=t\mbox{ modulo }12$
\end_inset

 (le reste de la division euclidienne de 
\begin_inset Formula $t$
\end_inset

 par 
\begin_inset Formula $12$
\end_inset

).
 
\end_layout

\begin_layout Plain Layout
On connaît les 
\begin_inset Formula $x_{1},\dots,x_{n}$
\end_inset

 (
\begin_inset Formula $n$
\end_inset

 supposé plus grand que 
\begin_inset Formula $12$
\end_inset

), et donc aussi 
\begin_inset Formula $y_{1},\dots,y_{n}$
\end_inset

.
 On peut calculer les prévisions 
\begin_inset Formula $\widehat{y}_{n,h}$
\end_inset

 (
\begin_inset Formula $h\geq1$
\end_inset

).
 On en déduit les prévisions 
\begin_inset Formula $\widehat{x}_{n,h}$
\end_inset

.
 Par exemple, si 
\begin_inset Formula $h\in\{1,2,\dots,11\}$
\end_inset

, nous utilisons l’égalité ci-dessus avec 
\begin_inset Formula $t=n+h$
\end_inset

 pour calculer la prévision 
\begin_inset Formula 
\[
\widehat{x}_{n,h}=\widehat{y}_{n,h}+y_{t-12}+\dots+\dots+y_{r+12}+x_{r}\,.
\]

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Ce sont des généralisation des processus 
\begin_inset Formula $ARMA$
\end_inset

 aux cas non stationnaires, avec tendance polynômiale (
\begin_inset Formula $ARIMA$
\end_inset

) ou avec une saisonnalité (
\begin_inset Formula $SARIMA$
\end_inset

).
 Ce sont les processus directement utilisés par 
\family typewriter
R
\family default
.
\end_layout

\begin_layout Definition
Le processus 
\begin_inset Formula $(X_{t})_{t\geq0}$
\end_inset

 est un processus 
\begin_inset Formula $ARIMA(p,d,q)$
\end_inset

 si le processus 
\begin_inset Formula $Y_{t}=\Delta_{1}^{d}X_{t}$
\end_inset

 est une processus 
\begin_inset Formula $ARMA(p,q)$
\end_inset

.
\end_layout

\begin_layout Standard
Les processus 
\begin_inset Formula $ARIMA(p,d,q)$
\end_inset

 sont donc bien adaptés à l’étude des séries temporelles présentant une
 tendance polynômiale de degré 
\begin_inset Formula $d-1$
\end_inset

.
\end_layout

\begin_layout Definition
Le processus 
\begin_inset Formula $(X_{t})_{t\geq0}$
\end_inset

 est un processus 
\begin_inset Formula $SARIMA(p,d,q,T)$
\end_inset

 si le processus 
\begin_inset Formula $Y_{t}=\Delta_{T}\circ\Delta_{1}^{d}X_{t}$
\end_inset

 est un processus 
\begin_inset Formula $ARMA(p,q)$
\end_inset

.
 
\end_layout

\begin_layout Standard
Les processus 
\begin_inset Formula $SARIMA(p,d,q,T)$
\end_inset

 sont donc bien adaptés à l’étude des séries temporelles qui présentent
 une saisonnalité de période 
\begin_inset Formula $T$
\end_inset

 et qui ont une tendance polynômiale de degré 
\begin_inset Formula $d-1$
\end_inset

.
\end_layout

\begin_layout Remark
Attention, il existe dans la littérature des définitions de processus 
\begin_inset Formula $SARIMA$
\end_inset

 plus complexes.
 
\end_layout

\begin_layout Standard
Dès qu'une série n’est pas de moyenne constante, elle est non-stationnaire.
 Pour qu'une série soit stationnaire il faut que se moyen et sa covariance
 ne dépendent pas du temps 
\begin_inset Formula $t$
\end_inset

.
 Nous commençons par quelques exemples de processus non-stationnaires.
 Dans toutes les exemples essayez vous-mêmes de calculer l'espérance et
 covariance pour vous familiariser avec les sommes infinies et calculs.
 
\end_layout

\begin_layout Subsection
Quelques exemples
\end_layout

\begin_layout Example
\begin_inset CommandInset label
LatexCommand label
name "Example 1"

\end_inset

 Soit un processus 
\begin_inset Formula $(X_{t})$
\end_inset

 tel que 
\begin_inset Formula $\E(X_{t})=0$
\end_inset

 pour tout 
\begin_inset Formula $t$
\end_inset

.
 Soit une suite de variables aléatoires 
\begin_inset Formula $(\mu_{t})$
\end_inset

 telle que 
\begin_inset Formula $\E[\mu_{t}]=c(t)$
\end_inset

 avec 
\begin_inset Formula $c$
\end_inset

 une fonction non constante.
 Alors 
\begin_inset Formula 
\[
Y_{t}=\mu_{t}+X_{t}
\]

\end_inset

est une série non-stationnaire.
 On peut aller plus loin dans cette “catégorie” de modèles non-stationnaires
 en écrivant l’example sous la forme
\begin_inset Formula 
\begin{equation}
Y_{t}=a+\delta t+\psi(L)e_{t}\label{eq: lin trend}
\end{equation}

\end_inset


\begin_inset Formula $\psi(L)$
\end_inset

 comme dans (
\begin_inset CommandInset ref
LatexCommand ref
reference "psiL"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
 Une partie de la série a une tendance linéaire et l’autre est stationnaire.
 
\end_layout

\begin_layout Exercise
Calculer : l’espérance, la variance et la covariance du processus 
\begin_inset Formula 
\[
Y_{t}=a+\delta t+e_{t}
\]

\end_inset

(les 
\begin_inset Formula $(e_{t})$
\end_inset

 sont i.i.d.
 de moyenne nulle et de variance 
\begin_inset Formula $1$
\end_inset

).
\end_layout

\begin_layout Example
Soit un processus pour lequel le condition de la stationnarité est violé.
 
\begin_inset Formula 
\[
Y_{t}=3Y_{t-1}+e_{t}
\]

\end_inset

En transformant la série en fonction des bruits précédents 
\begin_inset Formula 
\[
Y_{t}=e_{t}+3e_{t-1}+3^{2}e_{t-2}+\cdots+3^{k-1}e_{1}+3^{k}Y_{0}
\]

\end_inset

On remarque que les coefficients ne se tend pas vers zéro.
 
\end_layout

\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Example

\series bold
Marche Aléatoire avec dérive
\series default

\begin_inset CommandInset label
LatexCommand label
name "Marche Aléatoire "

\end_inset

 
\begin_inset Formula 
\begin{equation}
Y_{t}=Y_{t-1}+\delta+e_{t}
\end{equation}

\end_inset

Ici, 
\begin_inset Formula $\delta\in\R$
\end_inset

 est la dérive, si 
\begin_inset Formula $\delta=0$
\end_inset

 on reviens au cas classique d’une marche aléatoire.
 
\end_layout

\begin_layout Exercise
Calculer : l’espérance, la variance et la covariance de la marche aléatoire
 avec dérive.
 Vérifier qu’il s’agit d’un processus non-stationnaire.
 
\end_layout

\begin_layout Standard
Toutes les exemples montrent différents cas de non-stationnarité.
 En général, dans une série non-stationnaire, l’influence des valeurs précédents
 augmente.
 On peut appeler ce comportement un comportement explosif.
\end_layout

\begin_layout Subsection
Les processus ARIMA
\end_layout

\begin_layout Standard
Dans cette section, nous nous occupons des cas où la source de la non-stationnar
ité est la violation des conditions sur le polynôme caractéristique (voir
 Proposition 
\begin_inset CommandInset ref
LatexCommand ref
reference "prop:existence-AR-stationnaire-1"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
 Pour un processus 
\begin_inset Formula $AR(1)$
\end_inset

 il faut que la racine du polynôme soit dans 
\begin_inset Formula $[-1;1]^{\complement}$
\end_inset

.
 On peut écrire l’example 
\begin_inset CommandInset ref
LatexCommand ref
reference "Marche Aléatoire "
plural "false"
caps "false"
noprefix "false"

\end_inset

 en utilisant l’opérateur de décalage du temps (lag) comme 
\begin_inset Formula 
\[
(1-L)Y_{t}=\delta+e_{t}
\]

\end_inset

Ici, il est clair que le polynôme caractéristique a une racine de module
 
\begin_inset Formula $1$
\end_inset

, et donc la condition voulue n'est pas vérifiée.
 Mais si on prend la première différence on voit que 
\begin_inset Formula 
\begin{equation}
\Delta Y_{t}=Y_{t}-Y_{t-1}=\delta+e_{t}
\end{equation}

\end_inset

qui donne une série stationnaire.
 Le même argument s’applique aussi au processus vérifiant 
\begin_inset Formula 
\begin{equation}
(1-L)Y_{t}=\delta+\psi(L)e_{t}\label{eq: genMA unit root}
\end{equation}

\end_inset

et on appelle cette catégorie de processus non-stationnaires, 
\shape italic
processus de racine unitaire
\begin_inset Index idx
status open

\begin_layout Plain Layout
processus de racine unitaire
\end_layout

\end_inset

 (unit root processes) 
\shape default
 et le processus qui sort des differences (
\begin_inset Formula $\Delta Y_{t}$
\end_inset

), un 
\shape italic
processus intégré d’ordre 1
\shape default
, I(1).
\begin_inset Index idx
status open

\begin_layout Plain Layout
processus intégré d'ordre 
\begin_inset Formula $1$
\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Example
ARIMA(1,1) 
\end_layout

\begin_layout Example
\begin_inset Formula 
\begin{equation}
Y_{t}=Y_{t-1}+e_{t}-\theta e_{t-1}\label{eq: IMA}
\end{equation}

\end_inset

(avec des 
\begin_inset Formula $(e_{t})$
\end_inset

 i.i.d.
 centrés, de variance 1).
 Ici, 
\begin_inset Formula $Y_{t}-Y_{t-1}=e_{t}-\theta e_{t-1}$
\end_inset

 (MA(1)) donc nous avons un 
\begin_inset Formula $ARIMA(0,1,1)$
\end_inset


\begin_inset Note Comment
status collapsed

\begin_layout Plain Layout
Pour le rendre stationnaire nous prenons les premières differences 
\begin_inset Formula 
\[
W_{t}=\Delta Y_{t}=e_{t}-\theta e_{t-1}
\]

\end_inset

Maintenant, 
\begin_inset Formula $W_{t}$
\end_inset

 est un processus 
\begin_inset Formula $MA(1)$
\end_inset

 que nous avons déjà étudié
\end_layout

\end_inset

.
 L'équation (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq: IMA"
plural "false"
caps "false"
noprefix "false"

\end_inset

) pourrait être transformé par récurrence en (
\begin_inset Formula $\forall k$
\end_inset

)
\begin_inset Formula 
\begin{equation}
Y_{t}=e_{t}+(1-\theta)e_{t-1}+\cdots+(1-\theta)e_{t-k+1}+Y_{t-k}\label{eq: IMA retro}
\end{equation}

\end_inset


\end_layout

\begin_layout Exercise
Supposons 
\begin_inset Formula $Y_{0}=0$
\end_inset

.
 Avec l’aide de (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq: IMA retro"
plural "false"
caps "false"
noprefix "false"

\end_inset

) montrez que (
\begin_inset Formula $\forall t,h$
\end_inset

)
\end_layout

\begin_deeper
\begin_layout Itemize
\begin_inset Formula $\E[Y_{t}]=0$
\end_inset

 
\end_layout

\begin_layout Itemize
\begin_inset Formula $\var(Y_{t})=[1+(1-\theta)^{2}(t-1)]$
\end_inset

 
\end_layout

\begin_layout Itemize
\begin_inset Formula $\cov(Y_{t},Y_{t-h})=1+(1-\theta)^{2}(t-h-1)$
\end_inset

 
\end_layout

\end_deeper
\begin_layout Example
\begin_inset Formula $ARIMA(1,1,0)$
\end_inset


\end_layout

\begin_layout Example
\begin_inset Formula 
\begin{equation}
Y_{t}=(1+\phi)Y_{t-1}-\phi Y_{t-2}+e_{t}\label{eq: ARI}
\end{equation}

\end_inset

ou 
\begin_inset Formula 
\[
W_{t}=\Delta Y_{t}=\phi W_{t-1}+e_{t}
\]

\end_inset

Maintenant, 
\begin_inset Formula $W_{t}$
\end_inset

 est un processus 
\begin_inset Formula $AR(1)$
\end_inset

 et donc 
\begin_inset Formula $(Y_{t})$
\end_inset

 est un 
\begin_inset Formula $ARIMA(1,1,0)$
\end_inset

.
 Le polynôme caractéristique relié à l'équation (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq: ARI"
plural "false"
caps "false"
noprefix "false"

\end_inset

) 
\begin_inset Formula 
\begin{eqnarray*}
P(X) & = & 1-(1+\phi)X+\phi X^{2}\\
 & = & (1-X)(1-\phi X)\,.
\end{eqnarray*}

\end_inset

est  Si nous voulons calculer l'inverse de ce polynôme, nous arrivons à
 la formule 
\begin_inset Formula 
\[
\frac{1}{(1-z)(1-\phi z)}=1+\psi_{1}z+\psi_{2}z^{2}+\cdots
\]

\end_inset

où
\begin_inset Formula 
\begin{equation}
(1-(1+\phi)z+\phi z^{2})(1+\psi_{1}z+\psi_{2}z^{2}+\cdots)=1\label{eq: inversion ARI}
\end{equation}

\end_inset

pour définir les 
\begin_inset Formula $\psi_{i}$
\end_inset

 nous arrivons au system 
\begin_inset Formula 
\begin{align*}
 & -(1+\phi)+\psi_{1}=0\\
 & \phi-(1+\phi)\psi_{1}+\psi_{2}=0
\end{align*}

\end_inset

et (pour tout 
\begin_inset Formula $k$
\end_inset

)
\begin_inset Formula 
\begin{equation}
\psi_{k}=(1+\phi)\psi_{k-1}-\phi\psi_{k-2},\quad\psi_{0}=1\label{ARI coef}
\end{equation}

\end_inset


\end_layout

\begin_layout Exercise

\series bold
\begin_inset space ~
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
Calculer les coefficients 
\begin_inset Formula $\psi_{k}$
\end_inset

 définis ci-dessus.
 
\end_layout

\begin_layout Itemize
En déduire une expression de 
\begin_inset Formula $Y_{t}$
\end_inset

 en fonction des 
\begin_inset Formula $e_{0},e_{1},\dots,e_{t}$
\end_inset

 (pour tout 
\begin_inset Formula $t$
\end_inset

).
\end_layout

\begin_layout Itemize
Calculer la variance, la covariance et la correlation du processus 
\begin_inset Formula $(Y_{t})$
\end_inset

.
\end_layout

\end_deeper
\begin_layout Section
La méthodologie de Box-Jenkins
\begin_inset Index idx
status open

\begin_layout Plain Layout
Box-Jenkins
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Après l’étude théorique des modèles ARMA et ARIMA, maintenant nous nous
 occupons de questions pratiques.
 
\end_layout

\begin_layout Itemize
Comment modéliser les données comme un processus 
\begin_inset Formula $ARIMA(p,d,q)$
\end_inset

? 
\end_layout

\begin_layout Itemize
Est-ce que la série est stationnaire? 
\end_layout

\begin_layout Itemize
Comment choisir 
\begin_inset Formula $p,d,q$
\end_inset

? 
\end_layout

\begin_layout Standard
Pour répondre à ces questions à la manière pratique et pragmatique, Box
 et Jenkins (
\begin_inset CommandInset citation
LatexCommand cite
key "box-jenkins-1970"
literal "false"

\end_inset

) ont développé une méthodologie en quatre étapes: 
\end_layout

\begin_layout Enumerate
Identification 
\end_layout

\begin_layout Enumerate
Estimation 
\end_layout

\begin_layout Enumerate
Diagnostic 
\end_layout

\begin_layout Enumerate
Prévision 
\end_layout

\begin_layout Subsection
 Identification
\end_layout

\begin_layout Standard
En cet étape on s’occupe de déterminer l’ordre du modèle, et le comportement
 stationnaire (ou non) et saisonnier (ou non).
 Il y a deux approches pour traiter cette partie 
\end_layout

\begin_layout Itemize
L’approche graphique
\begin_inset space ~
\end_inset

: on trace la série, les ACF, PACF .
 Si le graphe de ACF tend vers zéro très lentement ou pas du tout, on soupçonne
 la nonstationnarité.
 Box et Jenkins conseillent de prendre les premières différences et de refaire
 les graphes.
 Si ces graphes indiquent une stationnarité, on s'arrête.
 Sinon, on reprend les différences jusqu’à le graphe ait l’air stationnaire.
\end_layout

\begin_deeper
\begin_layout Standard
Pour déterminer l’ordre du modèle 
\begin_inset Formula $p,q$
\end_inset

 il y a quelque règles empiriques à partir du graphe des ACF.
\end_layout

\begin_layout Enumerate
Décroissance exponentielle vers zéro : Modèle AR (PACF indique l’ordre p)
 
\end_layout

\begin_layout Enumerate
Oscillations amorties décroissants rapidement vers zéro: AR (PACF indique
 l’ordre p) 
\end_layout

\begin_layout Enumerate
Quelques pics le reste nulle (tandis que les PACF tendent vers 
\begin_inset Formula $0$
\end_inset

)
\begin_inset space ~
\end_inset

: MA (l’ordre est le nombre des pics) 
\end_layout

\begin_layout Enumerate
Décroissance exponentielle après quelque pas de temps (lags)
\begin_inset space ~
\end_inset

: probablement un modèle ARMA.
 
\end_layout

\begin_layout Enumerate
Motifs qui se répètent à des écarts de temps réguliers
\begin_inset space ~
\end_inset

: saisonnalité 
\end_layout

\begin_layout Standard
Un remarque générale
\begin_inset space ~
\end_inset

: l'ACF nous aide à déterminer l’ordre du modèle MA, et la PACF l’ordre
 du modèle AR.
 
\end_layout

\end_deeper
\begin_layout Itemize
L'approche statistique.
 Il y a quelques tests statistiques que on peut essayer pour reconnaitre
 la stationnarité ou non de notre modèle, voir la prochaine section.
 Une fois que la question de stationnarité est réglée, on se tourne sur
 la détermination des coefficients AR ou MA par la voie statistique.
 On choisit entre plusieurs modèles en regardant
\begin_inset space ~
\end_inset

: 
\end_layout

\begin_deeper
\begin_layout Itemize
l’ajustement à la série de données, 
\end_layout

\begin_layout Itemize
la complexité du modèle (il est plus facile d’estimer un nombre réduit de
 paramètres).
 
\end_layout

\begin_layout Standard
Pour concilier ces deux critères, on minimise une des deux quantités
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
AIC
\end_layout

\end_inset


\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
BIC
\end_layout

\end_inset

 suivantes 
\begin_inset Formula 
\begin{eqnarray*}
AIC & = & -2\log(L(\theta))+2\nu\,,\\
BIC & = & -2\log(L(\theta))+n\log(\nu)\,,
\end{eqnarray*}

\end_inset

où 
\begin_inset Formula $\nu$
\end_inset

 est le nombre de paramètres (
\begin_inset Formula $n=p+q$
\end_inset

 si'l s'agit d'un ARMA sans constant ou 
\begin_inset Formula $n=p+q+1$
\end_inset

), 
\begin_inset Formula $\theta$
\end_inset

 est un vecteur contenant les paramètres, 
\begin_inset Formula $n$
\end_inset

 est le nombre d’observations, 
\begin_inset Formula $L$
\end_inset

 est la vraisemblance (dans laquelle on a omis les observations).
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Note Comment
status open

\begin_layout Plain Layout
AIC (Akaike's Information Criterion) est un estimateur d'espérance de la
 divergence de Kullback-Leibler entre le modèle estimé et le vrai modèle.
 Soit 
\begin_inset Formula $p(y_{1},...,y_{n})$
\end_inset

 la vrai densité de probabilité de 
\begin_inset Formula $Y_{1},...,Y_{n}$
\end_inset

 et soit 
\begin_inset Formula $q_{\theta}(y_{1},...,y_{n})$
\end_inset

 la densité sous le modèle de paramètre 
\begin_inset Formula $\theta$
\end_inset

 la divergence Kullback-Leibler de 
\begin_inset Formula $q_{\theta}$
\end_inset

 à 
\begin_inset Formula $p$
\end_inset

 est donner par la formule suivante 
\begin_inset Formula 
\[
D(p,q_{\theta})=\int_{-\infty}^{\infty}\int_{-\infty}^{\infty}....\int_{-\infty}^{\infty}p(y_{1},...,y_{n})\log\biggl(\frac{p(y_{1},...,y_{n})}{q_{\theta}(y_{1},...,y_{n})}\biggr)dy_{1}...dy_{n}
\]

\end_inset

On veut estimer l'espérance 
\begin_inset Formula $\E[D(p,q_{\hat{\theta}})]$
\end_inset

 ou 
\begin_inset Formula $\hat{\theta}$
\end_inset

 est l'estimateur du vecteur des paramètres, qui sort la formule du debut.
\end_layout

\end_inset


\end_layout

\begin_layout Example
Le calcul des quantités 
\begin_inset Formula $AIC$
\end_inset

 et 
\begin_inset Formula $BIC$
\end_inset

 se fait facilement en 
\family typewriter
R
\family default
.
 Calculons une vraisemblance dans un cas simple.
\end_layout

\begin_layout Example
On suppose 
\begin_inset Formula $X_{t}=at+b+\epsilon_{t}$
\end_inset

 avec des 
\begin_inset Formula $\epsilon_{t}$
\end_inset

 i.i.d.
 de loi 
\begin_inset Formula $\mathcal{N}(0;1)$
\end_inset

.
 Les paramètres du modèle sont 
\begin_inset Formula $a$
\end_inset

 et 
\begin_inset Formula $b$
\end_inset

.
 On dispose d’observations 
\begin_inset Formula $x_{1},\dots,x_{n}$
\end_inset

.
 La densité de 
\begin_inset Formula $(X_{1},\dots,X_{n})$
\end_inset

 est la fonction 
\begin_inset Formula 
\[
(u_{1},\dots,u_{n})\mapsto\prod_{t=1}^{n}\left\{ \frac{1}{\sqrt{2\pi}}\exp\left(-\frac{1}{2}(u_{t}-at-b)^{2}\right)\right\} \,.
\]

\end_inset

La vraisemblance est donc 
\begin_inset Formula 
\[
(a’,b’)\mapsto L(a’,b’)=L((a’,b’);(x_{1},\dots,x_{n}))=\prod_{t=1}^{n}\left\{ \frac{1}{\sqrt{2\pi}}\exp\left(-\frac{1}{2}(x_{t}-a’t-b’)^{2}\right)\right\} \,.
\]

\end_inset

Si on veur estimer 
\begin_inset Formula $(a,b)$
\end_inset

 à partir de 
\begin_inset Formula $(x_{1},\dots,x_{n})$
\end_inset

, l’estimateur du maximum de vraisemblance
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
Maximum de vraisemblance
\end_layout

\end_inset

 est 
\begin_inset Formula 
\[
(\widehat{a},\widehat{b})=\argmax_{a’,b’}L(a’,b’)\,.
\]

\end_inset


\end_layout

\begin_layout Subsection
Estimation du modèle sur un exemple
\end_layout

\begin_layout Standard
On suppose que 
\begin_inset Formula $X_{t}=a_{1}X_{t-1}+a_{2}X_{t-1}+\epsilon_{t}$
\end_inset

 (avec des 
\begin_inset Formula $\epsilon_{t}$
\end_inset

 bruits blancs centrés, de variance 
\begin_inset Formula $\sigma^{2}$
\end_inset

) et que 
\begin_inset Formula $(X_{t})$
\end_inset

 est stationnaire.
 On calcule les auto-covariances
\begin_inset space ~
\end_inset

: 
\begin_inset Formula 
\[
\sigma(1)=\frac{a_{1}}{1-a_{2}}\sigma(0)\,,\,\sigma(2)=a_{1}\sigma(1)+a_{2}\sigma(0)\,.
\]

\end_inset

D’où 
\begin_inset Formula 
\begin{eqnarray*}
a_{1} & = & \frac{\sigma(1)}{\sigma(0)}\times\frac{\sigma(0)^{2}-\sigma(0)\sigma(1)}{\sigma(0)^{2}-\sigma(1)^{2}}\,,\\
a_{2} & = & \frac{\sigma(0)\sigma(2)-\sigma(1)^{2}}{\sigma(0)^{2}-\sigma(1)^{2}}\,.
\end{eqnarray*}

\end_inset

On peut donc estimer 
\begin_inset Formula $a_{1}$
\end_inset

, 
\begin_inset Formula $a_{2}$
\end_inset

 en remplaçant 
\begin_inset Formula $\sigma(0)$
\end_inset

, 
\begin_inset Formula $\sigma(1)$
\end_inset

, 
\begin_inset Formula $\sigma(2)$
\end_inset

 par leurs estimateurs empiriques dans les formules ci-dessus.
 Puisque 
\begin_inset Formula $\sigma(0)=\sigma^{2}+a_{1}\sigma(1)+a_{2}\sigma(2)$
\end_inset

, on peut aussi estimer 
\begin_inset Formula $\sigma^{2}$
\end_inset

.
\end_layout

\begin_layout Standard
Dans le cas général, on estimer par maximum de vraisemblance (voir cours
 de statistiques et l’exemple ci-dessus).
\end_layout

\begin_layout Standard
\begin_inset Note Comment
status collapsed

\begin_layout Plain Layout
Diagnostic du modèle
\end_layout

\begin_layout Plain Layout
.
 Ici, nous nous intéressons principalement au comportement des résidus du
 modèle.
 Quels sont le propriétés statistiques des résidus? Hypothèse de normalité,
 bruit blanc etc.
 Box-Pierce ou Ljung-Box sont les utiles principales ici.
 Deux remarques importants 
\end_layout

\begin_layout Enumerate
En testant la correlation des résidus, il n’est possible que de dévoiler
 un modèle sousparametrisé.
 Il y a rien à dire pour un modèle surparametrisé.
 
\end_layout

\begin_layout Enumerate
Autocorrelation des résidus est possible de faire les autres test statistiques
 donner les faux résultats.
 
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Diagnostic (sur l'exemple ci-dessus)
\end_layout

\begin_layout Standard
Si le modèle est correct, la série 
\begin_inset Formula $(x_{1}-a-b,x_{2}-2a-b,\dots,x_{n}-na-b)$
\end_inset

 doit être constituée de bruits blancs.
 Ceci peut se tester à l'aide des tests exposés dans la partie 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Test-sur-la-serie-residuelle"

\end_inset

.
\end_layout

\begin_layout Subsection
Prévision 
\end_layout

\begin_layout Standard
Si le modèle est un processus 
\begin_inset Formula $ARMA$
\end_inset

, la prédiction pour 
\begin_inset Formula $X_{n+h}$
\end_inset

, sachant 
\begin_inset Formula $X_{1},\dots,X_{n}$
\end_inset

 est 
\begin_inset Formula 
\[
\widehat{X}_{n,h}=c_{1}X_{1}+\dots+c_{n}X_{n}\,,
\]

\end_inset

où les coefficients sont choisis de manière à minimiser l’erreur quadratique
 
\begin_inset Formula 
\[
\E((X_{n+h}-c_{1}X_{1}-\dots-c_{n}X_{n})^{2})\,.
\]

\end_inset


\end_layout

\begin_layout Proposition
Ce choix de 
\begin_inset Formula $\widehat{X}_{n,h}$
\end_inset

 entraîne l’égalité 
\begin_inset Formula 
\[
\widehat{X}_{n,h}=\E(X_{n+h}|X_{1},\dots,X_{n})\,.
\]

\end_inset


\end_layout

\begin_layout Standard
Ce qui n’est pas surprenant si on se rappelle que l’espérance conditionnelle
 de 
\begin_inset Formula $X_{n+h}$
\end_inset

 sachant 
\begin_inset Formula $X_{1},\dots,X_{n}$
\end_inset

 est la projection orthogonale de 
\begin_inset Formula $X_{n+h}$
\end_inset

 sur 
\begin_inset Formula $\sigma(X_{1},\dots,X_{n})$
\end_inset

 dans l’espace des variables 
\begin_inset Formula $L^{2}$
\end_inset

 (muni de la norme 
\begin_inset Formula $L^{2}$
\end_inset

).
\end_layout

\begin_layout Proposition
L’erreur de prévision à l’horizon 
\begin_inset Formula $1$
\end_inset

 (
\begin_inset Formula $X_{n+1}-\widehat{X}_{n,1}$
\end_inset

) est le bruit d’innovation 
\begin_inset Formula $\epsilon_{n+1}$
\end_inset

.
\begin_inset Newline newline
\end_inset

 La variance de l’erreur de prévision (
\begin_inset Formula $\E((X_{n+h}-\widehat{X}_{n,h})^{2})$
\end_inset

) est croissante avec 
\begin_inset Formula $h$
\end_inset

 et tend vers 
\begin_inset Formula $\var(X_{1})$
\end_inset

 quand 
\begin_inset Formula $h\rightarrow+\infty$
\end_inset

 (on rappelle que le procesus 
\begin_inset Formula $(X_{t})$
\end_inset

 est supposé stationnaire).
 
\end_layout

\begin_layout Standard
Puisque les 
\begin_inset Formula $\epsilon_{t}$
\end_inset

 sont gaussiens, les 
\begin_inset Formula $X_{t}$
\end_inset

, 
\begin_inset Formula $\widehat{X}_{n,h}$
\end_inset

 et 
\begin_inset Formula $\widehat{X}_{n,h}-X_{n+h}$
\end_inset

 sont aussi gaussiens (nous sautons une petite démonstration).
 Ceci permet de construire facilement des intervalles de confiance
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
Intervalle de confiance
\end_layout

\end_inset

 (c’est inclus dans 
\family typewriter
R
\family default
).
 Nous faisons ici un rappel dans un cas simple.
 Supposons 
\begin_inset Formula $\widehat{X}_{n,h}-X_{n+h}\sim\mathcal{N}(0;\sigma^{2})$
\end_inset

.
 Soit 
\begin_inset Formula $\alpha=0,01$
\end_inset

.
 Nous cherchons 
\begin_inset Formula $\Delta$
\end_inset

 tel que 
\begin_inset Formula 
\[
\p(X_{n+h}\in[\widehat{X}_{n,h}-\Delta;\widehat{X}_{n,h}+\Delta])\geq1-\alpha
\]

\end_inset

(ici, toutes les probabilités sont conditionnelles à 
\begin_inset Formula $X_{1},\dots,X_{n}$
\end_inset

).
 Nous calculons 
\begin_inset Formula 
\begin{eqnarray*}
\p(X_{n+h}\in[\widehat{X}_{n,h}-\Delta;\widehat{X}_{n,h}+\Delta]) & = & \p(|X_{n+h}-\widehat{X}_{n,h}|\leq\Delta)\\
 & = & \p\left(\frac{|X_{n+h}-\widehat{X}_{n,h}|}{\sigma}\leq\frac{\Delta}{\sigma}\right)\\
\mbox{(en utilisant les symétries de la gaussienne)} & = & 1-2\p\left(\frac{X_{n+h}-\widehat{X}_{n,h}}{\sigma}\geq\frac{\Delta}{\sigma}\right)\,.
\end{eqnarray*}

\end_inset

Nous voulons donc 
\begin_inset Formula $\Delta$
\end_inset

 tel que 
\begin_inset Formula 
\[
\p\left(\frac{X_{n+h}-\widehat{X}_{n,h}}{\sigma}\geq\frac{\Delta}{\sigma}\right)\leq\frac{\alpha}{2}=0,005\,.
\]

\end_inset

Puisque 
\begin_inset Formula $(X_{n,h}-\widehat{X}_{n,h})/\sigma$
\end_inset

 est de loi 
\begin_inset Formula $\mathcal{N}(0;1)$
\end_inset

, on lit dans une table de la loi normale qu’il suffit de prendre 
\begin_inset Formula $\Delta/\sigma=2,58$
\end_inset

 pour que l’inégalité ci-dessus soit vérifiée.
\end_layout

\begin_layout Remark
De manière générale, pour les processus ARMA, ARIMA, SARIMA, une fois que
 le modèle est spécifié, 
\family typewriter
R 
\family default
peut estimer des coefficients et la variance des bruits.
 Par exemple, si On a un modèle AR(1) de la forme 
\begin_inset Formula $X_{t}=aX_{t-1}+\epsilon_{t}$
\end_inset

, nous pouvons estimer 
\begin_inset Formula $a$
\end_inset

 (notons 
\begin_inset Formula $\widehat{a}$
\end_inset

 son estimée) et 
\begin_inset Formula $\var(\epsilon_{t})$
\end_inset

.
 La valeur au cran 
\begin_inset Formula $h$
\end_inset

 sera
\begin_inset Formula 
\[
\widehat{X}_{t,h}=\widehat{a}^{h}x_{t}+a^{h-1}\epsilon_{t-1}+\dots+\epsilon_{t+h}
\]

\end_inset

et 
\family typewriter
R
\family default
 nous donne la prédiction moyenne (
\begin_inset Formula $\widehat{a}^{h}x_{t}$
\end_inset

) et l'écart-type estimé de 
\begin_inset Formula $\widehat{a}^{h-1}\epsilon_{t-1}+\dots+\epsilon_{t+h}$
\end_inset

 (notons-le 
\begin_inset Formula $\widehat{\sigma}$
\end_inset

).
 Si nous sommes intéressés par un intervalle de confiance à 95%, nous dirons
 que
\begin_inset Formula 
\[
X_{t+h}\in[\widehat{a}^{h}x_{t}+1,96\times\widehat{\sigma};\widehat{a}^{h}x_{t}-1,96\times\widehat{\sigma}]
\]

\end_inset

avec probabilité 
\begin_inset Formula $\geq1,95$
\end_inset

.
 Ceci n'est, bien sûr, pas totalement correct car 
\begin_inset Formula $\widehat{a}$
\end_inset

 et 
\begin_inset Formula $\widehat{\sigma}$
\end_inset

 sont eux-mêmes des estimées.
 Néammoins, c'est ainsi que l'on procède en pratique.
  
\end_layout

\begin_layout Subsection
Test 
\emph on
de 
\begin_inset Index idx
status open

\begin_layout Plain Layout

\emph on
Dickey-Fuller 
\end_layout

\end_inset


\emph default
Dickey-Fuller et test de
\emph on
 
\begin_inset Index idx
status open

\begin_layout Plain Layout
test de Dickey-Fuller augmenté
\end_layout

\end_inset


\emph default
Dickey-Fuller augmenté
\end_layout

\begin_layout Standard
Ces test nous permettent de savoir quand arrêter de faire des différences
 quand nous cherchons à identifier un ARIMA ou un SARIMA.
 
\end_layout

\begin_layout Standard
Comme nous avons vu, si le polynôme d’une série contient une racine unitaire,
 la série n’est pas stationnaire.
 Dès premières étapes de la méthodologie Box-Jenkins on peut soupçonner
 la non-stationnarité par les graphes mais notre but ici, c’est de développer
 des tests statistiques pour tester rigoureusement les séries.
 Souvent il y a deux cas de non-stationnarité et ce n'est pas toujours facile
 de les distinguer
\begin_inset space ~
\end_inset

: 
\emph on
processus stationnaire de tendance
\begin_inset Index idx
status open

\begin_layout Plain Layout
Processus stationnaire de tendance
\end_layout

\end_inset


\emph default
 (c’est-à-dire que la série n’est pas stationnaire mais elle est stationnaire
 autour d'une tendance déterministe) et 
\begin_inset Index idx
status open

\begin_layout Plain Layout
processus stationnaire en différence
\end_layout

\end_inset


\emph on
processus stationnaire en différence
\emph default
 (c'est à dire que l'on obtient un processus stationnaire en appliquant
 l'opérateur des différences un certain nombre de fois).
 Les tests qui suivent sont développés pour la deuxième catégorie.
 
\end_layout

\begin_layout Standard
Supposons que nous avons un processus 
\begin_inset Formula $(Y_{t})$
\end_inset

 vérifiant
\begin_inset Formula 
\begin{equation}
Y_{t}=aY_{t-1}+e_{t}
\end{equation}

\end_inset

Nous voulons tester l'hypothèse (
\begin_inset Formula $H_{0}$
\end_inset

) contre l'hypothèse (
\begin_inset Formula $H_{1}$
\end_inset

)
\begin_inset space ~
\end_inset

:
\begin_inset Formula 
\begin{align*}
 & H_{0}:a=1\\
 & H_{1}:a<1
\end{align*}

\end_inset

sous l’hypothèse 
\begin_inset Formula $H_{0}$
\end_inset

 nous avons un marche aléatoire.
 DF-test est le t-test de 
\begin_inset Formula $H_{0}$
\end_inset

 et on construit la statistique suivante à partir des données 
\begin_inset Formula $y_{0},y_{1},\dots,y_{n}$
\end_inset


\begin_inset space ~
\end_inset

:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\widehat{a}_{n}=\frac{\sum_{t=1}^{n}y_{t-1}y_{t}}{\sum_{t=1}^{n}y_{t-1}^{2}}\,
\]

\end_inset


\end_layout

\begin_layout Theorem

\series bold
(Test de Dickey-Fuller=test DF)
\series default
 
\begin_inset CommandInset label
LatexCommand label
name "thm:dickey-fuller-01"

\end_inset

Si les 
\begin_inset Formula $(e_{t})$
\end_inset

 forment un bruit blanc alors 
\begin_inset Formula $n(\widehat{a}_{T}-1)$
\end_inset

 converge en loi (quand 
\begin_inset Formula $n\rightarrow+\infty$
\end_inset

) vers une distribution appelée 
\begin_inset Quotes cld
\end_inset


\begin_inset Index idx
status open

\begin_layout Plain Layout
table de Dickey-Fuller
\end_layout

\end_inset

table de Dickey-Fuller
\begin_inset Quotes crd
\end_inset

, dont on pourra trouver une table dans le 
\begin_inset Quotes cld
\end_inset

case 1
\begin_inset Quotes crd
\end_inset

 de la figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Table-de-Dickey-Fuller"
plural "false"
caps "false"
noprefix "false"

\end_inset

 (tirée de 
\begin_inset CommandInset citation
LatexCommand cite
key "hamilton"
literal "false"

\end_inset

, p.763).
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement h
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/table-DF-01.png
	scale 50

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Table de Dickey-Fuller
\begin_inset CommandInset label
LatexCommand label
name "fig:Table-de-Dickey-Fuller"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
Nous supposons maintenant que nous avons un processus de la forme 
\begin_inset Formula 
\begin{equation}
\begin{split}Y_{t}=\mu+\delta t+\phi_{1}Y_{t-1}+\phi_{2}Y_{t-2}+\cdots+\phi_{k}Y_{t-k}+e_{t}\end{split}
\end{equation}

\end_inset

Nous voulons tester l'hypothèse (
\begin_inset Formula $H_{0}$
\end_inset

) contre l'hypothèse (
\begin_inset Formula $H_{1}$
\end_inset

)
\begin_inset space ~
\end_inset

:
\begin_inset Formula 
\begin{align*}
 & H_{0}:\phi_{1}=1\\
 & H_{1}:\phi_{1}<1
\end{align*}

\end_inset

Sous 
\begin_inset Formula $H_{0}$
\end_inset

 , 
\begin_inset Formula $\Delta Y_{t}$
\end_inset

 est un processus stationnaire 
\begin_inset Formula $AR(k)$
\end_inset

 
\begin_inset Formula 
\[
\Delta Y_{t}=\phi_{0}^{*}+\phi_{1}^{*}\Delta Y_{t-1}+\dots+\phi_{p}^{*}\Delta Y_{t-k+1}+e_{t}
\]

\end_inset

avec
\begin_inset Formula 
\[
\phi_{j}^{*}=-\sum_{i=j}^{k}\phi_{i}\,(j=2,\dots,k)\,,\,\phi_{1}^{*}=\sum_{i=1}^{k}\phi_{i}-1\,,
\]

\end_inset


\begin_inset Formula 
\[
\phi_{0}^{*}=\mu(1-\phi_{1}-\dots-\phi_{k})\,.
\]

\end_inset

Encore une fois, on peut construire une statistique qui a une distribution
 asymptotique remarquable (donnée cette fois par le 
\begin_inset Quotes cld
\end_inset

case 4
\begin_inset Quotes crd
\end_inset

 de la figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Table-de-Dickey-Fuller"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
 Ce qui donne naissance au test de Dickey-Fuller 
\emph on
augmenté.
\end_layout

\begin_layout Remark
On parle de test augmenté parce qu'on a rajouté la constante 
\begin_inset Formula $\mu$
\end_inset

 et la dérive 
\begin_inset Formula $\delta$
\end_inset

 dans le modèle.
 
\end_layout

\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Remark
\begin_inset space ~
\end_inset


\end_layout

\begin_deeper
\begin_layout Enumerate
C’est le modèle avec dérive et constant que 
\family typewriter
R
\family default
 utilise comme modèle par défaut quand on appelle la commande 
\family typewriter
adf.test()
\family default
 dans la librairie 
\family typewriter
tseries
\family default
.
 
\end_layout

\begin_layout Enumerate
Le paramètre 
\begin_inset Formula $k$
\end_inset

 dans 
\family typewriter
R 
\family default
est précisément l’ordre du modèle AR pour 
\begin_inset Formula $X_{t}$
\end_inset

.
\end_layout

\begin_layout Enumerate
Si on met 
\begin_inset Formula $k=0$
\end_inset

 dans 
\family typewriter
R, 
\family default
la machine utilisera le test DF.
\end_layout

\begin_layout Enumerate
La distribution de la statistique remarquable change à chaque modèle change
 (voir 
\begin_inset CommandInset citation
LatexCommand cite
key "hamilton"
literal "false"

\end_inset

 p.502 et p.528-529 )
\end_layout

\end_deeper
\begin_layout Standard
Il y a encore les tests Philips-Perron et KPSS qui pourront être utilisés
 en complement de ADF pour vérifier la stationnarité ou non d’une série.
\end_layout

\begin_layout Example

\series bold
Un bruit blanc
\end_layout

\begin_layout Example
On fait la simulation de 1000 bruit blanc comme représenté dans la figure
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Bruit-Blanc"
plural "false"
caps "false"
noprefix "false"

\end_inset

 en rentrant le code
\begin_inset space ~
\end_inset

:
\end_layout

\begin_layout Example

\family typewriter
TT <- 100 
\end_layout

\begin_layout Example

\family typewriter
wn <- rnorm(TT) 
\end_layout

\begin_layout Example
\begin_inset Float figure
placement h
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename fig-thanos-final/White.jpeg
	width 40line%

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
Bruit Blanc
\begin_inset CommandInset label
LatexCommand label
name "fig:Bruit-Blanc"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Example
Pour tester notre série pour une racine unitaire on écrit dans 
\family typewriter
R
\begin_inset space ~
\end_inset


\family default
:
\end_layout

\begin_layout Example

\family typewriter
adf.test(wn)
\end_layout

\begin_layout Example
ce qui nous donne
\end_layout

\begin_layout Example

\family typewriter
Dickey-Fuller = -4.8309, Lag order = 4, p-value = 0.01 
\end_layout

\begin_layout Example

\family typewriter
alternative hypothesis: stationary
\end_layout

\begin_layout Example

\family typewriter
Warning message: In adf.test(wn) : p-value smaller than printed p-value
\end_layout

\begin_layout Example
Nous avons 
\series bold
p-value <0.01
\series default
, alors on rejette l'hypothèse zéro de non-stationnarité.
 La quantité 
\begin_inset Quotes cld
\end_inset

lag order
\begin_inset Quotes crd
\end_inset

 est le paramètre de l'AR choisi par 
\family typewriter
R
\family default
.
\end_layout

\begin_layout Example
Par contre pour une série conduite par un bruit blanc qui est donnée par
 la commande 
\family typewriter
R
\begin_inset space ~
\end_inset


\family default
:
\end_layout

\begin_layout Example

\family typewriter
wnt<-wn 
\end_layout

\begin_layout Example

\family typewriter
for ( i in 4:TT) 
\end_layout

\begin_layout Example

\family typewriter
{ 
\end_layout

\begin_layout Example

\family typewriter
\begin_inset space ~
\end_inset


\begin_inset space ~
\end_inset

wnt[i]=wnt[i-1]/4+2*wnt[i-2]/4+wnt[i-3]/4+wn[i] 
\end_layout

\begin_layout Example

\family typewriter
} 
\end_layout

\begin_layout Example

\family typewriter
plot(wnt
\family default
)
\end_layout

\begin_layout Example
(voir le résultat dans la figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Un-processus-non"
plural "false"
caps "false"
noprefix "false"

\end_inset

)
\end_layout

\begin_layout Example
\begin_inset Float figure
placement h
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/non-stationnaire-01.png
	width 40line%

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
Un processus non stationnaire
\begin_inset CommandInset label
LatexCommand label
name "fig:Un-processus-non"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Example
Le test ADF donne 
\series bold
p-value =0.489
\series default
 donc on ne peut pas rejeter (
\begin_inset Formula $H_{0}$
\end_inset

).
\end_layout

\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Example
(Deere)	 Le fichier de données nommé « deere3 » contient 57 mesures consécutives
 enregistrées à partir d'une machine-outil complexe chez Deere & Co.
 Les valeurs données sont des écarts par rapport à une valeur cible en unités
 de dix millionièmes de pouce.
 Le processus utilise un mécanisme de contrôle qui réinitialise certains
 des paramètres de la machine-outil en fonction de l'ampleur de l'écart
 par rapport à la cible du dernier article produit.
 Pour étudier cette série nous suivons les pas de la méthodologie Box-Jenkins.
 
\end_layout

\begin_deeper
\begin_layout Enumerate

\series bold
Stationnarité
\series default
 On regarde le graphe de la série et aussi les fonctions ACF et PACF (figure
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:deere3"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
 Graphiquement, la série a l'air stationnaire, les autocorrélations tendent
 vers zéro rapidement et seulement le premier lag des autocorrélations partielle
s est important (ce qui indique un modèle AR1).
 Pour le vérifier on utilise encore le test ADF qui nous donne 
\begin_inset Formula $\textbf{p-value}<0.01$
\end_inset

.
 Nous concluons que la série est stationnaire.
 
\begin_inset Float figure
placement h
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename fig-thanos-final/deere3_plot.jpeg
	width 40line%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Graphics
	filename fig-thanos-final/acf_deere3.jpeg
	width 40line%

\end_inset

 
\begin_inset Graphics
	filename fig-thanos-final/pacf_deere3.jpeg
	width 40line%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
deere3
\begin_inset CommandInset label
LatexCommand label
name "fig:deere3"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Enumerate

\series bold
Déterminer l'ordre AR et ou MA
\series default
.
 Pour choisir le modèle ARMA, on voit les ACF, PACF et on teste progressivement
 de AR1, jusqu'à AR4 et les combinaisons avec MA1, ..
 pour trouver que celui qui maximise le critère AIC, c'est ARMA(2,1)
\end_layout

\end_deeper
\begin_layout Example
Pour résumer cette analyse, la série initial deere3 pourrait être décrit
 comme un modèle ARMA(2,1) 
\end_layout

\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Example
(Wages) Le fichier de données nommé "wages" contient les valeurs mensuelles
 de la moyenne du salaire horaire pour les travailleurs aux États-Unis dans
 l'industrie textile de juillet 1981 jusqu'à juin 1987.
\end_layout

\begin_layout Example
On commence par un graphe de la série (figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Wages"
plural "false"
caps "false"
noprefix "false"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
placement h
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename fig-thanos-final/wages_plot.jpeg
	width 40line%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Wages
\begin_inset CommandInset label
LatexCommand label
name "fig:Wages"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
À la vue du graphe, on peut soupçonner une tendance linéaire avec le temps,
 on essaie de l'enlever en faisant une régression linéaire et on affiche
 les résidus de la régression (figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Résidus"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement h
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename fig-thanos-final/reg_resids.jpeg
	width 40line%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Résidus
\begin_inset CommandInset label
LatexCommand label
name "fig:Résidus"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Les résidus semblent un peu pathologiques et on affiche aussi le ACF pour
 avoir plus d'informations (figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:ACF-residus"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename fig-thanos-final/acf_reg_resids.jpeg
	width 40line%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
ACF des résidus
\begin_inset CommandInset label
LatexCommand label
name "fig:ACF-residus"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
On soupçonne une non-stationnarité et on prend le premières différence pour
 rendre les résidus stationnaires (voir figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Différences-des-résidus"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement h
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename fig-thanos-final/diff_reg_resids.jpeg
	width 40line%

\end_inset

 
\begin_inset Graphics
	filename fig-thanos-final/acf_diff_reg_resids.jpeg
	width 40line%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Différences des résidus et ACF des différences
\begin_inset CommandInset label
LatexCommand label
name "fig:Différences-des-résidus"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Maintenant ils ont l'air stationnaire.
 On peut verifier les résultats par la voie statistique en faisant à chaque
 étape un test Box-Pierce sur les résidus.
 Pour le premier après la régression on rejet l'hypothèse zéro d'être bruit
 blanc et on peut verifier l'existence de non stationnarité par un test
 ADF avant prendre les premières différences.
\end_layout

\begin_layout Standard
On voit sur le dernier plot de la série stationnaire un seul lag statistiquement
 significative et alors on decide de commencer avec un model AR(1)
\end_layout

\begin_layout Standard
Pour résumer cette analyse, la série initial wage pourrait être modélisée
 comme un processus ARIMA(1,1,0) avec tendance linéaire.
\end_layout

\begin_layout Description
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

 Codes 
\end_layout

\end_inset

 Pour ce code on a besoin de la librairie 
\series bold
tseries
\series default
.
\end_layout

\begin_deeper
\begin_layout Verbatim
data = read.csv("deere3.csv", col.names ='x' )
\end_layout

\begin_layout Verbatim

\end_layout

\begin_layout Verbatim
deere3= ts(data)
\end_layout

\begin_layout Verbatim
plot(deere3)
\end_layout

\begin_layout Verbatim
acf(deere3)
\end_layout

\begin_layout Verbatim
pacf(deere3)
\end_layout

\begin_layout Verbatim
library(tseries)
\end_layout

\begin_layout Verbatim
adf.test(deere3)
\end_layout

\begin_layout Verbatim
outAR1 = arima(deere3, order = c(1,0,0)) 
\end_layout

\begin_layout Verbatim
outAR2 = arima(deere3, order = c(2,0,0))
\end_layout

\begin_layout Verbatim
outAR3 = arima(deere3, order = c(3,0,0))
\end_layout

\begin_layout Verbatim
outAR4 = arima(deere3, order = c(4,0,0))
\end_layout

\begin_layout Verbatim
outARMA21 = arima(deere3, order = c(2,0,1))
\end_layout

\begin_layout Verbatim
Box.test(outAR1$resid,lag=1)
\end_layout

\begin_layout Verbatim
Box.test(outAR2$resid,lag=2)
\end_layout

\begin_layout Verbatim
Box.test(outAR3$resid,lag=3)
\end_layout

\begin_layout Verbatim
Box.test(outAR4$resid,lag=4)
\end_layout

\begin_layout Verbatim
prediction = predict(outAR1, n.ahead=5)
\end_layout

\begin_layout Verbatim
plot(deere3)
\end_layout

\begin_layout Verbatim
points( prediction$pred, type = "l", col = 2 )
\end_layout

\begin_layout Verbatim

\end_layout

\end_deeper
\begin_layout Subsection
Exercices supplémentaires 
\end_layout

\begin_layout Enumerate
Calculer la variance de la série: 
\begin_inset Formula 
\[
Y_{t}=e_{t}+\psi e_{t-1}+\psi^{2}e_{t-2}+...
\]

\end_inset


\begin_inset Newline newline
\end_inset


\bar under
Réponse
\begin_inset space ~
\end_inset

:
\bar default

\begin_inset Formula 
\begin{align*}
\var(Y_{t}) & =\var(\sum_{i=0}^{\infty}\psi^{i}e_{t-i})\\
 & =\sum_{i=0}^{\infty}\var(\psi^{i}e_{t-i})+\sum_{\substack{j=0\\
j\neq i
}
}^{\infty}\cov(\psi^{i}e_{t-i},\psi^{j}e_{t-j})\\
 & =\sum_{i=0}^{\infty}\psi^{2i}\var(e_{t-i})=\sigma_{e}\frac{1}{1-\psi^{2}}
\end{align*}

\end_inset

l'équation finale viens de la série géométrique de 
\begin_inset Formula $\psi^{2}$
\end_inset

 
\end_layout

\begin_layout Enumerate
Calculer la variance de la série 
\begin_inset Formula 
\[
Y_{t}=e_{t}+\psi e_{t-1}+\psi^{2}e_{t-2}+...+\psi^{k}e_{t-k}
\]

\end_inset


\begin_inset Newline newline
\end_inset


\bar under
Réponse
\begin_inset space ~
\end_inset

:
\bar default

\begin_inset Formula 
\[
\var(Y_{t})=\sigma_{e}\sum_{i=0}^{k}\psi^{2i}=\sigma_{e}\frac{1-\psi^{2(k+1)}}{1-\psi^{2}}
\]

\end_inset

Pour arriver à cette dernier équation, il faut écrire 
\begin_inset Formula 
\[
\sum_{i=0}^{k}\psi^{2i}=\sum_{i=0}^{\infty}\psi^{2i}-\sum_{i=k+1}^{\infty}\psi^{2i}=\frac{1}{1-\psi^{2}}-\psi^{2(k+1)}\sum_{n=0}^{\infty}\psi^{2n}
\]

\end_inset


\end_layout

\begin_layout Enumerate
Pour le modèle suivant, calculer l' espérance, la variance, la covariance
 et la correlation.
 
\begin_inset Formula 
\begin{equation}
Y_{t}=-Y_{t-1}+2Y_{t-2}+e_{t}\label{ex: ARIMA}
\end{equation}

\end_inset

On fait l'hypothèse que 
\begin_inset Formula $e_{t}$
\end_inset

 est un bruit blanc centré de variance 
\begin_inset Formula $\sigma_{e}$
\end_inset

.
\begin_inset Newline newline
\end_inset


\bar under
Réponse
\begin_inset space ~
\end_inset

:
\bar default
 On va récrire le modèle à la forme des lags pour définir le polynôme characteri
stic: 
\begin_inset Formula 
\[
Y_{t}=-Y_{t-1}+2Y_{t-2}+e_{t}
\]

\end_inset


\begin_inset Formula 
\[
(-2L^{2}+L+1)Y_{t}=e_{t}
\]

\end_inset

qui a les racines 
\begin_inset Formula $r_{1}=1,\quad r_{2}=-\frac{1}{2}$
\end_inset

.
 Il est clair que nous avons une racine unitaire et alors il s'agit d'un
 modèle genre ARI(1,1,0).
 
\begin_inset Formula 
\[
\frac{1}{(1-z)(1+2z)}=\psi_{1}z+\psi_{2}z^{2}+...
\]

\end_inset

En utilisant l'equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "ARI coef"
plural "false"
caps "false"
noprefix "false"

\end_inset

 on peut récrire l'equation précédant comme 
\begin_inset Formula 
\begin{align*}
 & \psi_{k}=3\psi_{k-1}-2\psi_{k-2}\quad\psi_{0}=1\\
ou\quad & \psi_{k}=\frac{1-\phi^{k+1}}{1-\phi}
\end{align*}

\end_inset

Par qui on peut calculer facilement l'espérance 
\begin_inset Formula 
\[
\E[Y_{t}]=0
\]

\end_inset

et la variance 
\begin_inset Formula 
\[
Var(Y_{t})=\sigma_{e}\big[1+2^{2}+...+(\frac{1-2^{t-k}}{-1})^{2}\big]
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
Corrigé de la feuille d'exercices numéro 5 (code 
\family typewriter
R
\family default
 + commentaires)
\end_layout

\begin_layout Plain Layout

\family typewriter
#1 
\begin_inset Newline newline
\end_inset

#1.2
\begin_inset Newline newline
\end_inset

#AR On essaie avec p=2.
 
\begin_inset Newline newline
\end_inset

#Pour trouver des coefficients qui correspondent à un processus stationnaire,
 il suffit de développer un polynôme dont les racines sont de module >1
 (et dont le terme constant est 1).
 Par exemple : (1-X/2)^2=1-X+X^2/4.
 On peut donc prendre a1=1, a2=-1/4.
 
\begin_inset Newline newline
\end_inset

modele<-list(ar=(c(1,-1/4))) 
\begin_inset Newline newline
\end_inset

n=500 
\begin_inset Newline newline
\end_inset

x=arima.sim(modele,n) 
\begin_inset Newline newline
\end_inset

plot(x) 
\begin_inset Newline newline
\end_inset

#MA : On essaie avec q=2.
 
\begin_inset Newline newline
\end_inset

modele<-list(ma=(c(2,3))) 
\begin_inset Newline newline
\end_inset

y=arima.sim(modele,n) 
\begin_inset Newline newline
\end_inset

plot(y)
\begin_inset Newline newline
\end_inset

#1.3 
\begin_inset Newline newline
\end_inset

acf(x,lag.max=20,type=c('correlation')) 
\begin_inset Newline newline
\end_inset

acf(y,lag.max=20,type=c('correlation')) 
\begin_inset Newline newline
\end_inset

#Les corrélations décroissent bien vers 0.
 
\begin_inset Newline newline
\end_inset

pacf(x,lag.max=20) 
\begin_inset Newline newline
\end_inset

pacf(y,lag.max=20) 
\begin_inset Newline newline
\end_inset

#Rien de significatif parce que p,q=2 (donc les auto-corrélations partielles
 doivent être nulles).
\begin_inset Newline newline
\end_inset

#1.4 
\begin_inset Newline newline
\end_inset

modele=list(ar=c(0.2,0.4,0.3), ma =c(0.5,0.2)) x=arima.sim(modele,n) 
\begin_inset Newline newline
\end_inset

plot(x) 
\begin_inset Newline newline
\end_inset

acf(x,lag.max=20) 
\begin_inset Newline newline
\end_inset

pacf(x,lag.max=20) 
\begin_inset Newline newline
\end_inset

# Si toutes les valeurs de xt sont >0 on va avoir des autocorrelations toujours
 >0 (et tendant vers 0).
 Les auto-corrélations partielles sont assez vite nulles parce que p, q
 sont petits.
\begin_inset Newline newline
\end_inset

#1.5 
\begin_inset Newline newline
\end_inset

modele=list(ar=c(0.2,0.4,0.3), ma =c(0.5,0.2),order=c(3,2,2)) 
\begin_inset Newline newline
\end_inset

x=arima.sim(modele,n) 
\begin_inset Newline newline
\end_inset

plot(x) 
\begin_inset Newline newline
\end_inset

acf(x,lag.max=20) 
\begin_inset Newline newline
\end_inset

pacf(x,lag.max=20) 
\begin_inset Newline newline
\end_inset

# Si toutes les valeurs de xt sont >0 on va avoir des autocorrelations toujours
 >0.
 On observe des auto-corrélations partielles nulles.
 
\begin_inset Newline newline
\end_inset

#----------------------------------------------------------------------#
\begin_inset Newline newline
\end_inset


\end_layout

\begin_layout Plain Layout

\family typewriter
#2 
\begin_inset Newline newline
\end_inset

#Vrai modèle pour serie1.dat : 
\begin_inset Newline newline
\end_inset

#modele=list(ar=c(0.3,0.2,0.3),order=c(3,1,0)) #x=arima.sim(modele,n)
\begin_inset Newline newline
\end_inset

#2.1 
\begin_inset Newline newline
\end_inset

data=scan(file="http://math.unice.fr/~rubentha/enseignement/serie1.dat") 
\begin_inset Newline newline
\end_inset

x=ts(data) 
\begin_inset Newline newline
\end_inset

plot(x) 
\begin_inset Newline newline
\end_inset

#Non, parce que la série n'a l'air stationnaire (la moyenne décroît).
\begin_inset Newline newline
\end_inset

#2.2 On remarque que diff(x) renvoie (x2-x1,x3-x2,...).
 
\begin_inset Newline newline
\end_inset

y=diff(x)
\begin_inset Newline newline
\end_inset

#2.3 
\begin_inset Newline newline
\end_inset

acf(y,lag.max=20) 
\begin_inset Newline newline
\end_inset

#Les auto-correlations tendent vers 0.
 
\begin_inset Newline newline
\end_inset

pacf(y,lag.max=20) 
\begin_inset Newline newline
\end_inset

#Les auto-correlations partielles sont nulles à partir d'un certain rang.
 
\begin_inset Newline newline
\end_inset

#Donc on propose un modèle AR(3) pour y.
\begin_inset Newline newline
\end_inset

#2.4 
\begin_inset Newline newline
\end_inset

out<-ar(y,aic=TRUE,order.max=NULL) 
\begin_inset Newline newline
\end_inset

out 
\begin_inset Newline newline
\end_inset

#On trouve : #Coefficients: # 1 2 3 #0.2720 0.2421 0.3183
\begin_inset Newline newline
\end_inset

#2.5 
\begin_inset Newline newline
\end_inset

#Faisons un test de niveau alpha=0,01.
 
\begin_inset Newline newline
\end_inset

Box.test(out$resid,lag=5) 
\begin_inset Newline newline
\end_inset

#On trouve une p-valeur>alpha donc on conclut qu'on a bien un bruit blanc.
\begin_inset Newline newline
\end_inset

#2.6 
\begin_inset Newline newline
\end_inset

#On propose le modèle pour x : ARIMA(3,1,0).
\begin_inset Newline newline
\end_inset

#2.7 
\begin_inset Newline newline
\end_inset

#Vrai modele: #modele=list(ma=c(0.2,-.5,0.6),order=c(0,2,3)) 
\begin_inset Newline newline
\end_inset

#x=arima.sim(modele,n)
\begin_inset Newline newline
\end_inset

data=scan(file="http://math.unice.fr/~rubentha/enseignement/serie2.dat") x=ts(data)
\begin_inset Newline newline
\end_inset

plot(x)
\begin_inset Newline newline
\end_inset

#On voit que la serie x=serie2.dat n'est pas stationnaire 
\begin_inset Newline newline
\end_inset

#(la moyenne n'est pas constante).
 
\begin_inset Newline newline
\end_inset

#On voit que y=diff(diff(x)) a l'air stationnaire (mais pas diff(x), parce
 que sa moyenne n'a pas l'air constante).
 
\begin_inset Newline newline
\end_inset

y=diff(x); plot(y)
\begin_inset Newline newline
\end_inset

y=diff(diff(x)); plot(y)
\begin_inset Newline newline
\end_inset

acf(y,lag.max=20) 
\begin_inset Newline newline
\end_inset

#Les auto-corrélations sont nulles à partir d'un certain rang (4).
 pacf(y,lag.max=20) 
\begin_inset Newline newline
\end_inset

#Les auto-corrélations partielles tendent vers 0.
 
\begin_inset Newline newline
\end_inset

#On propose donc pour y un modèle MA(4).
 
\begin_inset Newline newline
\end_inset

out<-arima(y,order=c(0,0,3)) 
\begin_inset Newline newline
\end_inset

out$coef 
\begin_inset Newline newline
\end_inset

#On trouve : -0.08355661 -0.30771185 0.56250498 
\begin_inset Newline newline
\end_inset

# Faisons un test de niveau alpha=0,01.
 
\begin_inset Newline newline
\end_inset

Box.test(out$resid,lag=5) 
\begin_inset Newline newline
\end_inset

#On trouve une p-valeur>alpha donc on conclut qu'on a bien un bruit blanc.
\begin_inset Newline newline
\end_inset

#----------------------------------------------------------------------#
\begin_inset Newline newline
\end_inset


\end_layout

\begin_layout Plain Layout

\family typewriter
#3 
\begin_inset Newline newline
\end_inset

#3.1 #C'est un processus AR(3).
\begin_inset Newline newline
\end_inset

#3.2-3-4
\begin_inset Newline newline
\end_inset

P=50; n=100 
\begin_inset Newline newline
\end_inset

biais=c(0,0,0,0,0) 
\begin_inset Newline newline
\end_inset

variance=c(0,0,0,0,0) 
\begin_inset Newline newline
\end_inset

modele=list(ar=c(1,-0.5,1.0/3)) 
\begin_inset Newline newline
\end_inset

for (i in 1:P) 
\begin_inset Newline newline
\end_inset

{ 
\begin_inset Newline newline
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
indent
\end_layout

\end_inset

 x=arima.sim(modele,n+5) 
\begin_inset Newline newline
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
indent
\end_layout

\end_inset

 y=window(x,1,n) 
\begin_inset Newline newline
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
indent
\end_layout

\end_inset

 out<-arima(y,order=c(3,0,0)) 
\begin_inset Newline newline
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
indent
\end_layout

\end_inset

 p=predict(out,5) 
\begin_inset Newline newline
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
indent
\end_layout

\end_inset

 for (j in 1:5) 
\begin_inset Newline newline
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
indent
\end_layout

\end_inset

{ 
\begin_inset Newline newline
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
indent
\end_layout

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
indent
\end_layout

\end_inset

 biais[j]=biais[j]+p$pred[j]-x[n+j]
\begin_inset Newline newline
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
indent
\end_layout

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
indent
\end_layout

\end_inset

 variance[j]=variance[j]+(p$pred[j]-x[n+j])^2 
\begin_inset Newline newline
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
indent
\end_layout

\end_inset

} 
\begin_inset Newline newline
\end_inset

} 
\begin_inset Newline newline
\end_inset

biais=biais/P; variance=variance/P 
\begin_inset Newline newline
\end_inset

print(biais); print(variance)
\begin_inset Newline newline
\end_inset

#3.5 
\begin_inset Newline newline
\end_inset

P=200; n=250 
\begin_inset Newline newline
\end_inset

biais=c(0,0,0,0,0); variance=c(0,0,0,0,0) 
\begin_inset Newline newline
\end_inset

modele=list(ar=c(1,-0.5,1.0/3)) 
\begin_inset Newline newline
\end_inset

for (i in 1:P) 
\begin_inset Newline newline
\end_inset

{ 
\begin_inset Newline newline
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
indent
\end_layout

\end_inset

 x=arima.sim(modele,n+5) 
\begin_inset Newline newline
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
indent
\end_layout

\end_inset

 y=window(x,1,n) 
\begin_inset Newline newline
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
indent
\end_layout

\end_inset

 out<-arima(y,order=c(3,0,0)) 
\begin_inset Newline newline
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
indent
\end_layout

\end_inset

 p=predict(out,5) 
\begin_inset Newline newline
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
indent
\end_layout

\end_inset

 for (j in 1:5) 
\begin_inset Newline newline
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
indent
\end_layout

\end_inset

{ 
\begin_inset Newline newline
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
indent
\end_layout

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
indent
\end_layout

\end_inset

 biais[j]=biais[j]+p$pred[j]-x[n+j]
\begin_inset Newline newline
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
indent
\end_layout

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
indent
\end_layout

\end_inset

 variance[j]=variance[j]+(p$pred[j]-x[n+j])^2 
\begin_inset Newline newline
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
indent
\end_layout

\end_inset

} 
\begin_inset Newline newline
\end_inset

} 
\begin_inset Newline newline
\end_inset

biais=biais/P; variance=variance/P
\begin_inset Newline newline
\end_inset

print(biais); print(variance)
\begin_inset Newline newline
\end_inset

# En principe, la variance de l'erreur diminue quand P (la taille de l'échantill
on d'apprentissage) augmente.
 Ici, ce n'est pas le cas parce que P=50 constitue un échantillon assez
 grand pour bien estimer les coefficients.
 
\end_layout

\begin_layout Plain Layout

\family typewriter
#----------------------------------------------------------------------#
\end_layout

\begin_layout Plain Layout

\family typewriter
#4 data<-scan("http://math.unice.fr/~rubentha/enseignement/sanfran.dat",skip=1)
 x=ts(data,frequency=12)
\end_layout

\begin_layout Plain Layout

\family typewriter
#4.1 #La série n'est pas stationnaire, la moyenne semble varier périodiquement
 (période T=12).
 On applique l'opérateur Delta_T à x.
 y=diff.ts(x,lag=12,1) #La série y a l'air stationnaire.
\end_layout

\begin_layout Plain Layout

\family typewriter
#4.2 #On utilise la fonction toute faite de R (qui minimise le critère AIC).
 out<-ar(y,aic=TRUE,order.max=NULL) #Faisons un test de niveau alpha=0,02
 sur les résidus produits.
 Box.test(out$resid,lag=5) #On trouve une p-valeur à 0,9997 > 0,02 donc on
 garde l'hypothèse "bruit blanc".
 #On veut ensuite ne garder que les données jusqu'en 1963.
 On en profite pour les mettre en forme plus joliment.
 x<-scan("http://math.unice.fr/~rubentha/enseignement/sanfran.dat",skip=1)
 x=ts(x,frequency=12) xw=window(x,c(1,1),c(32,12))
\end_layout

\begin_layout Plain Layout

\family typewriter
#4.3 out<-arima(xw,order=c(2,0,0),seasonal=list(order=c(2,0,0),period=12))
 plot(out$resid) #Faisons un test de niveau alpha=0,02 sur les résidus produits.
 Box.test(out$resid,lag=5) #On trouve une p-valeur à 0,8217 > 0,02 donc on
 garde l'hypothèse "bruit blanc".
\end_layout

\begin_layout Plain Layout

\family typewriter
#4.4 p=predict(out,3*12) xr=window(x,c(30,1),c(35,12)) plot(xr) lines(p$pred,col=
"red")
\end_layout

\begin_layout Plain Layout

\family typewriter
#4.5 #Modèle AR.
 out=ar(xw,aic=TRUE,order.max=NULL) p=predict(out,3*12) #R n'arrive pas à
 faire de prédiction (erreur="bla ...").
\end_layout

\begin_layout Plain Layout

\family typewriter
#Holt-Winters sans composante saisonnière.
 #On essaie d'ajuster une droite à la série.
 Comme la courbe de la série n'est pas du tout une droite, on a intérêt
 à prendre des coefficients proches de 1.
 xlisse<-HoltWinters(xw,alpha=0.8,beta=0.8,gamma=FALSE) p<-predict(xlisse,n.ahead=3
*12) plot(xr) lines(p,col="red")
\end_layout

\begin_layout Plain Layout

\family typewriter
#Holt-Winters avec composante saisonnière.
 #La composante saisonnière est un peu toujours la même donc on choisit
 gamma proche de 0 (pour prendre en compte beaucoup d'observations).
 Pour les autres coefficients (qui sont les paramètres de la droite d'ajustement
) on les prend proches de 1 parce que la courbe varie rapidement (elle ne
 ressemble pas à une droite du tout).
 xlisse<-HoltWinters(xw,alpha=0.8,beta=0.8,gamma=0.2,seasonal='add') p<-predict(xli
sse,n.ahead=3*12) plot(xr) lines(p,col="red")
\end_layout

\begin_layout Plain Layout

\family typewriter
#4.6 Graphiquement, le meilleur modèle est le SARIMA(2,0,12).
\end_layout

\begin_layout Plain Layout

\family typewriter
#4.7 On pourrait aussi calculer la somme des carrés des erreurs (ce que je
 ne fais pas ici).
\end_layout

\begin_layout Plain Layout

\family typewriter
#----------------------------------------------------------------------#
 #5 x=scan("http://math.unice.fr/~rubentha/enseignement/UKinterestrates.dat")
 x=ts(x,start=c(1953,3),end=c(1995,12),frequency=12) #La série n'a pas l'air
 stationnaire (la moyenne varie).
 x1=diff(x) #La série x1 a l'air stationnaire.
 acf(x1,lag.max=20) pacf(x1,lag.max=20) #Les auto-corrélations partielles
 tendent vers 0 et les auto-corrélations sont nulles à partir du rang 2.
 Donc on propose un modèle MA(1) pour x1 (donc un modèle ARIMA(0,1) pour
 x).
 out<-arima(x,order=c(0,1,1)) #Faisons un test de niveau alpha=0,02 sur
 les résidus produits.
 Box.test(out$resid,lag=5) #On trouve une p-valeur à 0,7624 > 0,02 donc on
 garde l'hypothèse "bruit blanc".
\end_layout

\begin_layout Plain Layout

\family typewriter
#On peut aussi essayer de faire des prédictions.
 #On commence par découper x.
 xw=window(x,c(1953,3),c(1993,12)) out<-arima(xw,order=c(0,1,1)) xr=window(x,c(1
953,1),c(1995,12)) plot(xr) p=predict(out,12*2) lines(p$pred,col='red')
 #Pas de précision extraordinaire.
\end_layout

\end_inset


\end_layout

\begin_layout Section
\begin_inset CommandInset label
LatexCommand label
name "sec:Feuille-d-exercices-numero-4"

\end_inset

Feuille d'exercices numéro 4 (durée : 6h)
\begin_inset Argument 1
status open

\begin_layout Plain Layout
Feuille d'exercices numéro 4
\end_layout

\end_inset


\end_layout

\begin_layout Enumerate
\begin_inset CommandInset label
LatexCommand label
name "enu:regression-lineaire"

\end_inset

Soit 
\begin_inset Formula $(x_{1},x_{2},\dots,x_{n})\in\R^{n}$
\end_inset

, 
\begin_inset Formula $n\geq2$
\end_inset

.
 On cherche
\begin_inset Formula 
\[
(\widehat{a},\widehat{b})=\argmin_{(a,b)\in\R^{2}}F(a,b)\mbox{ , avec }F(a,b):=\sum_{t=1}^{n}(x_{t}-a-bt)^{2}\,.
\]

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Enumerate
Trouver les points critiques de 
\begin_inset Formula $F$
\end_inset

.
\begin_inset Newline newline
\end_inset


\begin_inset Box Boxed
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "60col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
Formules à savoir par c
\begin_inset ERT
status open

\begin_layout Plain Layout

{
\backslash
oe}
\end_layout

\end_inset

ur :
\begin_inset Formula 
\[
\sum_{k=1}^{n}k=\frac{n(n+1)}{2}\,,\,\sum_{k=1}^{n}k^{2}=\frac{n(n+1)(2n+1)}{6}\,.
\]

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Enumerate
Montrer que l'unique point critique est un minimum absolu de 
\begin_inset Formula $F$
\end_inset

.
\end_layout

\end_deeper
\begin_layout Enumerate
Soit 
\begin_inset Formula $\R[X]$
\end_inset

 l'espace des polynômes à coefficients réels.
 Soit 
\begin_inset Formula $T\in\R$
\end_inset

.
 Soit 
\begin_inset Formula $\Delta\,:\,P\in\R[X]\mapsto\Delta P(X)=P(X)-P(X-T)$
\end_inset

.
 
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Enumerate
On suppose que 
\begin_inset Formula $\deg(P)\geq1$
\end_inset

.
 Montrer que 
\begin_inset Formula $\deg(\Delta P)\leq\deg(P)-1$
\end_inset

.
 Montrer que si 
\begin_inset Formula $\deg(P)=0$
\end_inset

, alors 
\begin_inset Formula $\Delta P=0$
\end_inset

.
\end_layout

\begin_layout Enumerate
On suppose que 
\begin_inset Formula $\Delta^{k}P\neq0$
\end_inset

.
 Montrer que 
\begin_inset Formula $\deg(P)\geq k$
\end_inset

.
\end_layout

\end_deeper
\begin_layout Enumerate
Les processus 
\begin_inset Formula $(X_{k})$
\end_inset

 suivants sont stationnaires et centrés.
 Le processus 
\begin_inset Formula $(\epsilon_{n})_{n\geq0}$
\end_inset

 est un bruit blanc de variance 
\begin_inset Formula $\alpha^{2}$
\end_inset

 et de moyenne nulle.
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Enumerate
Quelle est la fonction d'auto-covariance du processus auto-régressif de
 représentation
\begin_inset Formula 
\[
X_{n}-\frac{1}{2}X_{n-1}=\epsilon_{n}\,?
\]

\end_inset

(Commencer par vérifier qu'il existe un processus stationnaire vérifiant
 cette équation.)
\end_layout

\begin_layout Enumerate
On considère le processus auto-régressif de représentation 
\begin_inset Formula 
\[
X_{n}-\frac{1}{6}X_{n-1}-\frac{1}{6}X_{n-2}=\epsilon_{n}\,.
\]

\end_inset

Commencer par vérifier la stationnarité du processus.
 Donner les valeurs de 
\begin_inset Formula $\sigma(0)$
\end_inset

 et 
\begin_inset Formula $\sigma(1)$
\end_inset

.
 Trouver les racines du polynôme 
\begin_inset Formula $1-\frac{1}{6}z-\frac{1}{6}z^{2}$
\end_inset

 et en déduire l'expression de 
\begin_inset Formula $\sigma(h)$
\end_inset

 pour 
\begin_inset Formula $h\geq1$
\end_inset

.
\end_layout

\begin_layout Enumerate
On considère le processus auto-régressif de représentation 
\begin_inset Formula 
\[
X_{n}-X_{n-1}+\frac{1}{2}X_{n-2}=\epsilon_{n}.
\]

\end_inset

Commencer par vérifier la stationnarité du processus.
 Donner les expressions de 
\begin_inset Formula $\sigma(0)$
\end_inset

 et 
\begin_inset Formula $\sigma(1).$
\end_inset

 Trouver les racines du polynôme 
\begin_inset Formula $1-z+\frac{1}{2}z^{2}$
\end_inset

 et en déduire l'expression de 
\begin_inset Formula $\sigma(h)$
\end_inset

 pour 
\begin_inset Formula $h\geq1$
\end_inset

.
\end_layout

\end_deeper
\begin_layout Enumerate
\begin_inset CommandInset label
LatexCommand label
name "enu:ex-4"

\end_inset

Soit le processes 
\begin_inset Formula $AR_{1}$
\end_inset

 (centré) suivant
\begin_inset Formula 
\begin{equation}
X_{t}=aX_{t-1}+\epsilon_{t}\label{eq:rec01}
\end{equation}

\end_inset

où 
\begin_inset Formula $\epsilon_{t}$
\end_inset

 est un bruit blanc centré de variance 
\begin_inset Formula $\sigma^{2}$
\end_inset

.
 On suppose 
\begin_inset Formula $a\neq0$
\end_inset

.
 
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Enumerate
Quelle condition doit-on imposer sur 
\begin_inset Formula $a$
\end_inset

 pour qu'il existe un processus stationnaire vérifiant (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:rec01"

\end_inset

) ? On suppose dans la suite que cette condition est vérifiée.
\end_layout

\begin_layout Enumerate
Calculer la variance de ce processus.
\end_layout

\begin_layout Enumerate
Montrer que l'auto-covariance d'un tel processus est 
\begin_inset Formula 
\[
\sigma(h)=\sigma^{2}\frac{a^{h}}{1-a^{2}}\,.
\]

\end_inset


\end_layout

\begin_layout Enumerate
En déduire la convergence vers 
\begin_inset Formula $0$
\end_inset

 de l'auto-covariance lorsque 
\begin_inset Formula $h\rightarrow+\infty$
\end_inset

.
\end_layout

\begin_layout Enumerate
Calculer les auto-corrélations.
\end_layout

\begin_layout Enumerate
On suppose que 
\begin_inset Formula $\E(X_{0}|X_{1})=X_{1}/a$
\end_inset

 (il n'y a pas de raison que ce soit toujours vrai).
 Calculer les auto-corrélations partielles.
 
\end_layout

\end_deeper
\begin_layout Enumerate
Considérons le processus stationnaire 
\begin_inset Formula $(X_{t})_{t\geq0}$
\end_inset

 satisfaisant 
\begin_inset Formula $X_{t}=aX_{t-1}+\epsilon_{t}+b\epsilon_{t-1}$
\end_inset

 (avec 
\begin_inset Formula $(\epsilon_{t})$
\end_inset

 bruit blanc centré de variance 
\begin_inset Formula $\sigma^{2}$
\end_inset

).
 
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Enumerate
Montrer que 
\begin_inset Formula $\sigma(0)=\sigma^{2}\times\frac{1+b^{2}+2ab}{1-a^{2}}$
\end_inset

, 
\begin_inset Formula $\sigma(1)=\sigma^{2}\times\frac{a+b+ab^{2}+a^{2}b}{1-a^{2}}$
\end_inset

.
\end_layout

\begin_layout Enumerate
Montrer que 
\begin_inset Formula $\rho(1)=\frac{(a+b)(1+ab)}{b^{2}+2ab+1}$
\end_inset

 et 
\begin_inset Formula $\rho(h)=a^{h-1}\rho(1)$
\end_inset

 pour 
\begin_inset Formula $h\geq1$
\end_inset

.
 
\begin_inset Newline newline
\end_inset


\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Note Comment
status open

\begin_layout Plain Layout
Expliquer pourquoi il existe un processus stationnaire 
\begin_inset Formula $ARMA_{1,1}$
\end_inset

 défini par 
\begin_inset Formula $X_{t}+aX_{t-1}=\epsilon_{t}+a\epsilon_{t-1}$
\end_inset

 (avec 
\begin_inset Formula $(\epsilon_{t})$
\end_inset

 bruit blanc centré de variance 
\begin_inset Formula $\sigma^{2}$
\end_inset

, 
\begin_inset Formula $|a|<1$
\end_inset

, 
\begin_inset Formula $a\neq0$
\end_inset

).
 Existe-t-il une écriture plus simple de ce processus ?
\end_layout

\end_inset


\end_layout

\begin_layout Section
Corrigé de la feuille d'exercices numéro 4
\end_layout

\begin_layout Enumerate
\begin_inset ERT
status open

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Enumerate
Nous avons
\begin_inset Formula 
\begin{eqnarray*}
\frac{\partial F}{\partial a}(a,b) & = & \sum_{t=1}^{n}-2(x_{t}-a-bt)\\
\frac{\partial F}{\partial b}(a,b) & = & \sum_{t=1}^{n}-2t(x-a-bt)\,.
\end{eqnarray*}

\end_inset

Notons 
\begin_inset Formula 
\[
\overline{x}_{n}=\sum_{t=1}^{n}x_{t}\,,\,\overline{s}_{n}=\sum_{t=1}^{n}tx_{t}\,.
\]

\end_inset

Nous cherchons à résoudre le système 
\begin_inset Formula 
\[
\left\{ \begin{array}{ccc}
-\overline{x}_{n}+an+b\frac{n(n+1)}{2} & = & 0\\
-\overline{s}_{n}+a\frac{n(n+1)}{2}+b\frac{n(n+1)(2n+1)}{6} & = & 0\,.
\end{array}\right.
\]

\end_inset

Nous calculons la valeur de l'unique solution
\begin_inset space ~
\end_inset

:
\begin_inset Formula 
\begin{eqnarray*}
\left(-\overline{x}_{n}+an\right)\times\frac{(2n+1)}{3}-\left(-\overline{s}_{n}+a\frac{n(n+1)}{2}\right) & = & 0\\
an\left(\frac{(2n+1)}{3}-\frac{(n+1)}{2}\right) & = & \overline{x}_{n}\times\frac{(2n+1)}{3}-\overline{s}_{n}\\
a & = & \frac{2(2n+1)\overline{x}_{n}-6\overline{s}_{n}}{n(n-1)}\,,
\end{eqnarray*}

\end_inset


\begin_inset Formula 
\begin{eqnarray*}
\left(-\overline{x}_{n}+b\frac{n(n+1)}{2}\right)\times\frac{(n+1)}{2}-\left(-\overline{s}_{n}+b\frac{n(n+1)(2n+1)}{6}\right) & = & 0\\
b\frac{n(n+1)}{2}\left(\frac{n+1}{2}-\frac{2n+1}{3}\right) & = & \frac{(n+1)}{2}\overline{x}_{n}-\overline{s}_{n}\\
b & = & -\frac{6(n+1)\overline{x}_{n}-12\overline{s}_{n}}{n(n+1)(n-1)}\,.
\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Enumerate
Calculons les dérivées secondes de 
\begin_inset Formula $F$
\end_inset

 (pour voir une autre méthode que celle vue en cours, vous choisissez celle
 que vous préférez)
\begin_inset space ~
\end_inset

:
\begin_inset Formula 
\begin{eqnarray*}
\frac{\partial^{2}F}{\partial a^{2}}(a,b) & = & 2n\\
\frac{\partial^{2}F}{\partial b^{2}}(a,b) & = & \frac{n(n+1)(2n+1)}{3}\\
\frac{\partial^{2}F}{\partial a\partial b}(a,b) & = & n(n+1)\,.
\end{eqnarray*}

\end_inset

La matrice hessienne de 
\begin_inset Formula $F$
\end_inset

 en 
\begin_inset Formula $(a,b)$
\end_inset

 est donc
\begin_inset Formula 
\[
F^{''}(a,b)=\left[\begin{array}{cc}
2n & n(n+1)\\
n(n+1) & \frac{n(n+1)(2n+1)}{3}
\end{array}\right]\,.
\]

\end_inset

La forme quadratique associée est
\begin_inset space ~
\end_inset

:
\begin_inset Formula 
\begin{eqnarray*}
(x,y) & \mapsto & 2nx^{2}+\frac{n(n+1)(2n+1)}{3}y^{2}+2n(n+1)xy\\
 &  & =\frac{n(n+1)(2n+1)}{3}\left(y+\frac{3x}{(2n+1)}\right)^{2}-\frac{3n(n+1)}{(2n+1)}x^{2}+2nx^{2}\\
 &  & =\frac{n(n+1)(2n+1)}{3}\left(y+\frac{3x}{(2n+1)}\right)^{2}+x^{2}\left(\frac{n^{2}-n}{2n+1}\right)\,.
\end{eqnarray*}

\end_inset

On voit que 
\begin_inset Formula $n^{2}-n>0$
\end_inset

 pour 
\begin_inset Formula $n\geq2$
\end_inset

 et que donc la forme quadratique est définie positive.
 Donc 
\begin_inset Formula $F$
\end_inset

 est strictement convexe.
 Donc le point critique trouvé est un minimum absolu.
\end_layout

\end_deeper
\begin_layout Enumerate
\begin_inset ERT
status open

\begin_layout Plain Layout

\end_layout

\end_inset

(vu en cours)
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Enumerate
Soit 
\begin_inset Formula $n$
\end_inset

 le degré de 
\begin_inset Formula $P$
\end_inset

, on suppose 
\begin_inset Formula $n\geq1$
\end_inset

.
 Le polynôme 
\begin_inset Formula $P$
\end_inset

 peut s'écrire 
\begin_inset Formula $P(X)=a_{n}X^{n}+a_{n-1}X^{n-1}+\dots+a_{0}$
\end_inset

 (avec 
\begin_inset Formula $a_{0}$
\end_inset

, … , 
\begin_inset Formula $a_{n}$
\end_inset

 dans 
\begin_inset Formula $\R$
\end_inset

).
 Et donc
\begin_inset Formula 
\begin{eqnarray*}
-\Delta P(X) & = & (a_{n}(X-T)^{n}+\dots+a_{0})-(a_{n}X^{n}+\dots+a_{0})\\
 & = & a_{n}\sum_{i=0}^{n}[C_{n}^{i}X^{i}(-T)^{n-i}]-a_{n}X^{n}\\
 &  & +(a_{n-1}(X-T)^{n-1}+\dots+a_{0})-(a_{n-1}X^{n-1}+\dots+a_{0})\\
 & = & a_{n}\sum_{i=0}^{n-1}[C_{n}^{i}X^{i}(-T)^{n-i}]\\
 &  & +(a_{n-1}(X-T)^{n-1}+\dots+a_{0})-(a_{n-1}X^{n-1}+\dots+a_{0})\,.
\end{eqnarray*}

\end_inset

Donc 
\begin_inset Formula $\deg(\Delta P)\leq n-1=\deg(P)-1$
\end_inset

.
 Dans le cas 
\begin_inset Formula $n=0$
\end_inset

, le même calcul montre que 
\begin_inset Formula $\Delta P=0$
\end_inset

.
 
\end_layout

\begin_layout Enumerate
Soit 
\begin_inset Formula $n$
\end_inset

 le degré de 
\begin_inset Formula $P$
\end_inset

.
 Par la question précédente, nous savons que si 
\begin_inset Formula $\deg(P)\leq k-1$
\end_inset

, alors 
\begin_inset Formula $\Delta^{k}P=0$
\end_inset

, ce qui n'est pas le cas.
 Donc 
\begin_inset Formula $\deg(P)\geq k$
\end_inset

.
\end_layout

\end_deeper
\begin_layout Enumerate
\begin_inset ERT
status open

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Enumerate
Le polynôme associé à l'équation est 
\begin_inset Formula $A(X)=1-X/2.$
\end_inset

 Son unique racine est 
\begin_inset Formula $2$
\end_inset

, qui est de module 
\begin_inset Formula $>1$
\end_inset

.
 Donc il existe un processus stationnaire qui vérifie l'équation voulue.
 
\begin_inset Newline newline
\end_inset

Nous avons (pour tout 
\begin_inset Formula $n$
\end_inset

)
\begin_inset Formula 
\begin{eqnarray*}
\var\left(\left(X_{n}-\frac{1}{2}X_{n-1}\right)\right) & = & \alpha^{2}\\
\sigma(0)+\frac{1}{4}\sigma(0)-\sigma(1) & = & \alpha^{2}\\
\frac{5}{4}\sigma(0)-\sigma(1) & = & \alpha^{2}\,,
\end{eqnarray*}

\end_inset

et
\begin_inset Formula 
\begin{eqnarray*}
\sigma(1) & = & \cov(X_{n},X_{n-1})\\
 & = & \cov\left(\frac{1}{2}X_{n-1}+\epsilon_{n},X_{n-1}\right)\\
 & = & \frac{\sigma(0)}{2}+0\,.
\end{eqnarray*}

\end_inset

D'où
\begin_inset space ~
\end_inset

:
\begin_inset Formula 
\begin{eqnarray*}
\frac{5}{4}\sigma(0)-\frac{\sigma(0)}{2} & = & \alpha^{2}\\
\sigma(0) & = & \frac{4}{3}\alpha^{2}
\end{eqnarray*}

\end_inset

et
\begin_inset Formula 
\[
\sigma(1)=\frac{2}{3}\alpha^{2}\,.
\]

\end_inset

La formule de récurrence pour les 
\begin_inset Formula $\sigma(.)$
\end_inset

 est 
\begin_inset Formula 
\[
\sigma(h+1)=\frac{1}{2}\sigma(h)\,.
\]

\end_inset

Donc, pour tout 
\begin_inset Formula $h$
\end_inset

,
\begin_inset Formula 
\[
\sigma(h)=\frac{2^{2-h}}{3}\alpha^{2}\,.
\]

\end_inset

 
\end_layout

\begin_layout Enumerate
Nous avons (pour tout 
\begin_inset Formula $n$
\end_inset

)
\begin_inset Formula 
\begin{eqnarray*}
\var(X_{n}) & =\var & \left(\frac{1}{6}X_{n-1}+\frac{1}{6}X_{n-2}+\epsilon_{n}\right)\\
\sigma(0) & = & \frac{1}{36}\sigma(0)+\frac{1}{36}\sigma(0)+\alpha^{2}+\frac{2}{36}\sigma(1)+0\\
36\sigma(0) & = & 2\sigma(0)+2\sigma(1)+36\alpha^{2}\\
34\sigma(0) & = & 2\sigma(1)+36\alpha^{2}
\end{eqnarray*}

\end_inset


\begin_inset Formula 
\begin{eqnarray*}
\cov(X_{n},X_{n-1}) & = & \cov\left(\frac{1}{6}X_{n-1}+\frac{1}{6}X_{n-2}+\epsilon_{n},X_{n-1}\right)\\
\sigma(1) & = & \frac{1}{6}\sigma(0)+\frac{1}{6}\sigma(1)+0\\
5\sigma(1) & = & \sigma(0)\,.
\end{eqnarray*}

\end_inset

D'où 
\begin_inset Formula 
\begin{eqnarray*}
170\sigma(1)-2\sigma(1) & = & 36\alpha^{2}\\
168\sigma(1) & = & 36\alpha\\
\sigma(1) & = & \frac{36}{168}\alpha^{2}=\frac{3\alpha^{2}}{14}
\end{eqnarray*}

\end_inset

et 
\begin_inset Formula 
\[
\sigma(0)=\frac{15}{14}\alpha^{2}\,.
\]

\end_inset

Nous remarquons que 
\begin_inset Formula $2$
\end_inset

 est racine de 
\begin_inset Formula $P$
\end_inset

, ce qui permet de factoriser
\begin_inset space ~
\end_inset

:
\begin_inset Formula 
\[
P(z)=1-\frac{1}{6}z-\frac{1}{6}z^{2}=\left(1-\frac{z}{2}\right)\left(1+\frac{z}{3}\right)\,.
\]

\end_inset

Donc les racines du polynôme sont 
\begin_inset Formula $\{2;-3\}$
\end_inset

.
 La relation de récurence sur les auto-covariances est la suivante
\begin_inset space ~
\end_inset

:
\begin_inset Formula 
\[
\sigma(h+2)=\frac{\sigma(h+1)+\sigma(h)}{6}\,,
\]

\end_inset

de polynôme caractéristique 
\begin_inset Formula $Q(z)=z^{2}-z/6-1/6$
\end_inset

 dont les racines sont inverses de celles de 
\begin_inset Formula $P$
\end_inset

.
 Les racines de 
\begin_inset Formula $Q$
\end_inset

 sont donc 
\begin_inset Formula $\{1/2;-1/3\}$
\end_inset

.
 Donc 
\begin_inset Formula $\sigma(h)$
\end_inset

 s'écrit sous la forme
\begin_inset Formula 
\[
\sigma(h)=\frac{a}{2^{h}}+\frac{b}{(-3)^{h}}\,.
\]

\end_inset

Nous déterminons 
\begin_inset Formula $a$
\end_inset

 et 
\begin_inset Formula $b$
\end_inset

 à partir de 
\begin_inset Formula $\sigma(0)$
\end_inset

 et 
\begin_inset Formula $\sigma(1)$
\end_inset


\begin_inset space ~
\end_inset

:
\begin_inset Formula 
\[
\left\{ \begin{array}{cc}
a+b & =\sigma(0)\\
\frac{a}{2}-\frac{b}{3} & =\sigma(1)\,.
\end{array}\right.
\]

\end_inset

D'où 
\begin_inset Formula 
\begin{eqnarray*}
a\left(\frac{1}{3}+\frac{1}{2}\right) & = & \frac{\sigma(0)}{3}+\sigma(1)\\
a\times\frac{5}{6} & = & \left(\frac{5}{14}+\frac{3}{14}\right)\alpha^{2}\\
a & = & \frac{24}{35}\alpha^{2}\,,
\end{eqnarray*}

\end_inset

et
\begin_inset Formula 
\begin{eqnarray*}
b & = & \sigma(0)-a\\
 & = & \left(\frac{15}{14}-\frac{24}{35}\right)\alpha^{2}\\
 & = & \left(\frac{75-48}{70}\right)\alpha^{2}=\frac{27}{70}\alpha^{2}\,.
\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Enumerate
Nous avons
\begin_inset Formula 
\begin{eqnarray*}
\var(X_{n}) & = & \var\left(X_{n-1}-\frac{1}{2}X_{n-2}+\epsilon_{n}\right)\\
\sigma(0) & = & \sigma(0)+\frac{\sigma(0)}{4}-\sigma(1)+\alpha^{2}\\
-\frac{\sigma(0)}{4}+\sigma(1) & = & \alpha^{2}\,,
\end{eqnarray*}

\end_inset

et 
\begin_inset Formula 
\begin{eqnarray*}
\cov(X_{n},X_{n-1}) & = & \cov\left(X_{n-1}-\frac{1}{2}X_{n-2}+\epsilon_{n},X_{n-1}\right)\\
\sigma(1) & = & \sigma(0)-\frac{\sigma(1)}{2}\\
\frac{3\sigma(1)}{2} & = & \sigma(0)\,.
\end{eqnarray*}

\end_inset

D'où
\begin_inset Formula 
\begin{eqnarray*}
-\frac{3\sigma(1)}{8}+\sigma(1) & = & \alpha^{2}\\
\sigma(1) & = & \frac{8}{5}\alpha^{2}\,,
\end{eqnarray*}

\end_inset

et
\begin_inset Formula 
\begin{eqnarray*}
\sigma(0) & = & \frac{12}{5}\alpha^{2}\,.
\end{eqnarray*}

\end_inset

Soit le polynôme 
\begin_inset Formula $P(z)=1-z+z^{2}/2$
\end_inset

.
 Son discriminant est :
\begin_inset Formula 
\[
\Delta=1-\frac{4}{2}=-1\,.
\]

\end_inset

Les racines de 
\begin_inset Formula $P$
\end_inset

 sont donc
\begin_inset Formula 
\[
\left\{ 1+i\,;\,1-i\right\} \,.
\]

\end_inset

Le polynôme caractéristique de la relation de récurence des 
\begin_inset Formula $\sigma(h)$
\end_inset

 est 
\begin_inset Formula 
\[
Q(z)=z^{2}-z+\frac{1}{2}\,,
\]

\end_inset

dont les racines sont les inverses de celles de 
\begin_inset Formula $P$
\end_inset

 et sont donc 
\begin_inset Formula 
\[
\left\{ \frac{1}{1+i}\,;\,\frac{1}{1-i}\right\} =\left\{ \frac{1-i}{2}\,;\,\frac{1+i}{2}\right\} 
\]

\end_inset

(nous aurions pu les calculer directement, sans passer par 
\begin_inset Formula $P$
\end_inset

).
 Les 
\begin_inset Formula $\sigma(h)$
\end_inset

 sont donc de la forme 
\begin_inset Formula 
\[
\sigma(h)=a2^{-h}(1-i)^{h}+b2^{-h}(1+i)^{h}\,.
\]

\end_inset

Nous déterminons 
\begin_inset Formula $a$
\end_inset

 et 
\begin_inset Formula $b$
\end_inset

 à partir de 
\begin_inset Formula $\sigma(0)$
\end_inset

 et 
\begin_inset Formula $\sigma(1)$
\end_inset


\begin_inset space ~
\end_inset

:
\begin_inset Formula 
\[
\left\{ \begin{array}{cc}
a+b & =\sigma(0)\\
\frac{a}{2}(1-i)+\frac{b}{2}(1+i) & =\sigma(1)\,.
\end{array}\right.
\]

\end_inset

D'où
\begin_inset Formula 
\begin{eqnarray*}
\frac{a}{2}(1+i-(1-i)) & = & \frac{\sigma(0)(1+i)}{2}-\sigma(1)\\
ia & = & \frac{\sigma(0)(1+i)}{2}-\sigma(1)\\
a & = & -i\times\left(\frac{6}{5}\alpha^{2}+\frac{6i}{5}\alpha^{2}-\frac{8}{5}\alpha^{2}\right)\\
a & = & \frac{6}{5}\alpha^{2}+\frac{2i}{5}\alpha^{2}\,,
\end{eqnarray*}

\end_inset

et
\begin_inset Formula 
\begin{eqnarray*}
b & = & \sigma(0)-a\\
 & = & \frac{12}{5}\alpha^{2}-\left(\frac{6}{5}\alpha^{2}+\frac{2i}{5}\alpha^{2}\right)\\
 & = & \frac{6}{5}\alpha^{2}-\frac{2i}{5}\alpha^{2}\,.
\end{eqnarray*}

\end_inset

Nous avons donc pour tout 
\begin_inset Formula $h$
\end_inset

 (avec 
\begin_inset Formula $\mathcal{R}$
\end_inset

 désignant la partie réelle)
\begin_inset Formula 
\begin{eqnarray*}
\sigma(h) & = & \frac{2\alpha^{2}}{5}\left((3+i)2^{-h}(1-i)^{h}+(3-i)2^{-h}(1+i)^{h}\right)\\
 & = & \frac{4\alpha^{2}}{5}\mathcal{R}\left((3+i)2^{-h}(1-i)^{h}\right)\\
 & = & \frac{4\alpha^{2}}{5}\mathcal{R}\left((3+i)2^{-h}(\sqrt{2}e^{-i\pi/4})^{h}\right)\\
 & = & \frac{4\alpha^{2}}{5}\mathcal{R}\left((3+i)2^{-h/2}(\cos(-h\pi/4)+i\sin(-h\pi/4))\right)\\
 & = & \frac{4\alpha^{2}}{5}\left(3.2^{-h/2}\cos(h\pi/4)+2^{-h/2}\sin(h\pi/4)\right)\,.
\end{eqnarray*}

\end_inset


\end_layout

\end_deeper
\begin_layout Enumerate
\begin_inset ERT
status open

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Enumerate
\begin_inset Note Comment
status collapsed

\begin_layout Plain Layout
Si 
\begin_inset Formula $a=0$
\end_inset

, la suite 
\begin_inset Formula $(X_{t})$
\end_inset

 est i.i.d.
 et est donc stationnaire.
\end_layout

\end_inset

 Si 
\begin_inset Formula $a\ne0$
\end_inset

, le polynôme associé à ce processus est 
\begin_inset Formula $P(z)=1-az$
\end_inset

, de racine 
\begin_inset Formula $1/a$
\end_inset

.
 Dans ce cas, on sait qu'il exise une suite stationnaire vérifiant la relation
 voulue si 
\begin_inset Formula $|1/a|>1$
\end_inset

, c'est à dire 
\begin_inset Formula $|a|<1$
\end_inset

.
\end_layout

\begin_layout Enumerate
Nous avons (pour tout 
\begin_inset Formula $t$
\end_inset

)
\begin_inset Formula 
\begin{eqnarray*}
\var(X_{t}) & = & \var(aX_{t-1}+\epsilon_{t})\\
\sigma(0) & = & a^{2}\sigma(0)+\sigma^{2}\\
\sigma(0) & = & \frac{\sigma^{2}}{1-a^{2}}\,.
\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Enumerate
La relation de récurence vérifiée par les auto-covariances est la suivante
 :
\begin_inset Formula 
\[
\sigma(h+1)=a\sigma(h)\,.
\]

\end_inset

Nous en déduisons que pour tout 
\begin_inset Formula $h$
\end_inset


\begin_inset space ~
\end_inset

:
\begin_inset Formula 
\[
\sigma(h)=\frac{\sigma^{2}a^{h}}{1-a^{2}}\,.
\]

\end_inset


\end_layout

\begin_layout Enumerate
Donc 
\begin_inset Formula $\sigma(h)\underset{h\rightarrow+\infty}{\longrightarrow}0$
\end_inset

.
 
\end_layout

\begin_layout Enumerate
Pour 
\begin_inset Formula $h\geq1$
\end_inset


\begin_inset space ~
\end_inset

:
\begin_inset Formula 
\[
\rho(h)=\frac{\sigma(h)}{\sigma(0)}=a^{h}\,.
\]

\end_inset


\end_layout

\begin_layout Enumerate
Pour tout 
\begin_inset Formula $t$
\end_inset

, nous pouvons écrire
\begin_inset Formula 
\begin{eqnarray*}
X_{t} & = & aX_{t-1}+\epsilon_{t}\\
 & = & a^{2}X_{t-2}+a\epsilon_{t-1}+\epsilon_{t}\\
 & = & a^{3}X_{t-3}+a^{2}\epsilon_{t-2}+a\epsilon_{t-1}+\epsilon_{t}\\
 & \vdots\\
 & = & a^{t}X_{0}+\sum_{i=1}^{t}a^{t-i}\epsilon_{i}\,.
\end{eqnarray*}

\end_inset

Fixons maintenant 
\begin_inset Formula $n$
\end_inset

.
 La donnée de 
\begin_inset Formula $X_{1}$
\end_inset

, …, 
\begin_inset Formula $X_{n-1}$
\end_inset

 est équivalente à la donnée de 
\begin_inset Formula $aX_{0}+\epsilon_{1}$
\end_inset

, 
\begin_inset Formula $\epsilon_{2}$
\end_inset

, 
\begin_inset Formula $\epsilon_{3}$
\end_inset

, … , 
\begin_inset Formula $\epsilon_{n-1}$
\end_inset

 (les variables de la deuxième liste se déduisent de celle de la deuxième
 liste, et vice-versa).
 Nous avons donc 
\begin_inset Formula 
\begin{eqnarray*}
\E(X_{n}|X_{1},\dots X_{n-1}) & = & \E(a^{n}X_{0}+a^{n-1}\epsilon_{1}+\sum_{i=2}^{n-1}a^{n-i}\epsilon_{i}+\epsilon_{n}|aX_{0}+\epsilon_{1},\epsilon_{2},\dots,\epsilon_{n-1})\\
 & = & a^{n}X_{0}+a^{n-1}\epsilon_{1}+\sum_{i=2}^{n-1}a^{n-i}\epsilon_{i}+\E(\epsilon_{n}|aX_{0}+\epsilon_{1},\epsilon_{2},\dots,\epsilon_{n-1})\\
 & = & a^{n}X_{0}+a^{n-1}\epsilon_{1}+\sum_{i=2}^{n-1}a^{n-i}\epsilon_{i}+\E(\epsilon_{n})\\
 & = & a^{n-1}X_{1}+\sum_{i=2}^{n-1}a^{n-i}\epsilon_{i}\,,
\end{eqnarray*}

\end_inset

et 
\begin_inset Formula 
\begin{eqnarray*}
\E(X_{0}|X_{1},\dots,X_{n-1}) & = & \E(X_{0}|X_{1})\\
 & = & \frac{X_{1}}{a}\,.
\end{eqnarray*}

\end_inset

Donc
\begin_inset Formula 
\[
X_{n}-\E(X_{n}|X_{1},\dots X_{n-1})=\epsilon_{n}\,,
\]

\end_inset


\begin_inset Formula 
\[
X_{0}-\E(X_{0}|X_{1},\dots,X_{n-1})=X_{0}-\frac{X_{1}}{a}=-\frac{\epsilon_{1}}{a}\,.
\]

\end_inset

Donc
\begin_inset Formula 
\begin{eqnarray*}
\cov(X_{0}-\E(X_{0}|X_{1},\dots,X_{n-1}),X_{n}-\E(X_{n}|X_{1},\dots X_{n-1})) & = & \cov\left(-\frac{\epsilon_{1}}{a},\epsilon_{n}\right)\\
 & = & 0\,.
\end{eqnarray*}

\end_inset


\end_layout

\end_deeper
\begin_layout Enumerate
\begin_inset ERT
status open

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Enumerate
Nous avons (pour tout 
\begin_inset Formula $t$
\end_inset

)
\begin_inset Formula 
\begin{eqnarray*}
\var(X_{t}) & = & \var(aX_{t-1}+\epsilon_{t}+b\epsilon_{t-1})\\
\sigma(0) & = & a^{2}\sigma(0)+\sigma^{2}+b^{2}\sigma^{2}+2ab\cov(X_{t-1},\epsilon_{t-1})\\
\sigma(0) & = & a^{2}\sigma(0)+\sigma^{2}+b^{2}\sigma^{2}+2ab\cov(aX_{t-2}+\epsilon_{t-1}+\epsilon_{t-2},\epsilon_{t-1})\\
\sigma(0) & = & a^{2}\sigma(0)+(1+b^{2})\sigma^{2}+2ab\sigma^{2}\\
\sigma(0) & = & \frac{(1+b^{2}+2ab)\sigma^{2}}{1-a^{2}}\,.
\end{eqnarray*}

\end_inset

Et aussi
\begin_inset space ~
\end_inset

:
\begin_inset Formula 
\begin{eqnarray*}
\cov(X_{t},X_{t-1}) & = & \cov(aX_{t-1}+\epsilon_{t}+b\epsilon_{t-1},X_{t-1})\\
\sigma(1) & = & a\sigma(0)+b\cov(\epsilon_{t-1},X_{t-1})\\
\sigma(1) & = & a\sigma(0)+b\sigma^{2}\\
\sigma(1) & = & \frac{(a(1+b^{2}+2ab)+b(1-a^{2}))}{1-a^{2}}\sigma^{2}\\
\sigma(1) & = & \frac{(a+b+ab^{2}+a^{2}b)}{1-a^{2}}\sigma^{2}\,.
\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Enumerate
Nous avons 
\begin_inset Formula 
\[
\rho(1)=\frac{\sigma(1)}{\sigma(0)}=\frac{a+b+ab^{2}+a^{2}b}{1+b^{2}+2ab}=\frac{(a+b)(1+ab)}{1+b^{2}+2ab}\,.
\]

\end_inset

La relation de récurence pour les auto-covariances est (pour 
\begin_inset Formula $h\geq1$
\end_inset

)
\begin_inset space ~
\end_inset

:
\begin_inset Formula 
\[
\sigma(h+1)=a\sigma(h)\,.
\]

\end_inset

Donc, pour tout 
\begin_inset Formula $h\geq1$
\end_inset

,
\begin_inset Formula 
\[
\sigma(h)=a^{h-1}\sigma(1)\,,
\]

\end_inset

et donc
\begin_inset Formula 
\[
\rho(h)=a^{h-1}\frac{(a+b)(1+ab)}{1+b^{2}+2ab}\,.
\]

\end_inset


\end_layout

\end_deeper
\begin_layout Section
Feuille d'exercices numéro 5 (durée
\begin_inset space ~
\end_inset

: 6h)
\begin_inset Argument 1
status open

\begin_layout Plain Layout
Feuille d'exercices numéro 5
\end_layout

\end_inset


\end_layout

\begin_layout Subsection*
Préliminaires
\end_layout

\begin_layout Standard
Créer un fichier texte dans lequel vous répondrez clairement aux questions
 ci-dessous, en incluant vos codes 
\family typewriter
R
\family default
, les résultats obtenus sous 
\family typewriter
R
\family default
 (graphique y compris), vos interprétations, remarques ...
 Une fois ce TP fini, vous metterez en forme votre compte-rendu et l'exporterez
 au format pdf.
 
\end_layout

\begin_layout Subsection
Simulation des processus 
\begin_inset Formula $ARMA$
\end_inset


\end_layout

\begin_layout Standard
Penser à représenter chaque processus simulé.
 
\end_layout

\begin_layout Enumerate
Donner la définition d’un processus 
\begin_inset Formula $ARMA_{p,q}$
\end_inset

 .
 Rappeler les conditions sur les coefficients pour que ce processus soit
 stationnaire.
 
\end_layout

\begin_layout Enumerate
À l’aide de la fonction 
\family typewriter
arima.sim
\family default
, simuler plusieurs processus 
\begin_inset Formula $AR_{p}$
\end_inset

 et 
\begin_inset Formula $MA_{q}$
\end_inset

 (
\begin_inset Formula $p$
\end_inset

 et 
\begin_inset Formula $q$
\end_inset

 pas trop grands).
 Avant toute simulation, écrire la définition mathématique du processus
 à simuler et veillez à ce que les conditions de stationnarité soient respectées.
 
\end_layout

\begin_layout Enumerate
Observer les auto-corrélations empiriques (partielles ou non).
 Que constatez-vous ? 
\end_layout

\begin_layout Enumerate
Simuler quelques 
\begin_inset Formula $ARMA_{p,q}$
\end_inset

, observer et interpréter les auto-corrélations empiriques (partielles ou
 non).
 
\end_layout

\begin_layout Enumerate
Faire de même avec un modèle 
\begin_inset Formula $ARIMA_{p,d,q}$
\end_inset

, avec un 
\begin_inset Formula $d$
\end_inset

 assez petit.
\end_layout

\begin_layout Subsection
Identification d'un processus 
\begin_inset Formula $ARMA$
\end_inset


\end_layout

\begin_layout Standard
Récupérer le fichier de données 
\family typewriter
serie1.dat
\family default

\begin_inset Foot
status open

\begin_layout Plain Layout
Toujours à l'adresse : 
\family typewriter
http://math.unice.fr/~rubentha/enseignement/
\end_layout

\end_inset

.
\end_layout

\begin_layout Enumerate
Ce processus vous semble-t-il modélisable par un processus 
\begin_inset Formula $ARMA$
\end_inset

 stationnaire
\begin_inset space ~
\end_inset

? Pourquoi
\begin_inset space ~
\end_inset

? 
\end_layout

\begin_layout Enumerate
Faire un test de Dickey-Fuller sur cette série (au niveau 
\begin_inset Formula $0,01$
\end_inset

).
 Quel est le résultat
\begin_inset space ~
\end_inset

?? Quelle est votre conclusion quand à la stationnarité de la série
\begin_inset space ~
\end_inset

?
\end_layout

\begin_layout Enumerate
On travaille désormais avec la série obtenue en appliquant la fonction 
\family typewriter
diff
\family default
 à la série.
 Quelle transformation a-t-on effectuée ? 
\end_layout

\begin_layout Enumerate
En observant les auto-corrélations empiriques et auto-corrélations partielles
 empiriques, proposer des modèles 
\begin_inset Formula $AR_{p}$
\end_inset

 ou 
\begin_inset Formula $MA_{q}$
\end_inset

 d’ordre faible pour modéliser cette série.
 
\end_layout

\begin_layout Enumerate
Estimer les paramètres du modèle sélectionné.
\end_layout

\begin_layout Enumerate
Tester la blancheur des résidus (on choisira la niveau 
\begin_inset Formula $\alpha=0,02$
\end_inset

).
 
\end_layout

\begin_layout Enumerate
Conclure pour choisir un modèle.
 
\end_layout

\begin_layout Enumerate
Faire des prédictions pour les 12 prochains termes de la série.
 Sur un même graphique, représenter la série, les prédictions, un intervalle
 de confiance à 95% pour les prédictions.
 
\end_layout

\begin_layout Enumerate
S’inspirer de la démarche pour modéliser la série 
\family typewriter
serie2.dat 
\family default
(et faire des prédictions pour les 100 prochains termes).
\end_layout

\begin_layout Subsection
Prévision dans un processus 
\begin_inset Formula $ARMA$
\end_inset


\end_layout

\begin_layout Standard
Soit le processus 
\begin_inset Formula $X_{t}−X_{t−1}+\frac{1}{2}X_{t−2}−\frac{1}{3}X_{t−3}=\epsilon_{t}$
\end_inset

 avec 
\begin_inset Formula $\epsilon_{t}$
\end_inset

 un bruit blanc gaussien centré réduit.
\end_layout

\begin_layout Enumerate
Après avoir identifié ce processus, simuler 
\begin_inset Formula $50$
\end_inset

 réalisations de longueur 
\begin_inset Formula $105$
\end_inset

.
 
\end_layout

\begin_layout Enumerate
Pour chaque simulation, extraire les 
\begin_inset Formula $100$
\end_inset

 premières valeurs et estimer les paramètres d’un 
\begin_inset Formula $AR_{3}$
\end_inset

.
 
\end_layout

\begin_layout Enumerate
Pour chaque simulation, prédire les cinq valeurs suivantes.
 
\end_layout

\begin_layout Enumerate
Donner une estimation de l’erreur moyenne (biais) et de la variance de l’erreur
 de prévision à 
\begin_inset Formula $1$
\end_inset

, 
\begin_inset Formula $2$
\end_inset

, 
\begin_inset Formula $3$
\end_inset

, 
\begin_inset Formula $4$
\end_inset

 et 
\begin_inset Formula $5$
\end_inset

 pas.
 
\end_layout

\begin_layout Enumerate
Recommencer en rallongeant la durée d’observation, et comparer aux résultats
 précédents.
\end_layout

\begin_layout Subsection
Précipitations mensuelles à San Fransisco entre 1932 et 1966
\end_layout

\begin_layout Standard
Récupérer la série 
\family typewriter
sanfran.dat
\family default
.
\end_layout

\begin_layout Enumerate
La série semble-t-elle stationnaire ? Si non faites en sorte qu’elle le
 soit.
\end_layout

\begin_layout Enumerate
Proposer alors un 
\begin_inset Formula $AR_{p}$
\end_inset

 ou un 
\begin_inset Formula $AM_{q}$
\end_inset

 adapté.
 Valider votre modélisation en testant les résidus.
 Mettez votre idée de côté, car nous vous proposons de tester maintenant
 directement sur la série initiale un 
\begin_inset Formula $AR_{2}$
\end_inset

 avec partie saisonnière (autrement dit un 
\begin_inset Formula $SARIMA_{{2,0,0,12}}$
\end_inset

).
 On utilise désormais les données jusqu’à la fin de l’année 1963.
 
\end_layout

\begin_layout Enumerate
Estimer le modèle 
\begin_inset Formula $SARIMA_{{2,0,0,12}}$
\end_inset

.
 Afficher et tester les résidus.
 
\end_layout

\begin_layout Enumerate
Prévoir les précipitations de 1964, 1965 et 1966 à partir de ce modèle.
 Superposer sur un graphique prévision,valeurs réelles et intervalle de
 confiance à 95%.
\end_layout

\begin_layout Enumerate
Faire de même avec le modèle 
\begin_inset Formula $AR_{p}$
\end_inset

 sélectionné à la première question (ainsi qu’avec un lissage exponentiel
 de Holt-Winters, avec et sans composante saisonnière).
 
\end_layout

\begin_layout Enumerate
Quel est, graphiquement, le meilleur modèle pour prédire cette série ? 
\end_layout

\begin_layout Enumerate
Comment aurait-on pu répondre à la question précédente de façon moins subjective
 ? Comparer les résultats à l’analyse graphique.
\end_layout

\begin_layout Subsection
Taux d’intérêt au Royaume-Uni
\end_layout

\begin_layout Standard
Le fichier 
\family typewriter
UKinterestrates.dat
\family default
 contient le spread des taux d’intérêts (différence entre taux d’intérêt
 à long terme et à court terme) pour le Royaume-Uni entre mars 1953 et décembre
 1995.
 En vous inspirant des exercices précédents, proposer une modélisation de
 type 
\begin_inset Formula $ARMA$
\end_inset

, 
\begin_inset Formula $ARIMA$
\end_inset

 ou 
\begin_inset Formula $SARIMA$
\end_inset

.
 Justifier bien votre démarche.
\end_layout

\begin_layout Subsection*
Appendice : mise en 
\begin_inset ERT
status open

\begin_layout Plain Layout

{
\backslash
oe}
\end_layout

\end_inset

uvre sous 
\family typewriter
R
\end_layout

\begin_layout Standard
Auto-corrélation partielle : utiliser la fonction 
\family typewriter
pacf.
\end_layout

\begin_layout Standard
La fonction 
\family typewriter
arima.sim
\family default
(
\family typewriter
modele
\family default
,
\family typewriter
n
\family default
) permet de simuler un processus 
\begin_inset Formula $ARMA_{p,q}$
\end_inset

 défini par 
\begin_inset Formula 
\[
X_{t}−\sum_{k=1}^{p}a_{k}X_{t-k}=\epsilon_{t}+\sum_{j=1}^{q}b_{j}\epsilon_{t-j}.
\]

\end_inset

 Les paramètres 
\begin_inset Formula $a_{k}$
\end_inset

 et 
\begin_inset Formula $b_{j}$
\end_inset

 du processus sont précisés dans le paramètre 
\family typewriter
modele
\family default
 de la fonction : 
\family typewriter
modele<-list(ar=c(a1, .
 .
 .
 , ap),ma=c(b1, .
 .
 .
 , bq))
\family default
 (choisir 
\family typewriter
ma
\family default
 ou 
\family typewriter
ar
\family default
 pour un processus 
\begin_inset Formula $MA$
\end_inset

 ou 
\begin_inset Formula $AR$
\end_inset

, si 
\begin_inset Formula $p=1$
\end_inset

, écrire 
\family typewriter
ar=a1
\family default
).
 Pour simuler un modèle 
\begin_inset Formula $ARIMA_{p,d,q}$
\end_inset

 il faut ajouter le composant 
\family typewriter
order=c(p,d,q)
\family default
 dans le paramètre 
\family typewriter
modele
\family default
 de la fonction 
\family typewriter
arima.sim
\family default
.
 
\end_layout

\begin_layout Standard
La fonction 
\family typewriter
ar
\family default
 permet d’estimer les paramètres d’un processus 
\begin_inset Formula $AR_{p}$
\end_inset

 :
\begin_inset Newline newline
\end_inset

 
\family typewriter
out<-ar(data,aic=TRUE,order.max=NULL).
\end_layout

\begin_layout Standard
L’ordre 
\begin_inset Formula $p$
\end_inset

 du processus auto-régressif est choisi (inférieur à 
\family typewriter
order.max
\family default
) à l’aide du critère AIC (si l’option aic est validée).
 La fonction 
\family typewriter
arima
\family default
 permet d’estimer les paramètres : 
\end_layout

\begin_layout Itemize
d’un 
\begin_inset Formula $ARMA_{p,q}$
\end_inset

 : 
\family typewriter
out<-arima(serie,order=c(p,0,q))
\family default
 
\end_layout

\begin_layout Itemize
d’un 
\begin_inset Formula $ARIMA_{p,d,q}$
\end_inset

 : 
\family typewriter
out<-arima(serie,order=c(p,d,q))
\family default
 
\end_layout

\begin_layout Itemize
d’un 
\begin_inset Formula $SARIMA_{p,d,q,T}$
\end_inset

 :
\begin_inset Newline newline
\end_inset

 
\family typewriter
out<-arima(serie,order=c(p,d,q),seasonal=list(order=c(P,D,Q),period=T)).
\end_layout

\begin_layout Standard
Les paramètres 
\begin_inset Formula $P,D,Q$
\end_inset

 du modèle 
\begin_inset Formula $SARIMA$
\end_inset

 ne sont pas abordés dans ce cours, nous leur donnerons par défaut la valeur
 des paramètres 
\begin_inset Formula $p,\,d,\,q$
\end_inset

 (pas trop grands).
 Parmi les sorties de cette fonction, on peut obtenir : 
\end_layout

\begin_layout Itemize

\family typewriter
out$coef
\family default
 : estimation des coefficients, 
\end_layout

\begin_layout Itemize

\family typewriter
out$aic
\family default
 : valeur du critère AIC, 
\end_layout

\begin_layout Itemize

\family typewriter
out$resid
\family default
 : estimation des résidus.
 
\end_layout

\begin_layout Standard
La fonction
\family typewriter
 p=predict(out,h)
\family default
 permet d’effectuer une prévision à l’horizon 
\begin_inset Formula $h$
\end_inset

.
 Parmi les sorties de cette fonction, 
\family typewriter
p$pred
\family default
 contient les prévisions, et 
\family typewriter
p$s
\family default
e contient l’écart-type de l’erreur de prévision.
 Il n’existe pas de fonction prédéfinie pour calculer un intervalle de confiance.
\end_layout

\begin_layout Standard
\begin_inset External
	template PDFPages
	filename figures/processus_AR_MA.pdf
	extra LaTeX "pages={1-}"

\end_inset

Une fois qu'un processus 
\family typewriter
x 
\family default
est modélisé par un ARIMA(p,d,q), on peut estimer ses coefficients par 
\begin_inset Newline newline
\end_inset


\family typewriter
out<-arima(x,order=c(p,d,q))
\begin_inset Newline newline
\end_inset


\family default
et si c'est un SARIMA(p,d,q,T), on utilise
\begin_inset Newline newline
\end_inset


\family typewriter
seasonal=list(order=c(p,d,q),period=T).
\begin_inset Newline newline
\end_inset


\family default
La prédiction (k pas en avant) se fait avec l'instruction
\begin_inset space ~
\end_inset

: 
\family typewriter
outpred<-predict(out,n.ahead=k,sefit=TRUE)
\begin_inset Newline newline
\end_inset


\family default
On récupère les valeurs prédites dans : 
\family typewriter
outpred$pred
\family default
, et les écart-types des valeurs prédites dans 
\family typewriter
out$se.
\end_layout

\begin_layout Chapter
Analyse spectrale
\end_layout

\begin_layout Standard
On cherche à décrire une série stationnaire comme un mélange de fonctions
 périodiques (plus du bruit).
\end_layout

\begin_layout Example
\begin_inset Formula 
\[
Y_{t}=\mu+\sum_{j=1}^{p}[\alpha_{j}\cos(\omega_{j}t)+\beta_{j}\sin(\omega_{j}t)]+\epsilon_{t}
\]

\end_inset

Ici les 
\begin_inset Formula $\omega_{j}$
\end_inset

 sont des fréquences.
 La période de 
\begin_inset Formula $t\mapsto\cos(\omega_{j}t)$
\end_inset

 est 
\begin_inset Formula $2\pi/\omega_{j}$
\end_inset

, pour tout 
\begin_inset Formula $j$
\end_inset

.
\end_layout

\begin_layout Section
Densité spectrale
\end_layout

\begin_layout Standard
On suppose que 
\begin_inset Formula $(X_{t})_{t\geq0}$
\end_inset

 est un processus stationnaire centré de covariances 
\begin_inset Formula $(\sigma(h))_{h\geq0}$
\end_inset

 , avec 
\begin_inset Formula 
\begin{equation}
\sum_{h=-\infty}^{+\infty}|\sigma(h)|<+\infty\,.\label{eq:sigma-L1}
\end{equation}

\end_inset


\end_layout

\begin_layout Definition
La densité spectrale
\begin_inset Index idx
status open

\begin_layout Plain Layout
Densité spectrale
\end_layout

\end_inset

 de 
\begin_inset Formula $(X_{t})$
\end_inset

 est la fonction 
\begin_inset Formula 
\[
\lambda\in\R\mapsto f(\lambda)=\frac{1}{2\pi}\sum_{h=-\infty}^{+\infty}e^{-ih\lambda}\sigma(h)
\]

\end_inset

(rappel
\begin_inset space ~
\end_inset

: 
\begin_inset Formula $e^{i\lambda}=\cos(\lambda)+i\sin(\lambda)$
\end_inset

, 
\begin_inset Formula $i^{2}=-1$
\end_inset

).
\end_layout

\begin_layout Standard
La fonction 
\begin_inset Formula $f$
\end_inset

 est bien définie à cause de l'équation (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:sigma-L1"

\end_inset

).
\end_layout

\begin_layout Proposition
La fonction 
\begin_inset Formula $f$
\end_inset

 vérifie
\begin_inset space ~
\end_inset

:
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Enumerate
\begin_inset Formula $f$
\end_inset

 est paire,
\end_layout

\begin_layout Enumerate
\begin_inset Formula $f$
\end_inset

 est 
\begin_inset Formula $2\pi$
\end_inset

-périodique,
\end_layout

\begin_layout Enumerate
pour tout 
\begin_inset Formula $\lambda\in\R$
\end_inset

, 
\begin_inset Formula $f(\lambda)\in\R^{+}$
\end_inset

,
\end_layout

\begin_layout Enumerate
pour tout 
\begin_inset Formula $k$
\end_inset

 dans 
\begin_inset Formula $\Z$
\end_inset

, 
\begin_inset Formula $\sigma(k)=\int_{-\pi}^{\pi}e^{i\lambda k}f(\lambda)d\lambda=\int_{-\pi}^{\pi}\cos(\lambda k)f(\lambda)d\lambda$
\end_inset

.
\end_layout

\end_deeper
\begin_layout Proof
\begin_inset ERT
status open

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Enumerate
Pour tout 
\begin_inset Formula $\lambda$
\end_inset

, 
\begin_inset Formula 
\begin{eqnarray*}
f(-\lambda) & = & \frac{1}{2\pi}\sum_{h=-\infty}^{+\infty}e^{i\lambda h}\sigma(h)\\
\mbox{(}\sigma\mbox{ est paire)} & = & \frac{1}{2\pi}\sum_{h=-\infty}^{+\infty}e^{i\lambda h}\sigma(-h)\\
\mbox{(changement }h\mbox{ en }-h\mbox{)} & = & \frac{1}{2\pi}\sum_{h=-\infty}^{+\infty}e^{-i\lambda h}\sigma(h)\,.
\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Enumerate
Pour tout 
\begin_inset Formula $h\in\Z$
\end_inset

, 
\begin_inset Formula $h\mapsto e^{-i\lambda h}$
\end_inset

 est 
\begin_inset Formula $2\pi$
\end_inset

-périodique donc 
\begin_inset Formula $f$
\end_inset

 est 
\begin_inset Formula $2\pi$
\end_inset

-périodique.
 
\end_layout

\begin_layout Enumerate
Pour 
\begin_inset Formula $h$
\end_inset

 dans 
\begin_inset Formula $\N^{*}$
\end_inset

, on rassemble les termes 
\begin_inset Formula $h$
\end_inset

 et 
\begin_inset Formula $-h$
\end_inset

, nous avons donc, pour tout 
\begin_inset Formula $\lambda\in\R$
\end_inset

, 
\begin_inset Formula 
\begin{eqnarray}
2\pi f(\lambda) & = & \sigma(0)+\sum_{h\geq1}\sigma(h)e^{-i\lambda h}+\sigma(-h)e^{i\lambda h}\nonumber \\
 & = & \sigma(0)+\sum_{h\geq1}\sigma(h)(e^{-i\lambda h}+e^{i\lambda h})\nonumber \\
 & = & \sigma(0)+\sum_{h\geq1}\sigma(h)\times2\cos(\lambda h)\,.\label{eq:formule-avec-cos}
\end{eqnarray}

\end_inset


\end_layout

\begin_layout Enumerate
Nous avons, pour tout 
\begin_inset Formula $k$
\end_inset

,
\begin_inset Formula 
\begin{eqnarray*}
\int_{-\pi}^{\pi}\left|e^{ikh}f(\lambda)\right|d\lambda & = & \int_{-\pi}^{\pi}|f(\lambda)|d\lambda\\
 & = & \int_{-\pi}^{\pi}\left|\sum_{h\in\Z}e^{-i\lambda h}\sigma(h)\right|d\lambda\\
 & \leq & \int_{-\pi}^{\pi}\sum_{h\in\Z}|\sigma(h)|d\lambda\\
 & = & 2\pi\sum_{h\in\Z}|\sigma(h)|\\
 & < & \infty\,.
\end{eqnarray*}

\end_inset

Donc le théorème de Fubini-Tonelli (cours de L3), nous dit que
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
prefix "r"
symbol "$\\mathfrak{R}$"
description "Partie r\\'eelle"
literal "true"

\end_inset


\begin_inset Formula 
\begin{equation}
\int_{-\pi}^{\pi}e^{i\lambda k}f(\lambda)d\lambda=\frac{1}{2\pi}\sum_{h\in\Z}\int_{-\pi}^{\pi}e^{i\lambda k}e^{-i\lambda h}\sigma(h)d\lambda\,.\label{eq:fub-01}
\end{equation}

\end_inset

Or, pour tout 
\begin_inset Formula $k\in\Z^{*}$
\end_inset

,
\begin_inset Formula 
\[
\int_{-\pi}^{\pi}e^{i\lambda k}d\lambda=\left[\frac{e^{i\lambda k}}{ik}\right]_{-\pi}^{\pi}=0
\]

\end_inset

car 
\begin_inset Formula $\lambda\mapsto e^{i\lambda k}$
\end_inset

 est 
\begin_inset Formula $2\pi$
\end_inset

-périodique.
 Et pour 
\begin_inset Formula $k=0$
\end_inset

,
\begin_inset Formula 
\[
\int_{-\pi}^{\pi}e^{0}d\lambda=2\pi\,.
\]

\end_inset

Donc
\begin_inset Formula 
\[
\int_{-\pi}^{\pi}e^{i\lambda k}f(\lambda)d\lambda=\sigma(k)\,.
\]

\end_inset

D'où, pour tout 
\begin_inset Formula $k$
\end_inset

, en prenant la partie réelle,
\begin_inset Formula 
\begin{eqnarray*}
\mathfrak{R}(\sigma(k)) & = & \mathfrak{R}\left(\int_{-\pi}^{\pi}e^{i\lambda k}f(\lambda)d\lambda\right)\\
 & = & \int_{-\pi}^{\pi}\mathfrak{R}(e^{i\lambda k})f(\lambda)d\lambda\\
 & = & \int_{-\pi}^{\pi}\cos(\lambda k)f(\lambda)d\lambda\,.
\end{eqnarray*}

\end_inset


\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Proposition
Une fonction 
\begin_inset Formula $f\,:\,]-\pi;\pi]\rightarrow\R$
\end_inset

 est la 
\begin_inset Index idx
status open

\begin_layout Plain Layout
Densité spectrale
\end_layout

\end_inset

densité spectrale d'un processus stationnaire si et seulement si
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Enumerate
\begin_inset Formula $f$
\end_inset

 est paire,
\end_layout

\begin_layout Enumerate
\begin_inset Formula $f$
\end_inset

 est à valeurs dans 
\begin_inset Formula $\R^{+}$
\end_inset

,
\end_layout

\begin_layout Enumerate
\begin_inset Formula $\int_{-\pi}^{\pi}f(\lambda)d\lambda<\infty$
\end_inset

.
\end_layout

\end_deeper
\begin_layout Example
Soit 
\begin_inset Formula $X_{t}=\omega_{t}$
\end_inset

, les 
\begin_inset Formula $\omega_{t}$
\end_inset

 étant i.i.d., centrés, de variance 
\begin_inset Formula $\sigma^{2}$
\end_inset

 (
\begin_inset Formula $(X_{t})$
\end_inset

 est alors un bruit blanc).
 La fonction de covariance de 
\begin_inset Formula $(X_{t})$
\end_inset

 est alors
\begin_inset Formula 
\[
\sigma(h)=\begin{cases}
\sigma^{2} & \mbox{ si }h=0,\\
0 & \mbox{sinon.}
\end{cases}
\]

\end_inset

D'où la densité spectrale
\begin_inset space ~
\end_inset

: 
\begin_inset Formula $f(\lambda)=\frac{\sigma^{2}}{2\pi}$
\end_inset

 pour tout 
\begin_inset Formula $\lambda$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Example
On prend un processus 
\begin_inset Formula $AR(1)$
\end_inset

 (stationnaire)
\begin_inset space ~
\end_inset

: 
\begin_inset Formula $X_{t}=\phi X_{t-1}+Z_{t}$
\end_inset

 (
\begin_inset Formula $(Z_{t})$
\end_inset

 bruit blanc de variance 
\begin_inset Formula $\sigma^{2}$
\end_inset

, 
\begin_inset Formula $\phi\in]0;1[$
\end_inset

).
 Nous avons vu en exercice que la fonction d'auto-covariance est 
\begin_inset Formula 
\[
\sigma(h)=\frac{\sigma^{2}}{1-\phi^{2}}\times\phi^{h}\,,\,\mbox{pour tout }h\geq0.
\]

\end_inset

Nous calculons alors la densité spectrale (en utilisant la parité de 
\begin_inset Formula $\sigma$
\end_inset

)
\begin_inset space ~
\end_inset

:
\begin_inset Formula 
\begin{eqnarray*}
f(\lambda) & = & \frac{1}{2\pi}\sum_{h=-\infty}^{+\infty}e^{-i\lambda h}\phi^{|h|}\sigma(0)\\
 & = & \frac{\sigma(0)}{2\pi}\left[1+\sum_{h\geq1}\phi^{h}e^{-i\lambda h}+\sum_{h\geq1}\phi^{h}e^{i\lambda h}\right]\\
 & = & \frac{\sigma(0)}{2\pi}\left[1+\frac{\phi e^{-i\lambda}}{1-\phi e^{-i\lambda}}+\frac{\phi e^{i\lambda}}{1-\phi e^{i\lambda}}\right]\\
 & = & \frac{\sigma(0)}{2\pi}\times\frac{(1-\phi e^{-i\lambda})(1-\phi e^{i\lambda})+\phi e^{-i\lambda}(1-\phi e^{i\lambda})+\phi e^{i\lambda}(1-\phi e^{-i\lambda})}{(1-\phi e^{-i\lambda})(1-\phi e^{i\lambda})}\\
 & = & \frac{\sigma(0)}{2\pi}\times\frac{1+\phi^{2}-2\phi\cos(\lambda)+2\phi\cos(\lambda)-2\phi^{2}}{1+\phi^{2}-2\phi\cos(\lambda)}\\
 & = & \frac{\sigma^{2}}{2\pi}\times\frac{1-\phi^{2}}{1+\phi^{2}-2\phi\cos(\lambda)}\,.
\end{eqnarray*}

\end_inset

Voir le graphique de 
\begin_inset Formula $f$
\end_inset

 dans la figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Densité-spectrale-01"

\end_inset

.
\begin_inset Float figure
placement h
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/densite-spectrale-01.eps
	scale 50

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Densité spectrale
\begin_inset CommandInset label
LatexCommand label
name "fig:Densité-spectrale-01"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Section
Le périodogramme
\end_layout

\begin_layout Definition
Le périodogramme
\begin_inset Index idx
status open

\begin_layout Plain Layout
Périodogramme
\end_layout

\end_inset

 de la série temporelle 
\begin_inset Formula $(x_{1},x_{2},\dots,x_{n})$
\end_inset

 est la fonction
\begin_inset Formula 
\[
I_{n}\,:\,\lambda\in\R\mapsto\frac{1}{n}\left|\sum_{t=1}^{n}x_{t}e^{-i\lambda t}\right|^{2}\,.
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Definition
La transformée de Fourier discrète de la série temporelle 
\begin_inset Formula $(x_{1},x_{2},\dots,x_{n})$
\end_inset

 est la fonction
\begin_inset Formula 
\[
\begin{array}{cccc}
d\,: & \{\omega_{j}=\frac{j}{n}\,,\,0\leq j\leq n-1\} & \longrightarrow & \R\\
 & w_{j} & \longmapsto & d(\omega_{j})=\frac{1}{\sqrt{n}}\sum_{t=1}^{n}x_{t}e^{-2i\pi\omega_{j}t}\,.
\end{array}
\]

\end_inset

Les 
\begin_inset Formula $\omega_{j}$
\end_inset

 (
\begin_inset Formula $0\leq j\leq n-1$
\end_inset

) sont appelés les fréquences
\begin_inset Index idx
status open

\begin_layout Plain Layout
Fréquences fondamentales de Fourier
\end_layout

\end_inset

 fondamentales de Fourier.
 
\end_layout

\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Proposition
Le périodogramme est 
\begin_inset Formula $2\pi$
\end_inset

-périodique et pair (donc aussi symétrique par rapport à 
\begin_inset Formula $\pi$
\end_inset

).
 Il présente des maxima en les fréquences du processus (si on imagine que
 le processus contient un mélange de fonctions périodiques).
\end_layout

\begin_layout Remark
Attention, 
\family typewriter
R
\family default
 trace (parfois) 
\begin_inset Formula $I_{n}(\lambda/2\pi)$
\end_inset

 au lieu de 
\begin_inset Formula $I_{n}$
\end_inset

 (on s'en rend compte en regardant les graduations en abscisse).
\end_layout

\begin_layout Standard
Posons 
\begin_inset Formula 
\[
\widehat{f}(\lambda)=\frac{1}{2\pi}\sum_{|j|\leq m_{n}}W_{n}(j)I_{n}\left(g(n,j)+\frac{2\pi j}{n}\right)
\]

\end_inset

avec 
\begin_inset Formula 
\[
m_{n}\convn+\infty\,,\,\frac{m_{n}}{n}\convn0\,,
\]

\end_inset


\begin_inset Formula 
\[
W_{n}(j)\geq0\mbox{ et }\mbox{\ensuremath{W_{n}(j)=W_{n}(-j)}pour tout }j\,,
\]

\end_inset


\begin_inset Formula 
\[
\sum_{|j|\leq m_{n}}W_{n}(j)=1\mbox{ et }\sum_{|j|\leq m_{n}}W_{n}(j)^{2}\convn0\,,
\]

\end_inset


\begin_inset Formula 
\[
g(n,\lambda)=\argmin_{j}\left|\frac{2\pi j}{n}-\lambda\right|\,.
\]

\end_inset


\end_layout

\begin_layout Proposition
Pour tout 
\begin_inset Formula $\lambda$
\end_inset

, 
\begin_inset Formula 
\[
\widehat{f}(\lambda)\convn f(\lambda)\,.
\]

\end_inset


\end_layout

\begin_layout Standard
On pourrait montrer , au prix de quelques calculs, que 
\begin_inset Formula $I_{n}(\lambda)\convn f(\lambda)$
\end_inset

.
 La convolution par un noyau 
\begin_inset Formula $W_{n}(.)$
\end_inset

 a pour effet de lisser l'estimateur (le dessin est donc plus joli).
\end_layout

\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Example
Le 
\begin_inset Formula $\widehat{f}$
\end_inset

 ci-dessus est un estimateur de 
\begin_inset Formula $f$
\end_inset

 dit 
\begin_inset Quotes cld
\end_inset

estimateur à noyau
\begin_inset Quotes crd
\end_inset

.
 Un choix possible de 
\begin_inset Formula $m_{n}$
\end_inset

 est le suivant
\begin_inset space ~
\end_inset

: 
\begin_inset Formula $m_{n}=\lfloor\sqrt{n}\rfloor$
\end_inset

.
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
prefix "zz"
symbol "$\\lfloor \\dots \\rfloor$"
description "Partie entière (inférieure)\\\\"
literal "true"

\end_inset

 Et on peut prendre
\begin_inset space ~
\end_inset

:
\begin_inset Formula 
\[
W_{n}(j)=\frac{1}{|j|}\times\frac{1}{\sum_{|i|\leq m_{n}}(1/|i|)}\,.
\]

\end_inset

Nous avons bien
\begin_inset Formula 
\[
\sum_{|j|\leq m_{n}}W_{n}(j)=1
\]

\end_inset

et 
\begin_inset Formula 
\[
\sum_{|j|\leq m_{n}}W_{n}(j)^{2}=\left(\sum_{|j|\leq m_{n}}\frac{1}{|j|^{2}}\right)\times\frac{1}{\left(\sum_{|j|\leq m_{n}}\frac{1}{|j|}\right)^{2}}\,.
\]

\end_inset

Or, 
\begin_inset Formula $\sum_{j\in\Z}1/|j|^{2}<\infty$
\end_inset

 et 
\begin_inset Formula $\sum_{j\in\Z}1/|j|=+\infty$
\end_inset

 donc 
\begin_inset Formula 
\[
\sum_{|j|\leq m_{n}}W_{n}(j)^{2}\convn0\,.
\]

\end_inset


\end_layout

\begin_layout Section
Récupération des composantes périodiques
\end_layout

\begin_layout Standard
On a déjà vu que la périodicité de 
\begin_inset Formula $(X_{t})$
\end_inset

 se retrouve dans 
\begin_inset Formula $\sigma(\dots)$
\end_inset

.
 On admet que si 
\begin_inset Formula $(X_{t})$
\end_inset

 a plusieurs composantes périodiques alors 
\begin_inset Formula $\sigma(\dots)$
\end_inset

 a les mêmes composantes périodiques.
 
\end_layout

\begin_layout Example
On suppose 
\begin_inset Formula $\sigma(h)=\phi^{|h|}\cos(\omega h)$
\end_inset

, pour tout 
\begin_inset Formula $h\in\Z$
\end_inset

 (
\begin_inset Formula $\phi\in]0;1[$
\end_inset

), Calculons
\begin_inset space ~
\end_inset

:
\begin_inset Formula 
\begin{eqnarray*}
f(\lambda) & = & \frac{1}{2\pi}\sum_{h=-\infty}^{+\infty}e^{-i\lambda h}\sigma(h)\\
 & = & \frac{1}{2\pi}+\frac{1}{2\pi}\sum_{h\geq1}(e^{-i\lambda h}+e^{i\lambda h})\phi^{h}\cos(\omega h)\\
 &  & \mbox{(car }\cos\mbox{ est paire)}\\
 & = & \frac{1}{2\pi}+\frac{1}{2\pi}\sum_{h\geq1}(e^{-i\lambda h}+e^{i\lambda h})\phi^{h}\frac{(e^{i\omega h}+e^{-i\omega h})}{2}\\
 & = & \frac{1}{2\pi}+\frac{1}{2\pi}\sum_{h\geq1}\frac{\phi^{h}}{2}(e^{ih(\lambda+\omega)}+e^{ih(\lambda-\omega)}+e^{ih(-\lambda+\omega)}+e^{ih(-\lambda-\omega)})\\
 & = & \frac{1}{2\pi}+\frac{1}{4\pi}\left(\frac{\phi e^{i(\lambda+\omega)}}{1-\phi e^{i(\lambda+\omega)}}+\frac{\phi e^{i(\lambda-\omega)}}{1-\phi e^{i(\lambda-\omega)}}+\frac{\phi e^{i(-\lambda+\omega)}}{1-\phi e^{i(-\lambda+\omega)}}+\frac{\phi e^{i(-\lambda-\omega)}}{1-\phi e^{i(-\lambda-\omega)}}\right)\\
 & = & \frac{1}{2\pi}+\frac{1}{4\pi}\left(\frac{\phi e^{i(\lambda+\omega)}(1-\phi e^{i(-\lambda-\omega)})+\phi e^{i(-\lambda-\omega)}(1-\phi e^{i(\lambda+\omega)})}{(1-\phi e^{i(\lambda+\omega)})(1-\phi e^{i(-\lambda-\omega)})}\right.\\
 &  & \,\,\,\,\,\,\,\,\,\,\,\left.+\frac{\phi e^{i(\lambda-\omega)}(1-\phi e^{i(-\lambda+\omega)})+\phi e^{i(-\lambda+\omega)}(1-\phi e^{i(\lambda-\omega)})}{(1-\phi e^{i(-\lambda+\omega)})(1-\phi e^{i(\lambda-\omega)})}\right)\\
 & = & \frac{1}{2\pi}+\frac{1}{4\pi}\left(\frac{2\phi\cos(\lambda+\omega)-2\phi^{2}}{1+\phi^{2}-2\phi\cos(\lambda+\omega)}+\frac{2\phi\cos(\lambda-\omega)-2\phi^{2}}{1+\phi^{2}-2\phi\cos(\lambda-\omega)}\right)\\
 & = & \frac{1}{2\pi}\left(\frac{1-\phi\cos(\lambda+\omega)}{1+\phi^{2}-2\phi\cos(\lambda+\omega)}+\frac{1-\phi\cos(\lambda-\omega)}{1+\phi^{2}-2\phi\cos(\lambda-\omega)}\right)\,.
\end{eqnarray*}

\end_inset

La fonction
\begin_inset Formula 
\[
\lambda\in\R\mapsto\frac{1-\phi\cos(\lambda+\omega)}{1+\phi^{2}-2\phi\cos(\lambda+\omega)}
\]

\end_inset

est 
\begin_inset Formula $2\pi$
\end_inset

-périodique et a un maximum en 
\begin_inset Formula $-\omega$
\end_inset

.
 La fonction
\begin_inset Formula 
\[
\lambda\in\R\mapsto\frac{1-\phi\cos(\lambda-\omega)}{1+\phi^{2}-2\phi\cos(\lambda-\omega)}
\]

\end_inset

est 
\begin_inset Formula $2\pi$
\end_inset

-périodique et a un maximum en 
\begin_inset Formula $\omega$
\end_inset

.
 Voir la figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:densite-spectrale-02"

\end_inset

 pour le graphe de 
\begin_inset Formula $f$
\end_inset

 (avec 
\begin_inset Formula $\phi=0,7$
\end_inset

 et 
\begin_inset Formula $\omega=0,5$
\end_inset

).
 
\begin_inset Float figure
placement h
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/densite-spectrale-02.eps
	scale 50

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Densité spectrale
\begin_inset CommandInset label
LatexCommand label
name "fig:densite-spectrale-02"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset

La fonction 
\begin_inset Formula $f$
\end_inset

 présente des maxima en 
\begin_inset Formula $\omega$
\end_inset

 et 
\begin_inset Formula $-\omega$
\end_inset

 sur 
\begin_inset Formula $[-\pi;\pi].$
\end_inset

 Attention, seuls les maxima sur 
\begin_inset Formula $[0;\pi]$
\end_inset

 sont à prendre en compte.
 Nous voyons ici que le maximum en 
\begin_inset Formula $\omega$
\end_inset

 reflète bien le fait que 
\begin_inset Formula $\sigma(\dots)$
\end_inset

 a une composante de fréquence 
\begin_inset Formula $\omega$
\end_inset

.
 Si 
\begin_inset Formula $(X_{t})$
\end_inset

 est un processus de fonction de covariance 
\begin_inset Formula $\sigma(\dots)$
\end_inset

, on déduit du graphique de 
\begin_inset Formula $f$
\end_inset

 que 
\begin_inset Formula $(X_{t})$
\end_inset

 a une composante périodique de fréquence 
\begin_inset Formula $\omega$
\end_inset

, et donc de période 
\begin_inset Formula $2\pi/\omega$
\end_inset

.
\end_layout

\begin_layout Example
Pour un processus qui n'a qu'une composante périodique, nous aurions pu
 détecter cette composante en regardant 
\begin_inset Formula $\sigma(\dots)$
\end_inset

 (voir remarque 
\begin_inset CommandInset ref
LatexCommand ref
reference "rem:analyse-sigma"

\end_inset

).
 Nous verrons en exercice des cas où l'analyse spectrale permet de détecter
 plusieurs composantes périodiques.
 
\end_layout

\begin_layout Section
Feuille d'exercices numéro 6 (durée
\begin_inset space ~
\end_inset

: 3h) 
\begin_inset Argument 1
status open

\begin_layout Plain Layout
Feuille d'exercices no 6
\end_layout

\end_inset


\end_layout

\begin_layout Subsection*
Préliminaires
\end_layout

\begin_layout Standard
Créer un fichier texte dans lequel vous répondrez clairement aux questions
 ci-dessous, en incluant vos codes 
\family typewriter
R
\family default
, les résultats obtenus sous 
\family typewriter
R
\family default
 (graphique y compris), vos interprétations, remarques ...
 Une fois ce TP fini, vous metterez en forme votre compte-rendu et l'exporterez
 au format pdf.
 
\end_layout

\begin_layout Subsection
Données simulées
\end_layout

\begin_layout Enumerate
Soient les fonctions (de 
\begin_inset Formula $\Z$
\end_inset

 dans 
\begin_inset Formula $\Z$
\end_inset

) 
\begin_inset Formula $x_{1}(t)=2\cos(2\pi\times t\times5/100)$
\end_inset

, 
\begin_inset Formula $x_{2}(t)=2\cos(2\pi\times t\times10/100)$
\end_inset

, 
\begin_inset Formula $x_{3}(t)=2\cos(2\pi\times t\times20/100)$
\end_inset

, 
\begin_inset Formula $x(t)=x_{1}(t)+x_{2}(t)+x_{3}(t)$
\end_inset

.
 Tracer les graphes de 
\begin_inset Formula $x_{1}$
\end_inset

, 
\begin_inset Formula $x_{2}$
\end_inset

, 
\begin_inset Formula $x_{3}$
\end_inset

, 
\begin_inset Formula $x$
\end_inset

 pour 
\begin_inset Formula $t$
\end_inset

 dans 
\begin_inset Formula $\{1,2,\dots,100\}$
\end_inset

.
  On range les ordonnées du tracé de 
\begin_inset Formula $x$
\end_inset

 dans une série temporelle 
\family typewriter
x
\family default
.
\end_layout

\begin_layout Enumerate
Tracer le périodogramme de 
\family typewriter
x
\family default
.
\end_layout

\begin_layout Enumerate
Tracer une estimée de la densité spectrale de 
\family typewriter
x
\family default
.
 Bien noter la différence d'échelle en abscisse entre le tracé de la densité
 spectrale et celui du périodogramme.
\end_layout

\begin_layout Enumerate
Au vu des graphiques, quelles sont les composantes périodiques de 
\family typewriter
x 
\family default
(attention à ne pas se laisser tromper par l'échelle en abscisse)
\begin_inset space ~
\end_inset

?
\end_layout

\begin_layout Enumerate
Tracer une série 
\family typewriter
y
\family default
 de type 
\begin_inset Formula $AR_{3}$
\end_inset

 avec 
\begin_inset Formula $a_{1}=0$
\end_inset

, 
\begin_inset Formula $a_{2}=-0,5$
\end_inset

, 
\begin_inset Formula $a_{3}=0.2$
\end_inset

.
 
\end_layout

\begin_layout Enumerate
Tracer une estimée de la densité spectrale de 
\family typewriter
y
\family default
.
\end_layout

\begin_layout Enumerate
Au vu du graphique, quelles sont les composantes périodiques de 
\family typewriter
y 
\family default
(attention à ne pas se laisser tromper par l'échelle en abscisse)
\begin_inset space ~
\end_inset

?
\end_layout

\begin_layout Subsection
Données réelles
\end_layout

\begin_layout Enumerate
La série temporelle 
\family typewriter
sunspot.year
\family default
 (contenue dans 
\family typewriter
R
\family default
) contient le nombre moyen de taches solaires observées par mois (on fait
 à chaque fois la moyenne sur une année).
 Tracer la densité spectrale de cette série.
\end_layout

\begin_layout Enumerate
Au vu du graphique, quelles sont les composantes périodiques de 
\family typewriter
sunspot.year 
\family default
(attention à ne pas se laisser tromper par l'échelle en abscisse)
\begin_inset space ~
\end_inset

?
\end_layout

\begin_layout Enumerate
Récupérer le fichier 
\family typewriter
soi.clean.dat
\begin_inset Foot
status open

\begin_layout Plain Layout

\family typewriter
http://math.unice.fr/~rubentha/enseignement/soi.clean.dat
\end_layout

\end_inset

.
 
\family default
Il contient les différences de pression mensuelles entre Tahiti et Darwin
 dans lesquelles les oscillations annuelles ont déjà été gommées.
 Cette série est un indicateur des événements 
\begin_inset Quotes cld
\end_inset

El Ni
\begin_inset ERT
status open

\begin_layout Plain Layout

{
\backslash
~n}
\end_layout

\end_inset

o
\begin_inset Quotes crd
\end_inset

.
 Tracer la densité spectrale de cette série (que l'on appelera 
\family typewriter
x
\family default
).
 Tracer sur le même graphique la ou les ligne(s) verticale(s) correspondant
 aux périodes entières.
\end_layout

\begin_layout Enumerate
Au vu du graphique, quelles sont les composantes périodiques de 
\family typewriter
x 
\family default
(attention à ne pas se laisser tromper par l'échelle en abscisse)
\begin_inset space ~
\end_inset

?
\end_layout

\begin_layout Subsection*
Appendice : mise en 
\begin_inset ERT
status open

\begin_layout Plain Layout

{
\backslash
oe}
\end_layout

\end_inset

uvre sous 
\family typewriter
R
\end_layout

\begin_layout Standard
Pour tracer une fonction : remplir un vecteur avec les abscisses des points
 que l'on veut tracer (exemple
\begin_inset space ~
\end_inset

: 
\family typewriter
t=(1:100)/(2*pi)), 
\family default
remplir un vecteur avec les ordonnées des points que l'on veut tracer (exemple
 : 
\family typewriter
x=cos(t)
\family default
), puis utiliser la commande 
\family typewriter
plot.ts
\family default
 (exemple
\begin_inset space ~
\end_inset

: 
\family typewriter

\begin_inset Newline newline
\end_inset

plot.ts(x,ylim=c(-2,2),main=expression(exemple))
\family default
, l'option 
\family typewriter
ylim
\family default
 permet de fixer les bords du cadre en ordonnée, l'option 
\family typewriter
main(...)
\family default
 permet d'écrire un titre).
\end_layout

\begin_layout Standard
Pour tracer le périodogramme d'une série 
\family typewriter
x
\family default
 de 
\family typewriter
n
\family default
 points : 
\family typewriter
P=abs(fft(x)/n)^2;
\begin_inset Newline newline
\end_inset

 Fr=(0:(n-1))*2*pi/n;, plot(Fr,P,type='o',xlab='fréquence',ylab='périodogramme')
 
\family default
(les options 
\family typewriter
xlab, ylab
\family default
 permettent d'écrire des légendes sur les axes).
\end_layout

\begin_layout Standard
Pour tracer une estimée de la densité spectrale d'une série 
\family typewriter
x 
\family default
: choisir des poids 
\begin_inset Formula $W_{n}(.)$
\end_inset

 comme dans le cours (rentrer l'instruction 
\family typewriter
k=kernel("daniell",4)
\family default
), puis tracer la densité spectrale avec l'instruction 
\family typewriter
spec.pgram(x,k,taper=0,log='no').
\end_layout

\begin_layout Subsection
Exercices sur table 
\end_layout

\begin_layout Enumerate
\begin_inset ERT
status open

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Enumerate
Soit 
\begin_inset Formula $(X_{t})$
\end_inset

 un processus 
\begin_inset Formula $AR(1)$
\end_inset


\begin_inset space ~
\end_inset

: 
\begin_inset Formula $X_{t}=\phi X_{t-1}+Z_{t}$
\end_inset

 avec 
\begin_inset Formula $\phi=0,99$
\end_inset

, 
\begin_inset Formula $(Z_{t})$
\end_inset

 un bruit blanc centré de variance 
\begin_inset Formula $1$
\end_inset

.
 Calculer les covariances de 
\begin_inset Formula $(X_{t})$
\end_inset

.
\end_layout

\begin_layout Enumerate
Calculer la densité spectrale de 
\begin_inset Formula $(X_{t})$
\end_inset

.
\end_layout

\begin_layout Enumerate
Soit 
\begin_inset Formula $Y_{t}=\frac{1}{3}(X_{t-1}+X_{t}+X_{t+1})$
\end_inset

.
 Calculer les covariances de 
\begin_inset Formula $(Y_{t})$
\end_inset

.
\end_layout

\begin_layout Enumerate
Calculer la densité spectrale de 
\begin_inset Formula $(Y_{t})$
\end_inset

.
\end_layout

\end_deeper
\begin_layout Enumerate
Soient 
\begin_inset Formula $(X_{t})$
\end_inset

, 
\begin_inset Formula $(Y_{t})$
\end_inset

 des processus stationnaires centrés indépendants de densités spectrales
 respectivement 
\begin_inset Formula $f_{X}$
\end_inset

, 
\begin_inset Formula $f_{Y}$
\end_inset

.
 Soit 
\begin_inset Formula $Z_{t}=X_{t}+Y_{t}$
\end_inset

.
 Calculer la densité spectrale de 
\begin_inset Formula $Z$
\end_inset

 en fonction de 
\begin_inset Formula $f_{X}$
\end_inset

, 
\begin_inset Formula $f_{Y}$
\end_inset

.
\end_layout

\begin_layout Enumerate
Soit 
\begin_inset Formula $(W_{t})$
\end_inset

 un bruit blanc de variance 
\begin_inset Formula $1$
\end_inset

 (centré).
 Soit 
\begin_inset Formula $X_{t}=W_{t}-\theta W_{t-1}$
\end_inset

 (
\begin_inset Formula $\theta\in\R$
\end_inset

)
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Enumerate
Est-ce que 
\begin_inset Formula $(X_{t})$
\end_inset

 est stationnaire
\begin_inset space ~
\end_inset

? Calculer les covariance de 
\begin_inset Formula $(X_{t})$
\end_inset

.
\end_layout

\begin_layout Enumerate
Calculer la densité spectrale de 
\begin_inset Formula $(X_{t})$
\end_inset

.
\end_layout

\end_deeper
\begin_layout Subsection
Corrigés des exercices sur table
\end_layout

\begin_layout Enumerate
\begin_inset ERT
status open

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Enumerate
Nous avons vu (Chapitre 4, section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Feuille-d-exercices-numero-4"

\end_inset

, exercice 
\begin_inset CommandInset ref
LatexCommand ref
reference "enu:ex-4"

\end_inset

) que pour un tel processus, 
\begin_inset Formula 
\[
\sigma(h)=\frac{\phi^{|h|}}{1-\phi^{2}}\,.
\]

\end_inset


\end_layout

\begin_layout Enumerate
Nous calculons, pour tout 
\begin_inset Formula $\lambda$
\end_inset

 dans 
\begin_inset Formula $\R$
\end_inset

, 
\begin_inset Formula 
\begin{eqnarray*}
f_{X}(\lambda)(1-\phi^{2}) & = & \frac{1}{2\pi}\sum_{h=-\infty}^{+\infty}e^{-ih\lambda}\sigma(h)\times(1-\phi^{2})\\
 & = & \frac{1}{2\pi}\sum_{h=-\infty}^{+\infty}e^{-ih\lambda}\phi^{h}\\
 & = & \frac{1}{2\pi}\left(1+\sum_{h\geq1}\phi^{h}e^{-i\lambda h}+\sum_{h\geq1}\phi^{h}e^{i\lambda h}\right)\\
 & = & \frac{1}{2\pi}\left(1+\frac{\phi e^{-i\lambda}}{1-\phi e^{-i\lambda}}+\frac{\phi e^{i\lambda}}{1-\phi e^{i\lambda}}\right)\\
 & = & \frac{1}{2\pi}\left(1+\frac{\phi e^{-i\lambda}(1-\phi e^{i\lambda})+\phi e^{i\lambda}(1-\phi e^{-i\lambda})}{(1-\phi e^{i\lambda})(1-\phi e^{-i\lambda})}\right)\\
 & = & \frac{1}{2\pi}\left(1+\frac{2\phi\cos(\lambda)-2\phi^{2}}{1+\phi^{2}-2\phi\cos(\lambda)}\right)\\
 & = & \frac{1}{2\pi}\times\frac{1-\phi^{2}}{1+\phi^{2}-2\phi\cos(\lambda)}\,.
\end{eqnarray*}

\end_inset

Donc 
\begin_inset Formula 
\[
f_{X}(\lambda)=\frac{1}{2\pi(1+\phi^{2}-2\phi\cos(\lambda))}\,.
\]

\end_inset


\end_layout

\begin_layout Enumerate
Nous avons, pour tout 
\begin_inset Formula $t$
\end_inset

 et tout 
\begin_inset Formula $h>0$
\end_inset

,
\begin_inset Formula 
\begin{eqnarray*}
\E(Y_{t}Y_{t+h}) & = & \frac{1}{9}\E((X_{t-1}+X_{t}+X_{t+1})(X_{t+h-1}+X_{t+h}+X_{t+h+1}))\\
 & = & \frac{1}{9}(\sigma(h)+\sigma(h+1)+\sigma(h+2)+\sigma(h-1)+\sigma(h)+\sigma(h+1)\\
 &  & \,\,\,\,\,\,\,\,\,+\sigma(h-2)+\sigma(h-1)+\sigma(h))\\
 & = & \frac{1}{9}(\sigma(h-2)+2\sigma(h-1)+3\sigma(h)+2\sigma(h+1)+\sigma(h+2))
\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Enumerate
Nous calculons, pour tout 
\begin_inset Formula $\lambda$
\end_inset

 dans 
\begin_inset Formula $\R$
\end_inset

, 
\begin_inset Formula 
\begin{eqnarray*}
f_{Y}(\lambda) & = & \frac{1}{2\pi}\sum_{h=-\infty}^{+\infty}e^{-i\lambda h}\frac{(\sigma(h-2)+2\sigma(h-1)+3\sigma(h)+2\sigma(h+1)+\sigma(h+2))}{9}\\
 & = & \frac{1}{18\pi(1-\phi^{2})}\sum_{h=-\infty}^{+\infty}\phi^{|h|}\left(e^{-i\lambda(h+2)}+2e^{-i\lambda(h+1)}+3e^{-i\lambda h}+2e^{-i\lambda(h-1)}+e^{-i\lambda(h-2)}\right)\\
 & = & \frac{(e^{-2i\lambda}+2e^{-i\lambda}+3+2e^{i\lambda}+e^{2i\lambda})}{9}f_{X}(\lambda)\\
 & = & \frac{(\cos(2\lambda)+2\cos(\lambda)+3)}{9}\times\frac{1}{2\pi(1+\phi^{2}-2\phi\cos(\lambda))}\,.
\end{eqnarray*}

\end_inset


\end_layout

\end_deeper
\begin_layout Enumerate
Nous calculons les covariances
\begin_inset space ~
\end_inset

(pour tout 
\begin_inset Formula $h$
\end_inset

):
\begin_inset Formula 
\begin{eqnarray*}
\sigma_{Z}(h) & = & \E(Z_{t}Z_{t+h})\\
 & = & \E((X_{t}+Y_{t})(X_{t+h}+Y_{t+h}))\\
 & = & \E(X_{t}X_{t+h})+\E(Y_{t}Y_{t+h})+0\\
 & = & \sigma_{X}(h)+\sigma_{Y}(h)\,.
\end{eqnarray*}

\end_inset

Et donc, pour tout 
\begin_inset Formula $\lambda$
\end_inset

, 
\begin_inset Formula 
\begin{eqnarray*}
f_{Z}(\lambda) & = & \frac{1}{2\pi}\sum_{h=-\infty}^{+\infty}e^{-i\lambda h}(\sigma_{X}(h)+\sigma_{Y}(h))\\
 & = & f_{X}(h)+f_{Y}(h)\,.
\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Enumerate
\begin_inset ERT
status open

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Enumerate
Nous avons pour tout 
\begin_inset Formula $t$
\end_inset

, 
\begin_inset Formula $\E(X_{t})=0$
\end_inset

 et
\begin_inset Formula 
\begin{eqnarray*}
\E(X_{t}^{2}) & = & \E((W_{t}-\theta W_{t-1})^{2})\\
 & = & 1+\theta^{2}\,,
\end{eqnarray*}

\end_inset

 
\begin_inset Formula 
\begin{eqnarray*}
\E(X_{t}X_{t+1}) & = & \E((W_{t}-\theta W_{t-1})(W_{t+1}-\theta W_{t}))\\
 & = & -\theta\,,
\end{eqnarray*}

\end_inset

et pour 
\begin_inset Formula $h\geq2$
\end_inset


\begin_inset Formula 
\[
\E(X_{t}X_{t+h})=0\,.
\]

\end_inset

Donc la fonction de covariance de 
\begin_inset Formula $(X_{t})$
\end_inset

 est telle que
\begin_inset space ~
\end_inset

: 
\begin_inset Formula $\sigma(0)=1+\theta^{2}$
\end_inset

, 
\begin_inset Formula $\sigma(1)=-\theta$
\end_inset

, 
\begin_inset Formula $\sigma(h)=0$
\end_inset

 pour 
\begin_inset Formula $h\geq2$
\end_inset

.
 
\end_layout

\begin_layout Enumerate
Nous calculons, pour tout 
\begin_inset Formula $\lambda$
\end_inset

 dans 
\begin_inset Formula $\R$
\end_inset

, 
\begin_inset Formula 
\[
f(\lambda)=\frac{1}{2\pi}(-2\theta\cos(\lambda)+(1+\theta^{2}))\,.
\]

\end_inset


\end_layout

\end_deeper
\begin_layout Chapter
Processus 
\begin_inset Formula $ARCH$
\end_inset

 et 
\begin_inset Formula $GARCH$
\end_inset


\end_layout

\begin_layout Standard
Dans les modèles précédent, on pouvait se rammener à un processus stationnaire
 (en soustreyant la tendance, la saisonnalité …).
 Il arrive que l'on tombe sur un processus qui semble non stationnaire (par
 exemple, de moyenne ou de variance non constante).
\end_layout

\begin_layout Section
Processus 
\begin_inset Formula $ARCH$
\end_inset


\end_layout

\begin_layout Definition
Un processus 
\begin_inset Formula $ARCH(p)$
\end_inset

 est un processus stationnaire 
\begin_inset Formula $(X_{t})_{t\in\Z}$
\end_inset

 vérifiant une relation de récurrence du type
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
prefix "Loi"
symbol "$\\mathcal{L}$"
description "Loi"
literal "true"

\end_inset

 
\begin_inset Formula 
\[
\left\{ \begin{array}{c}
X_{t}=\epsilon_{t}\mbox{ avec }\mathcal{L}(\epsilon_{t}|X_{t-1}X_{t-2},\dots)=\mathcal{N}(0,\sigma_{t}^{2})\mbox{,}\\
\sigma_{t}^{2}=\alpha_{0}+\alpha_{1}X_{t-1}^{2}+\dots+\alpha_{p}X_{t-p}^{2}\mbox{,}
\end{array}\right.
\]

\end_inset

avec des coefficients 
\begin_inset Formula $\alpha_{0},\dots,\alpha_{p}\geq0$
\end_inset

.
\end_layout

\begin_layout Standard
On peut décrire la simulation de ce processus de manière récursive
\begin_inset space ~
\end_inset

: si on a simulé 
\begin_inset Formula $X_{0},\dots,X_{p-1}$
\end_inset

, on calcule 
\begin_inset Formula $\sigma_{p}$
\end_inset

, on peut alors simuler 
\begin_inset Formula $X_{p}$
\end_inset

.
 On remarque que si 
\begin_inset Formula $X_{t}$
\end_inset

 est très grand alors 
\begin_inset Formula $\sigma_{t+1}$
\end_inset

 est très grande et 
\begin_inset Formula $X_{t+1}$
\end_inset

 a de grandes chances d'être très grand aussi.
\end_layout

\begin_layout Subsection
Rappels de probabilité
\end_layout

\begin_layout Standard
Si 
\begin_inset Formula $(X,Y)$
\end_inset

 est un couple de variables aléatoires de densité 
\begin_inset Formula $f$
\end_inset

 (par exemple dans 
\begin_inset Formula $\R^{2}$
\end_inset

), la densité conditionnelles de 
\begin_inset Formula $X$
\end_inset

 sachant 
\begin_inset Formula $Y=y$
\end_inset

 est définie par
\begin_inset Formula 
\[
f_{X|Y}(x)=\frac{f(x,y)}{f_{Y}(y)}\,,\,\mbox{si }f_{Y}(y)>0\,,
\]

\end_inset

où 
\begin_inset Formula $f_{Y}$
\end_inset

 est la densité de 
\begin_inset Formula $Y$
\end_inset

.
 On peut alors calculer l'espérance conditionnelle de n'importe quelle fonction
 de 
\begin_inset Formula $X$
\end_inset


\begin_inset space ~
\end_inset

:
\begin_inset Formula 
\[
\E(\varphi(X)|Y=y)=\int_{\R}\varphi(x)f_{X|Y}(x)dx\,.
\]

\end_inset

Notons 
\begin_inset Formula $\mathcal{I}_{s-1}=\{X_{s-1},X_{s-2},\dots\}$
\end_inset

 (pour tout 
\begin_inset Formula $s\geq1$
\end_inset

).
 Nous avons alors, pour tout processus 
\begin_inset Formula $(X_{t})$
\end_inset

, 
\begin_inset Formula 
\[
\Var(X_{t}|\mathcal{I}_{t-1})=\E(X_{t}^{2}|\mathcal{I}_{t-1})-\E(X_{t}|\mathcal{I}_{t-1})^{2}\,.
\]

\end_inset

Dans le cas d'un processus 
\begin_inset Formula $ARCH$
\end_inset

, nous avons directement la loi de 
\begin_inset Formula $X_{t}$
\end_inset

 sachant 
\begin_inset Formula $X_{t-1}$
\end_inset

, 
\begin_inset Formula $X_{t-2}$
\end_inset

, … (donc pas besoin de la formule ci-dessus).
 Si nous posons 
\begin_inset Formula $Y=(X_{t-1},X_{t-2},\dots)$
\end_inset

, 
\begin_inset Formula $X_{t}=X$
\end_inset

, nous pouvons écrire 
\begin_inset Formula 
\[
f_{X|Y}(x)=\frac{1}{\sqrt{2\pi\sigma_{t}^{2}}}\exp\left(-\frac{x^{2}}{2\sigma_{t}^{2}}\right)
\]

\end_inset

(
\begin_inset Formula $\sigma_{t}$
\end_inset

 est une fonction de 
\begin_inset Formula $Y$
\end_inset

).
 Comme annoncé dans la formule ci-dessus, 
\begin_inset Formula $Y$
\end_inset

 est présent en tant que paramètre dans 
\begin_inset Formula $f_{X|Y}$
\end_inset

.
 On trouve bien 
\begin_inset Formula $\Var(X_{t}|Y)=\sigma_{t}^{2}$
\end_inset

.
\end_layout

\begin_layout Subsection
Propriétés
\end_layout

\begin_layout Standard
Soit 
\begin_inset Formula $(X_{t})$
\end_inset

 un processus vérifiant la définition ci-dessus.
 
\end_layout

\begin_layout Proposition
Nous avons pour tout 
\begin_inset Formula $t$
\end_inset

 et 
\begin_inset Formula $h\geq1$
\end_inset


\begin_inset space ~
\end_inset

:
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
\begin_inset Formula $\E(X_{t}|\mathcal{I}_{t-1})=0$
\end_inset

,
\end_layout

\begin_layout Itemize
\begin_inset Formula $\E(X_{t})=0$
\end_inset

,
\end_layout

\begin_layout Itemize
\begin_inset Formula $\Var(X_{t}|\mathcal{I}_{t-1})=\alpha_{0}+\alpha_{1}X_{t-1}^{2}+\dots+\alpha_{p}X_{t-p}^{2}$
\end_inset

,
\end_layout

\begin_layout Itemize
\begin_inset Formula $\Var(X_{t})=\frac{\alpha_{0}}{1-\sum_{i=1}^{p}\alpha_{i}}$
\end_inset

, si 
\begin_inset Formula $\sum_{i=1}^{p}\alpha_{i}<1$
\end_inset

,
\end_layout

\begin_layout Itemize
\begin_inset Formula $\cov(X_{t},X_{t+h}|\mathcal{I}_{t-1})=0$
\end_inset

, pour 
\begin_inset Formula $h\geq1$
\end_inset

,
\end_layout

\begin_layout Itemize
\begin_inset Formula $\cov(X_{t},X_{t+h})=0$
\end_inset

, pour 
\begin_inset Formula $h\geq1$
\end_inset

.
\end_layout

\end_deeper
\begin_layout Proof
Par définition, 
\begin_inset Formula $\E(X_{t}|\mathcal{I}_{t-1})=0$
\end_inset

.
 Donc 
\begin_inset Formula $\E(X_{t})=0$
\end_inset

.
 Par définition
\begin_inset space ~
\end_inset

:
\begin_inset Formula 
\[
\Var(X_{t}|\mathcal{I}_{t-1})=\alpha_{0}+\alpha_{1}X_{t-1}^{2}+\dots+\alpha_{p}X_{t-p}^{2}\,.
\]

\end_inset

Si 
\begin_inset Formula $\sum_{i=1}^{p}\alpha_{i}<1$
\end_inset

, puisque 
\begin_inset Formula $X_{t}$
\end_inset

 est centré, nous avons
\begin_inset Formula 
\begin{eqnarray*}
\Var(X_{t}) & = & \E(X_{t}^{2})\\
 & = & \E(\E(X_{t}^{2}|\mathcal{I}_{t-1}))\\
 & = & \E(\sigma_{t}^{2})\\
 & = & \E(\alpha_{0}+\sum_{i=1}^{p}\alpha_{i}X_{t-i}^{2})\\
X\mbox{ étant stationnaire} & = & \alpha_{0}+\sum_{i=1}^{p}\alpha_{i}\Var(X_{t})\,.
\end{eqnarray*}

\end_inset

D'où 
\begin_inset Formula 
\[
\Var(X_{t})=\frac{\alpha_{0}}{1-\sum_{i=1}^{p}\alpha_{i}}\,.
\]

\end_inset

Nous avons
\begin_inset Formula 
\begin{eqnarray*}
\cov(X_{t},X_{t+h}) & = & \E(X_{t}X_{t+h})-\E(X_{t})\E(X_{t+h})\\
 & = & \E(\E(X_{t}X_{t+h}|\mathcal{I}_{t+h-1}))-0\\
 & = & \E(X_{t}\E(X_{t+h}|\mathcal{I}_{t+h-1}))\\
 & = & 0\,,
\end{eqnarray*}

\end_inset

et 
\begin_inset Formula 
\begin{eqnarray*}
\cov(X_{t},X_{t+h}|\mathcal{I}_{t-1}) & = & \E(X_{t}X_{t+h}|\mathcal{I}_{t-1})-\E(X_{t}|\mathcal{I}_{t-1})\E(X_{t+h}|\mathcal{I}_{t-1})\\
 & = & \E(\E(X_{t}X_{t+h}|\mathcal{I}_{t+h-1})|\mathcal{I}_{t-1})-0\\
 & = & 0\,.
\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Remark
Un processus 
\begin_inset Formula $ARCH$
\end_inset

 est condionnellemment hétéroscédastique
\begin_inset Index idx
status open

\begin_layout Plain Layout
Hétéroscédastique
\end_layout

\end_inset

 (la variance de 
\begin_inset Formula $X_{t}$
\end_inset

 conditionné aux valeurs 
\begin_inset Formula $X_{t-1},X_{t-2},\dots$
\end_inset

 n'est pas constante) mais il est inconditionnellement homoscédastique
\begin_inset Index idx
status open

\begin_layout Plain Layout
Homoscédastique
\end_layout

\end_inset

 (la variance de 
\begin_inset Formula $X_{t}$
\end_inset

 ne dépend pas de 
\begin_inset Formula $t$
\end_inset

).
\end_layout

\begin_layout Proposition
Si 
\begin_inset Formula $\sum_{i=1}^{p}\alpha_{i}<1$
\end_inset

 alors il existe un processus 
\begin_inset Formula $ARCH$
\end_inset

 stationnaire de paramètres 
\begin_inset Formula $(\alpha_{0},\alpha_{1},\dots,\alpha_{p})$
\end_inset

.
\end_layout

\begin_layout Proof
On se donne une collection de variable 
\begin_inset Formula $(e_{t})_{t\in\Z}$
\end_inset

, i.i.d.
 de loi 
\begin_inset Formula $\mathcal{N}(0;1)$
\end_inset

.
 Posons pour tout 
\begin_inset Formula $t$
\end_inset

,
\begin_inset Formula 
\[
\left\{ \begin{array}{l}
\sigma_{t}^{2}=\alpha_{0}+\sum_{k=1}^{+\infty}\sum_{1\leq i_{1},\dots,i_{k}\leq p}\alpha_{0}\times\alpha_{i_{1}}\dots\alpha_{i_{k}}\times e_{t-i_{1}}^{2}e_{t-i_{1}-i_{2}}^{2}\dots e_{t-i_{1}-\dots-i_{k}}^{2}\,,\\
X_{t}=\sigma_{t}e_{t}\,.
\end{array}\right.
\]

\end_inset

Pour tout 
\begin_inset Formula $\omega$
\end_inset

, 
\begin_inset Formula $\sigma_{t}^{2}(\omega)$
\end_inset

 est bien défini, il appartient à 
\begin_inset Formula $\R^{+}\cup\{+\infty\}$
\end_inset

.

\lang english
 
\lang french
Montrons que les 
\begin_inset Formula $\sigma_{t}$
\end_inset

 ainsi définis sont finis p.s.
 Nous avons
\begin_inset Formula 
\begin{eqnarray}
\E(\sigma_{t}^{2}) & = & \alpha_{0}+\alpha_{0}\sum_{k=1}^{+\infty}\sum_{1\leq i_{1},\dots,i_{k}\leq p}\alpha_{i_{1}}\dots\alpha_{i_{k}}\nonumber \\
 & = & \alpha_{0}\left(1+\sum_{k=1}^{+\infty}(\alpha_{1}+\dots+\alpha_{p})^{k}\right)\label{eq:calcul-sigma-t}\\
 & < & +\infty\nonumber 
\end{eqnarray}

\end_inset

car 
\begin_inset Formula $\alpha_{1}+\dots+\alpha_{p}\in]0;1[$
\end_inset

.
 Vérifions maintenant que nous avons la relation de récurrence voulue.
 Nous avons, pour tout 
\begin_inset Formula $t$
\end_inset

, 
\begin_inset Formula 
\begin{eqnarray*}
\alpha_{0}+\sum_{i=1}^{p}\alpha_{i}X_{t-i}^{2} & = & \alpha_{0}+\sum_{i=1}^{p}\alpha_{i}\sigma_{t-i}^{2}e_{t-i}^{2}\\
 & = & \alpha_{0}+\sum_{i=1}^{p}\left(\alpha_{i}e_{t-i}^{2}\sum_{k=0}^{+\infty}\alpha_{0}\times\sum_{1\leq i_{1},\dots,i_{k}\leq p}\alpha_{i_{1}}\dots\alpha_{i_{p}}e_{t-i-i_{1}}^{2}\dots e_{t-i-i_{1}-\dots-i_{k}}^{2}\right)\,,
\end{eqnarray*}

\end_inset

avec la convention 
\begin_inset Formula $\sum_{1\leq i_{1},\dots,i_{k}\leq p}(\dots)=1$
\end_inset

 si 
\begin_inset Formula $k=0$
\end_inset

.
 Et donc
\begin_inset Formula 
\begin{eqnarray*}
\alpha_{0}+\sum_{i=1}^{p}\alpha_{i}X_{t-i}^{2} & = & \alpha_{0}+\alpha_{0}\sum_{k=1}^{+\infty}\sum_{1\leq i_{1},\dots,i_{k}\leq p}\alpha_{i_{1}}\dots\alpha_{i_{p}}e_{t-i_{1}}^{2}\dots e_{t-i_{1}-\dots-i_{k}}^{2}\\
 & = & \sigma_{t}^{2}\,.
\end{eqnarray*}

\end_inset

Par construction, la suite 
\begin_inset Formula $(X_{t})$
\end_inset

 est stationnaire.
 En effet: (
\begin_inset Formula $\mathcal{\mathcal{F}}_{t}=\sigma(e_{k},k\leq t)$
\end_inset

)
\begin_inset Formula 
\begin{eqnarray*}
\E(X_{t}) & = & \E(\sigma_{t}e_{t})\\
 & = & \E(\sigma_{t}\E(e_{t}|\mathcal{F}_{t-1}))\\
 & = & 0\,,
\end{eqnarray*}

\end_inset


\begin_inset Formula 
\begin{eqnarray*}
\var(X_{t}) & = & \E(X_{t}^{2})\\
 & = & \E(\sigma_{t}^{2}\E(e_{t}^{2}|\mathcal{F}_{t-1}))\\
 & = & \E(\sigma_{t}^{2})\\
 &  & \text{(de dépend pas de \ensuremath{t}}\text{ par (\ref{eq:calcul-sigma-t}))}\,,
\end{eqnarray*}

\end_inset

(
\begin_inset Formula $h\geq1$
\end_inset

) 
\begin_inset Formula 
\begin{eqnarray*}
\cov(X_{t},X_{t+h}) & = & \E(X_{t}X_{t+h})\\
 & = & \E(\sigma_{t}e_{t}\sigma_{t+h}e_{t+h})\\
 & = & \E(\E(\sigma_{t}e_{t}\sigma_{t+h}e_{t+h}|\mathcal{F}_{t+h-1}))\\
 & = & \E(\sigma_{t}e_{t}\sigma_{t+h}\E(e_{t+h}|\mathcal{F}_{t+h-1}))\\
 & = & 0\,.
\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Remark
Soit 
\begin_inset Formula $(X_{t})$
\end_inset

 un processus 
\begin_inset Formula $ARCH$
\end_inset

 de variance 
\begin_inset Formula $\sigma^{2}$
\end_inset

.
 
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
La 
\begin_inset Quotes cld
\end_inset

skewness
\begin_inset Index idx
status open

\begin_layout Plain Layout
Skewness
\end_layout

\end_inset


\begin_inset Quotes crd
\end_inset

 de 
\begin_inset Formula $(X_{t})$
\end_inset

 (définie par 
\begin_inset Formula $\E((X_{t}-\E(X_{t}))^{3})/\sigma^{3}$
\end_inset

) est nulle.
\end_layout

\begin_layout Itemize
La 
\begin_inset Quotes cld
\end_inset

kurtosis
\begin_inset Index idx
status open

\begin_layout Plain Layout
Kurtosis
\end_layout

\end_inset


\begin_inset Quotes crd
\end_inset

 de 
\begin_inset Formula $(X_{t})$
\end_inset

 (définie par 
\begin_inset Formula $\E((X_{t}-\E(X_{t}))^{4})/\sigma^{4}-3\E(X_{t}^{2})^{2}/\sigma^{4}$
\end_inset

) est 
\begin_inset Formula $>0$
\end_inset


\end_layout

\end_deeper
\begin_layout Remark
Si 
\begin_inset Formula $Z_{t}\sim\mathcal{N}(0,\sigma^{2})$
\end_inset

 alors 
\begin_inset Formula $\E(Z_{t}^{4})=3\E(Z_{t}^{2})^{2}$
\end_inset

 donc 
\begin_inset Formula $Z_{t}$
\end_inset

 est de kurtosis nulle.
 La kurtosis 
\begin_inset Formula $>0$
\end_inset

 du 
\begin_inset Formula $ARCH$
\end_inset

 veut dire que sa densité est plus étalée que celle de la gaussienne.
\end_layout

\begin_layout Section
Processus
\begin_inset Index idx
status open

\begin_layout Plain Layout
GARCH
\end_layout

\end_inset

 
\begin_inset Formula $GARCH$
\end_inset


\end_layout

\begin_layout Definition
Un processus 
\begin_inset Formula $GARCH(p,q)$
\end_inset

 est un processus 
\begin_inset Formula $(X_{t})_{t\in\Z}$
\end_inset

 vérifiant une relation de récurrence du type
\begin_inset space ~
\end_inset

: 
\begin_inset Formula 
\[
\left\{ \begin{array}{l}
X_{t}=\sigma_{t}e_{t}\mbox{ (avec des \ensuremath{e_{t}} i.i.d. \ensuremath{\sim\mathcal{N}(0;1)})}\,,\\
\sigma_{t}^{2}=\alpha_{0}+\alpha_{1}X_{t-1}^{2}+\dots+\alpha_{p}X_{t-p}^{2}+\beta_{1}\sigma_{t-1}^{2}+\dots+\beta_{q}\sigma_{t-q}^{2}\,,
\end{array}\right.
\]

\end_inset

avec 
\begin_inset Formula $\alpha_{0}>0$
\end_inset

, 
\begin_inset Formula $\alpha_{i}\geq0$
\end_inset

 pour 
\begin_inset Formula $i$
\end_inset

 dans 
\begin_inset Formula $\{1,2,\dots,p\}$
\end_inset

, 
\begin_inset Formula $\beta_{i}\geq0$
\end_inset

 pour 
\begin_inset Formula $i$
\end_inset

 dans 
\begin_inset Formula $\{1,2,\dots,q\}$
\end_inset

.
 
\end_layout

\begin_layout Remark
\begin_inset ERT
status open

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
Un processus 
\begin_inset Formula $GARCH$
\end_inset

 peut être vu comme un processus 
\begin_inset Formula $ARCH$
\end_inset

 d'ordre infini.
\end_layout

\begin_layout Itemize
Un 
\begin_inset Formula $GARCH(p,0)$
\end_inset

 est un 
\begin_inset Formula $ARCH(p)$
\end_inset

.
 
\end_layout

\end_deeper
\begin_layout Proposition
Soit 
\begin_inset Formula $(X_{t})$
\end_inset

 un processus 
\begin_inset Formula $GARCH(p,q)$
\end_inset

, supposé stationnaire.
 Notons, pour tout 
\begin_inset Formula $t$
\end_inset

, 
\begin_inset Formula $\mathcal{I}_{t}=(X_{t},\sigma_{t},X_{t-1},\sigma_{t-1},\dots)$
\end_inset

.
 Nous avons les propriétés suivantes pour tout 
\begin_inset Formula $t$
\end_inset

.
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
\begin_inset Formula $\E(X_{t}|\mathcal{I}_{t-1})=0$
\end_inset

,
\end_layout

\begin_layout Itemize
\begin_inset Formula $\E(X_{t})=0$
\end_inset

,
\end_layout

\begin_layout Itemize
\begin_inset Formula $\cov(X_{t},X_{t+h}|\mathcal{I}_{t-1})=0$
\end_inset

 pour tout 
\begin_inset Formula $h>0$
\end_inset

,
\end_layout

\begin_layout Itemize
\begin_inset Formula $\cov(X_{t},X_{t+h})=0$
\end_inset

 pour tout 
\begin_inset Formula $h>0$
\end_inset

.
\end_layout

\end_deeper
\begin_layout Proof
Soit 
\begin_inset Formula $t\geq1$
\end_inset

.
 Par définition, 
\begin_inset Formula $\E(X_{t}|\mathcal{I}_{t-1})=0$
\end_inset

.
 Et donc 
\begin_inset Formula $\E(X_{t})=0$
\end_inset

.
 Si 
\begin_inset Formula $h>0$
\end_inset

, nous avons
\begin_inset Formula 
\begin{eqnarray*}
\E(X_{t}X_{t+h}|\mathcal{I}_{t-1}) & = & \E(X_{t}\E(X_{t+h}|\mathcal{I}_{t+h-1})|\mathcal{I}_{t-1})\\
 & = & 0\,.
\end{eqnarray*}

\end_inset

Et donc 
\begin_inset Formula $\E(X_{t}X_{t+h})=0$
\end_inset

.
\end_layout

\begin_layout Proposition
Si 
\begin_inset Formula $(X_{t})$
\end_inset

 est un processus 
\begin_inset Formula $GARCH(p,q)$
\end_inset

 alors 
\begin_inset Formula $(X_{t}^{2})$
\end_inset

 est un processus 
\begin_inset Formula $ARMA(m,q)$
\end_inset

 avec 
\begin_inset Formula $m=\sup(p,q)$
\end_inset

.
 
\end_layout

\begin_layout Proof
Nous avons, pour tout 
\begin_inset Formula $t$
\end_inset

, 
\begin_inset Formula 
\begin{eqnarray*}
\sigma_{t}^{2} & = & \alpha_{0}+\alpha_{1}X_{t-1}^{2}+\dots+\alpha_{p}X_{t-p}^{2}+\beta_{1}\sigma_{t-1}^{2}+\dots+\beta_{q}\sigma_{t-q}^{2}\,,
\end{eqnarray*}

\end_inset


\begin_inset Formula 
\begin{multline*}
\sigma_{t}^{2}+X_{t}^{2}=\alpha_{0}+\alpha_{1}X_{t-1}^{2}+\dots+\alpha_{p}X_{t-p}^{2}+X_{t}^{2}+\beta_{1}X_{t-1}^{2}+\dots+\beta_{q}X_{t-q}^{2}\\
-\beta_{1}(X_{t-1}^{2}-\sigma_{t-1}^{2})-\dots-\beta_{q}(X_{t-q}^{2}-\sigma_{t-q}^{2})\,.
\end{multline*}

\end_inset

Nous posons 
\begin_inset Formula $W_{t}=X_{t}^{2}-\sigma_{t}^{2}$
\end_inset

.
 Nous obtenons alors
\begin_inset Formula 
\[
X_{t}^{2}=\alpha_{0}+\sum_{i=1}^{m}(\alpha_{i}+\beta_{i})X_{t-i}^{2}+W_{t}-\sum_{i=1}^{q}\beta_{i}W_{t-i}\,,
\]

\end_inset

avec la convention 
\begin_inset Formula $\alpha_{i}=0$
\end_inset

, si 
\begin_inset Formula $i>p$
\end_inset

 et 
\begin_inset Formula $\beta_{i}=0$
\end_inset

, si 
\begin_inset Formula $i>q$
\end_inset

.
 Les 
\begin_inset Formula $(W_{t})$
\end_inset

 forment un bruit blanc (nous ne démontrons pas ce point), donc 
\begin_inset Formula $(X_{t}^{2})$
\end_inset

 est un 
\begin_inset Formula $ARMA(m,q)$
\end_inset

.
 
\end_layout

\begin_layout Standard
En conséquence de la proposition ci-dessus, pour identifier un 
\begin_inset Formula $GARCH(p,q)$
\end_inset

, on identifiera d'abord le processus 
\begin_inset Formula $ARMA(m,q)$
\end_inset

 qui modélise 
\begin_inset Formula $(X_{t}^{2})$
\end_inset

.
 Pour identifier 
\begin_inset Formula $p$
\end_inset

 dans le cas 
\begin_inset Formula $m=q$
\end_inset

 (c'est à dire 
\begin_inset Formula $p\leq q$
\end_inset

), il faut estimer les coefficients 
\begin_inset Formula $\alpha_{1}$
\end_inset

, …, 
\begin_inset Formula $\alpha_{p}$
\end_inset

( possible car on peut estimer les coefficients du  processus 
\begin_inset Formula $ARMA(m,q)$
\end_inset

) (sont-ils significativement non nuls ?).
\end_layout

\begin_layout Section
Feuille d'exercices numéro 7 (durée
\begin_inset space ~
\end_inset

: 3h) 
\begin_inset Argument 1
status open

\begin_layout Plain Layout
Feuille d'exercices no 7
\end_layout

\end_inset


\end_layout

\begin_layout Subsection*
Préliminaires
\end_layout

\begin_layout Standard
Créer un fichier texte dans lequel vous répondrez clairement aux questions
 ci-dessous, en incluant vos codes R, les résultats obtenus sous R (graphique
 y compris), vos interprétations, remarques ...
 Une fois ce TP fini, vous metterez en forme votre compte-rendu et l'exporterez
 au format pdf.
 
\end_layout

\begin_layout Subsection

\family typewriter
EuStockMarket 
\family default
(valeurs à la fermeture de divers indices des marchés européens)
\end_layout

\begin_layout Standard
Charger les logarithmes des acroissement de l'indice DAX en éxécutant :
 
\family typewriter

\begin_inset Newline newline
\end_inset

dax <- diff(log(EuStockMarkets))[,"DAX"].
 
\family default
Soit 
\family typewriter
dax2=dax^2 
\family default
(les carrés des composantes de 
\family typewriter
dax
\family default
).
 
\end_layout

\begin_layout Enumerate
On cherche à ajuster un modèle 
\begin_inset Formula $ARMA_{m,q}$
\end_inset

 avec 
\begin_inset Formula $m\geq q$
\end_inset

 sur 
\family typewriter
dax2.
 
\family default
Choisir 
\begin_inset Formula $(m,q)$
\end_inset

 dans 
\begin_inset Formula $\{(1,0),(1,1),(2,0),(2,1),(2,2)\}$
\end_inset

 de manière à minimiser la quantité 
\begin_inset Formula $AIC$
\end_inset

 (utiliser les instructions du TP 5).
\end_layout

\begin_layout Enumerate
Proposer un modèle 
\begin_inset Formula $GARCH_{p,q}$
\end_inset

 modélisant 
\family typewriter
dax.
 
\family default
Tester les résidus.
\end_layout

\begin_layout Subsection

\family typewriter
NYSE 
\family default
(New-York stock 
\family typewriter
exc
\family default
hange daily return)
\end_layout

\begin_layout Standard
Charger le fichier 
\family typewriter
nyse.dat
\family default
 à l'adresse
\begin_inset Newline newline
\end_inset

 
\family typewriter
http://math.unice.fr/~rubentha/enseignement/nyse.dat
\end_layout

\begin_layout Enumerate
On suppose que 
\family typewriter
nyse
\family default
 suit un modèle 
\begin_inset Formula $GARCH(1,1)$
\end_inset

.
 On notera 
\begin_inset Formula $(X_{t})$
\end_inset

 le processus.
 Estimer les paramètres du modèle.
 
\end_layout

\begin_layout Enumerate
Tracer dans la même fenêtre : 
\family typewriter
nyse
\family default
 entre les temps 
\begin_inset Formula $900$
\end_inset

 et 
\begin_inset Formula $1000$
\end_inset

 et, pour chaque temps 
\begin_inset Formula $t$
\end_inset

 dans 
\begin_inset Formula $\{900,\dots,1000\}$
\end_inset

, les deux extrémités d'un intervalle 
\begin_inset Formula $[-m;m]$
\end_inset

 tel que 
\begin_inset Formula 
\[
\mathbb{P}(X_{t}\in[-m;m]|X_{t-1},X_{t-2},\dots)=0,32\,.
\]

\end_inset


\end_layout

\begin_layout Subsection*
Mise en 
\begin_inset ERT
status open

\begin_layout Plain Layout

{
\backslash
oe}
\end_layout

\end_inset

uvre sous 
\family typewriter
R
\end_layout

\begin_layout Standard
Pour utiliser les fonctions spécifiques à l’étude des modèles 
\begin_inset Formula $ARCH$
\end_inset

 et 
\begin_inset Formula $GARCH$
\end_inset

, il faut avant tout charger le package 
\family typewriter
tseries
\family default
 à l’aide de la commande 
\family typewriter
library(tseries)
\family default
 (et/ou en cherchant dans le menu 
\begin_inset Quotes cld
\end_inset

packages
\begin_inset Quotes crd
\end_inset

 de 
\family typewriter
R
\family default
).
 La fonction g
\family typewriter
arch
\family default
 permet d’estimer un 
\begin_inset Formula $GARCH_{p,q}$
\end_inset

 : 
\family typewriter
serie<-garch(data,order=c(p,q))
\family default
 Parmi les sorties de cette fonction : 
\family typewriter
coef, residuals, fitted.values
\family default
.
 La sortie 
\family typewriter
serie$fitted.values 
\family default
contient pour chaque temps 
\begin_inset Formula $t$
\end_inset

 les valeurs 
\begin_inset Formula $-\sigma_{t}$
\end_inset

 et 
\begin_inset Formula $\sigma_{t}$
\end_inset

 (avec la notation standard : 
\begin_inset Formula $X_{t}=\sigma_{t}e_{t}$
\end_inset

 (
\begin_inset Formula $e_{t}\sim\mathcal{N}(0,1)$
\end_inset

 et 
\begin_inset Formula $\sigma_{t}^{2}$
\end_inset

 est la variance calculée à partir de 
\begin_inset Formula $X_{t-1},X_{t-2},\dots,\sigma_{t-1},\sigma_{t-2},\dots$
\end_inset

.
 On rappelle que si 
\begin_inset Formula $Z\sim\mathcal{N}(0,1)$
\end_inset

, 
\begin_inset Formula $\mathbb{P}(Z\leq1)=0,8413$
\end_inset

 (approximativement).
\end_layout

\begin_layout Standard
Instructions utile : si 
\family typewriter
A 
\family default
est un tableau à deux colonnes alors 
\family typewriter
A[,j] 
\family default
est la j-ème colonne de 
\family typewriter
A.
 
\family default
Pour fixer la taille de la fenêtre graphique en ordonnée : 
\family typewriter
plot(x,ylim=c(-0.7,0.9)) 
\family default
(c'est un exemple).
\end_layout

\begin_layout Section
Feuille d'exercices numéro 8 (révisions)
\begin_inset Argument 1
status open

\begin_layout Plain Layout
Feuilles d'exercices no 8
\end_layout

\end_inset


\end_layout

\begin_layout Enumerate
Soit 
\begin_inset Formula $X$
\end_inset

 un 
\begin_inset Formula $AR(1)$
\end_inset

 (stationnaire) défini par
\begin_inset space ~
\end_inset

:
\begin_inset Formula 
\[
\forall t\in\Z\,,\,X_{t}=\phi X_{t-1}+Z_{t}\,,
\]

\end_inset

avec 
\begin_inset Formula $Z$
\end_inset

 un bruit blanc centré de variance 
\begin_inset Formula $\sigma^{2}$
\end_inset

 et 
\begin_inset Formula $|\phi|<1$
\end_inset

.
 On pose
\begin_inset space ~
\end_inset

:
\begin_inset Formula 
\[
\forall t\in\Z\,,\,Y_{t}=X_{t}-X_{t-1}\,.
\]

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Enumerate
Montrer que 
\begin_inset Formula $Y$
\end_inset

 est un processus stationnaire centré, puis que c'est un 
\begin_inset Formula $ARMA(p,q)$
\end_inset

.
 Préciser les valeurs de 
\begin_inset Formula $p$
\end_inset

 et 
\begin_inset Formula $q$
\end_inset

 et donner l'équation de récurrence vérifée par 
\begin_inset Formula $Y$
\end_inset

.
\end_layout

\begin_layout Enumerate
Que vaut la variance de 
\begin_inset Formula $Y_{t}$
\end_inset

 (pour tout 
\begin_inset Formula $t$
\end_inset

)
\begin_inset space ~
\end_inset

?
\end_layout

\end_deeper
\begin_layout Enumerate
Soit 
\begin_inset Formula $X$
\end_inset

 un processus 
\begin_inset Formula $ARMA$
\end_inset

 (stationnaire) vérifiant
\begin_inset Formula 
\[
\forall t\in\Z\,,\,X_{t}-\frac{7}{6}X_{t-1}+\frac{1}{3}X_{t-2}=Z_{t}-\frac{1}{4}Z_{t-1}-\frac{1}{8}Z_{t-2}\,,
\]

\end_inset

avec 
\begin_inset Formula $Z$
\end_inset

 un bruit blanc (centré).
 Montrer que 
\begin_inset space ~
\end_inset

:
\begin_inset Formula 
\[
\forall t\in\Z\,,\,X_{t}-\frac{2}{3}X_{t-1}=Z_{t}+\frac{1}{4}Z_{t-1}\,.
\]

\end_inset


\end_layout

\begin_layout Enumerate
La série 
\family typewriter
sncf.rda
\family default
 (disponible sur 
\begin_inset Flex URL
status open

\begin_layout Plain Layout

http://math.unice.fr/~rubentha/enseignement/sncf.rda
\end_layout

\end_inset

, sauver le fichier sur l'ordinateur puis taper 
\family typewriter

\begin_inset Newline newline
\end_inset

load('chemin_complet/serie1.rda')
\family default
, la série 
\family typewriter
serie1
\family default
 sera chargé dans 
\family typewriter
R
\family default
) contient le trafic mensuel sur les lignes SNCF de janvier 1963 à décembre
 1980 en millions de passagers par kilomètres.
 Rappel
\begin_inset space ~
\end_inset

: 
\begin_inset Formula $\Delta_{T}$
\end_inset

 est l'opérateur des différences avec un décalage de 
\begin_inset Formula $T$
\end_inset

.
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Enumerate
Notons 
\begin_inset Formula $X$
\end_inset

 la série à étudier.
 Tracer la densité spectrale de 
\begin_inset Formula $X$
\end_inset

 et les autocorrélations de 
\begin_inset Formula $X$
\end_inset

 pour trouver la période 
\begin_inset Formula $T$
\end_inset

 de la composante saisonnière de 
\begin_inset Formula $X$
\end_inset

.
\end_layout

\begin_layout Enumerate
Notons 
\begin_inset Formula $Y_{1}=\Delta_{1}X$
\end_inset

, 
\begin_inset Formula $Y_{2}=\Delta_{T}X$
\end_inset

, 
\begin_inset Formula $Y_{3}=\Delta_{1}\circ\Delta_{T}X$
\end_inset

.
 Pour chacune de ces séries 
\begin_inset Formula $Y_{\dots}$
\end_inset

,
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Enumerate
tracer les autocorrélations et les autocorrélations partielles, 
\end_layout

\begin_layout Enumerate
en déduire un modèle 
\begin_inset Formula $ARMA$
\end_inset

 pour 
\begin_inset Formula $Y_{\dots}$
\end_inset

 (on doit pouvoir voir le nombre de coefficients non nuls sur les graphiques
 précédents) et estimer les coefficients,
\end_layout

\begin_layout Enumerate
tracer la série des résidus et tester la blancheur des résidus.
\begin_inset Newline newline
\end_inset

(On doit trouver que seul 
\begin_inset Formula $Y_{3}$
\end_inset

 est un 
\begin_inset Formula $ARMA$
\end_inset

.)
\end_layout

\end_deeper
\begin_layout Enumerate
Trouver, parmi les 
\begin_inset Formula $(p,q)\in\{0,1,2\}^{2}$
\end_inset

, le couple minimisant le critère 
\begin_inset Formula $AIC$
\end_inset

 pour 
\begin_inset Formula $Y_{3}$
\end_inset

 (tester la blancheur des résidus pour les 
\begin_inset Formula $(p,q)$
\end_inset

 trouvés).
 
\end_layout

\begin_layout Enumerate
Prédire le trafic de l'année 1981 (avec intervalle de confiance à 95%).
\end_layout

\end_deeper
\begin_layout Enumerate
On étudie la série 
\family typewriter
serie1.rda 
\family default
(disponible sur 
\begin_inset Flex URL
status open

\begin_layout Plain Layout

http://math.unice.fr/~rubentha/enseignement/serie1.rda
\end_layout

\end_inset

, sauver le fichier sur l'ordinateur puis taper 
\family typewriter

\begin_inset Newline newline
\end_inset

load('chemin_complet/serie1.rda')
\family default
, la série 
\family typewriter
serie1
\family default
 sera chargé dans 
\family typewriter
R
\family default
).
 Le modèle choisi pour cette série est 
\begin_inset Formula 
\begin{equation}
\forall t\in\{1,2,\dots,n\}\,,\,x_{t}=m(t)+s(t)+\epsilon_{t}\,,\label{eq:01}
\end{equation}

\end_inset

où 
\begin_inset Formula $m$
\end_inset

 est une tendance polynômiale, 
\begin_inset Formula $s$
\end_inset

 une saisonnalité et 
\begin_inset Formula $\epsilon$
\end_inset

 un processus 
\begin_inset Formula $ARMA$
\end_inset

 (stationnaire) centré (condtui par un bruit blanc gaussien).
\end_layout

\begin_deeper
\begin_layout Enumerate
Tracer la série 
\family typewriter
serie1.rda
\family default
, son périodogramme et son ACF.
 Quelle est la période 
\begin_inset Formula $p$
\end_inset

 de la saisonnalité 
\begin_inset Formula $s$
\end_inset


\begin_inset space ~
\end_inset

?
\end_layout

\begin_layout Enumerate
Estimer une tendance polynômiale et une saisonnalité de période 
\begin_inset Formula $p$
\end_inset

 par moindres carrés ordinaires sur la série 
\family typewriter
serie1.rda 
\family default
(comme au chapitre 3, avec 
\family typewriter
decompose
\family default
)
\end_layout

\begin_layout Enumerate
Sur le résidu de cette estimation, proposer un modèle 
\begin_inset Formula $ARMA$
\end_inset

.
\end_layout

\begin_layout Enumerate
Une fois identifié l'ordre du bruit 
\begin_inset Formula $ARMA$
\end_inset

, ajuster directement avec 
\family typewriter
arima 
\family default
un modèle de type (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:01"

\end_inset

) sur 
\family typewriter
serie1.rda
\family default
.
 Pensez à valider votre modèle.
 
\end_layout

\begin_layout Enumerate
En utilisant la fonction 
\family typewriter
predict
\family default
, prédire les 
\begin_inset Formula $12$
\end_inset

 prochaines valeurs de la série 
\family typewriter
serie1.rda 
\family default
(et tracer intervalle de confiance à 95%).
\end_layout

\end_deeper
\begin_layout Enumerate
Dans cet exercice, on étudie la série 
\family typewriter
serie2.rda 
\family default
(disponible sur 
\begin_inset Flex URL
status open

\begin_layout Plain Layout

http://math.unice.fr/~rubentha/enseignement/serie2.rda
\end_layout

\end_inset

, à charger dans 
\family typewriter
R
\family default
 à l'aide de l'instruction 
\family typewriter
load
\family default
).
 
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Enumerate
Tracer la série 
\family typewriter
serie2.rda
\family default
.
 Est-elle stationnaire
\begin_inset space ~
\end_inset

?
\end_layout

\begin_layout Enumerate
Ajuster un modèle 
\begin_inset Formula $ARIMA$
\end_inset

 sur cette série.
 Pensez à valider votre modèle.
\end_layout

\begin_layout Enumerate
Faire des prédictions pour les 
\begin_inset Formula $50$
\end_inset

 prochaines valeurs de 
\family typewriter
serie2 
\family default
(tracer intervalle de confiance à 95%).
\end_layout

\end_deeper
\begin_layout Section
Corrigé de la feuille d'exercices numéro 8 
\begin_inset Argument 1
status open

\begin_layout Plain Layout
Corrigé de la feuille d'exercices no 8
\end_layout

\end_inset


\end_layout

\begin_layout Enumerate
\begin_inset ERT
status open

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Enumerate
Pour tout 
\begin_inset Formula $t$
\end_inset

, 
\begin_inset Formula $\E(X_{t})=\phi\E(X_{t-1})+0$
\end_inset

.
 Comme 
\begin_inset Formula $X$
\end_inset

 est stationnaire, 
\begin_inset Formula $\E(X_{t})=\E(X_{t-1})$
\end_inset

, et donc, puisque 
\begin_inset Formula $|\phi|<1$
\end_inset

, 
\begin_inset Formula $\E(X_{t})=0$
\end_inset

.
 Donc, pour tout 
\begin_inset Formula $t$
\end_inset

, 
\begin_inset Formula $\E(Y_{t})=\E(X_{t})-\E(X_{t-1})=0$
\end_inset

.
 
\begin_inset Newline newline
\end_inset

Pour tout 
\begin_inset Formula $t$
\end_inset

, 
\begin_inset Formula $\E(Y_{t}^{2})=\Var(X_{t})+\Var(X_{t-1})-2\cov(X_{t},X_{t-1})$
\end_inset

, et puisque 
\begin_inset Formula $X$
\end_inset

 est stationnaire, cette quantité ne dépend pas de 
\begin_inset Formula $t$
\end_inset

.
 Pour tout 
\begin_inset Formula $t$
\end_inset

 et 
\begin_inset Formula $h>0$
\end_inset

, 
\begin_inset Formula 
\begin{eqnarray*}
\E(Y_{t}Y_{t+h}) & = & \E((X_{t}-X_{t-1})(X_{t+h}-X_{t+h-1}))\\
 & = & \cov(X_{t},X_{t+h})-\cov(X_{t},X_{t+h-1})-\cov(X_{t-1},X_{t+h})+\cov(X_{t-1},X_{t+h-1)}\,,
\end{eqnarray*}

\end_inset

qui ne dépend pas de 
\begin_inset Formula $t$
\end_inset

 puisque 
\begin_inset Formula $X$
\end_inset

 est stationnaire.
 Donc 
\begin_inset Formula $Y$
\end_inset

 est stationnaire.
\begin_inset Newline newline
\end_inset

On calcule
\begin_inset space ~
\end_inset

:
\begin_inset Formula 
\begin{eqnarray*}
Y_{t} & = & \phi X_{t-1}+Z_{t}-(\phi X_{t-2}+Z_{t-1})\\
 & = & \phi Y_{t-1}+Z_{t}-Z_{t-1}\,.
\end{eqnarray*}

\end_inset

Donc 
\begin_inset Formula $Y$
\end_inset

 est un 
\begin_inset Formula $ARMA(1,1)$
\end_inset

.
 Il faut préciser pourquoi 
\begin_inset Formula $(Z_{t}-Z_{t-1})$
\end_inset

 est un bruit blanc.
 Calculons
\begin_inset Formula 
\[
\E(Z_{t}-Z_{t-1})=\E(Z_{t})-\E(Z_{t-1})=0
\]

\end_inset


\begin_inset Formula 
\[
\var(Z_{t}-Z_{t-1})=\E((Z_{t}-Z_{t-1})^{2})=\E(Z_{t}^{2})+\E(Z_{t-1}^{2})
\]

\end_inset

(ne dépend pas de 
\begin_inset Formula $t$
\end_inset

).
 Calculons pour 
\begin_inset Formula $h\geq1$
\end_inset


\begin_inset Formula 
\[
\cov(Z_{t}-Z_{t-1},Z_{t+h}-Z_{t+h-1})=\cov(Z_{t},Z_{t+h})+\cov(Z_{t-1},Z_{t+h-1})-\cov(Z_{t-1},Z_{t+h})-\cov(Z_{t},Z_{t+h-1})
\]

\end_inset

(ne dépend pas de 
\begin_inset Formula $t$
\end_inset

).
\end_layout

\begin_layout Enumerate
On calcule (pour 
\begin_inset Formula $t$
\end_inset

 quelconque)
\begin_inset space ~
\end_inset

:
\begin_inset Formula 
\begin{eqnarray*}
\Var(X_{t}) & = & \phi^{2}\Var(X_{t-1})+\sigma^{2}\,.
\end{eqnarray*}

\end_inset

Donc 
\begin_inset Formula 
\[
\Var(X_{t})=\frac{\sigma^{2}}{1-\phi^{2}}\,.
\]

\end_inset

Nous avons pour tout 
\begin_inset Formula $t$
\end_inset


\begin_inset space ~
\end_inset

:
\begin_inset Formula 
\begin{eqnarray*}
\E(X_{t}X_{t-1}) & = & \E(\phi X_{t-1}^{2}+Z_{t}X_{t-1})\\
 & = & \phi\Var(X_{t-1})+0\\
 & = & \frac{\phi\sigma^{2}}{1-\phi^{2}}\,.
\end{eqnarray*}

\end_inset

D'où
\begin_inset space ~
\end_inset

:
\begin_inset Formula 
\begin{eqnarray*}
\Var(Y_{t}) & = & \Var(X_{t})+\Var(X_{t-1})-2\cov(X_{t},X_{t-1})\\
 & = & \frac{2\sigma^{2}}{1-\phi^{2}}-2\left(\frac{\phi\sigma^{2}}{1-\phi^{2}}\right)\\
 & = & \frac{2\sigma^{2}(1-\phi)}{1-\phi^{2}}=\frac{2\sigma^{2}}{1+\phi}\,.
\end{eqnarray*}

\end_inset


\end_layout

\end_deeper
\begin_layout Enumerate
\begin_inset Note Comment
status collapsed

\begin_layout Plain Layout
Calculons
\begin_inset space ~
\end_inset

:
\begin_inset Formula 
\begin{eqnarray*}
\widetilde{X}_{t}-\frac{3}{2}\widetilde{X}_{t-1} & = & X_{t}-X_{t-1}-\frac{3}{2}(X_{t-1}-X_{t-2})\\
 & = & X_{t}-\frac{5}{2}X_{t-1}+\frac{5}{2}X_{t-2}\\
 & = & Z_{t}+3Z_{t-1}-4Z_{t-2}\\
 & = & Z_{t}-Z_{t-1}+4(Z_{t-1}-Z_{t-2})\,.
\end{eqnarray*}

\end_inset


\begin_inset space ~
\end_inset

Posons 
\begin_inset Formula $\widetilde{Z}_{t}=Z_{t}-Z_{t-1}$
\end_inset

 (pour tout 
\begin_inset Formula $t$
\end_inset

).
 La variable 
\begin_inset Formula $Z_{t}$
\end_inset

 est gaussienne pour tout 
\begin_inset Formula $t$
\end_inset

, donc les variables 
\begin_inset Formula $\widetilde{Z}_{t}$
\end_inset

 sont gaussiennes.
 Pour tout 
\begin_inset Formula $t$
\end_inset


\begin_inset space ~
\end_inset

: 
\begin_inset Formula $\Var(Z_{t})=\Var(Z_{t})+\Var(Z_{t-1})=2\sigma^{2}$
\end_inset

.
 Pour montrer que 
\begin_inset Formula $\widetilde{Z}_{t}$
\end_inset

 et 
\begin_inset Formula $\widetilde{Z}_{t'}$
\end_inset

 sont indépendantes pour 
\begin_inset Formula $t\neq t'$
\end_inset

, il suffit de montrer que 
\begin_inset Formula $\Cov(Z_{t},Z_{t'})=0$
\end_inset

 (parce que nous avons affaire à des gaussiennes).
 Nous calculons donc
\begin_inset space ~
\end_inset

:
\begin_inset Formula 
\begin{eqnarray*}
\E(\widetilde{Z}_{t}\widetilde{Z}_{t'}) & = & \E((Z_{t}-Z_{t-1})(Z_{t'}-Z_{t'-1}))\\
 & =
\end{eqnarray*}

\end_inset


\end_layout

\end_inset

 
\begin_inset Note Comment
status collapsed

\begin_layout Plain Layout
Calculons (on admet que les série sont convergentes, on remarque que ce
 sont des séries dans lesquelles beaucoup de termes se simplifient)
\begin_inset space ~
\end_inset

:
\begin_inset Formula 
\begin{eqnarray*}
X_{t}-\frac{2}{3}X_{t-1} & = & \sum_{k\geq0}\left[\frac{1}{2^{k}}\left(X_{t-k}-\frac{7}{6}X_{t-k-1}+\frac{1}{3}X_{t-3}\right)\right]\\
 & = & \sum_{k\geq0}\left[\frac{1}{2^{k}}\left(Z_{t-k}-\frac{1}{4}Z_{t-t-k}-\frac{1}{8}Z_{t-k-2}\right)\right]\\
 & = & Z_{t}+\frac{1}{4}Z_{t-1}\,.
\end{eqnarray*}

\end_inset


\end_layout

\end_inset

Nous voulons éliminer les 
\begin_inset Formula $X$
\end_inset

 dans l'expression 
\begin_inset Formula $X_{t}-(2/3)X_{t-1}$
\end_inset

 (
\begin_inset Formula $t$
\end_inset

 quelconque fixé).
 Nous commençons donc le calcul par
\begin_inset Formula 
\begin{eqnarray*}
X_{t}-\frac{2}{3}X_{t-1} & = & X_{t}-\frac{7}{6}X_{t-1}+\frac{1}{3}X_{t-2}+\frac{X_{t-1}}{2}-\frac{1}{3}X_{t-2}\\
 & = & \left(Z_{t}-\frac{Z_{t-1}}{4}-\frac{Z_{t-2}}{8}\right)+\frac{1}{2}\left(X_{t-1}-\frac{7}{6}X_{t-2}+\frac{X_{t-3}}{3}\right)\\
 &  & +\frac{1}{4}X_{t-2}-\frac{1}{6}X_{t-3}\\
 & = & \left(Z_{t}-\frac{Z_{t-1}}{4}-\frac{Z_{t-2}}{8}\right)+\frac{1}{2}\left(X_{t-1}-\frac{7}{6}X_{t-2}+\frac{X_{t-3}}{3}\right)\\
 &  & +\frac{1}{4}\left(X_{t-2}-\frac{7}{6}X_{t-3}+\frac{X_{t-4}}{3}\right)+\frac{1}{8}X_{t-3}-\frac{1}{12}X_{t-4}\,.
\end{eqnarray*}

\end_inset

Ce qui nous donne l'idée de calculer 
\begin_inset Formula $\sum_{k\geq0}\left[\frac{1}{2^{k}}\left(X_{t-k}-\frac{7}{6}X_{t-k-1}+\frac{1}{3}X_{t-3}\right)\right]$
\end_inset

.
 Nous commençons par montrer que cette suite est bien définie (en utilisant
 le fait que les 
\begin_inset Formula $Z_{t}$
\end_inset

 sont centrés et tous de même variance)
\begin_inset Formula 
\begin{multline*}
\E\left(\left(\sum_{k\geq0}\left[\frac{1}{2^{k}}\left(X_{t-k}-\frac{7}{6}X_{t-k-1}+\frac{1}{3}X_{t-k-2}\right)\right]\right)^{2}\right)\\
=\E\left(\left(\sum_{k\geq0}\left[\frac{1}{2^{k}}\left(Z_{t-k}-\frac{1}{4}Z_{t-k-1}-\frac{1}{8}Z_{t-k-2}\right)\right]\right)^{2}\right)\\
=\E\left(\left(\sum_{j\geq0}\left[\frac{1}{2^{j}}\left(Z_{t-j}-\frac{1}{4}Z_{t-j-1}-\frac{1}{8}Z_{t-j-2}\right)\right]\right)^{2}\right)\\
=\sum_{k\geq0}\E(Z_{t-k}^{2})\times\left(\frac{1}{2^{k}}-\frac{1}{4}\frac{1}{2^{k-1}}\1_{k\geq1}-\frac{1}{8}\frac{1}{2^{k-2}}\1_{k\geq2}\right)^{2}\\
<+\infty\text{ car série géométrique\,.}
\end{multline*}

\end_inset

Donc la somme qui nous intéresse est finie presque sûrement.
 Nous calculons alors
\begin_inset Formula 
\begin{multline*}
\sum_{k\geq0}\left[\frac{1}{2^{k}}\left(X_{t-k}-\frac{7}{6}X_{t-k-1}+\frac{1}{3}X_{t-k-2}\right)\right]\\
=X_{t}+X_{t-1}\left(-\frac{7}{6}+\frac{1}{2}\right)+\sum_{k\geq2}\frac{X_{t-k}}{2^{k}}\left(1-\frac{7}{6}\times2+\frac{1}{3}\times2^{2}\right)\\
=X_{t}+X_{t-1}\times\frac{2}{3}\,.
\end{multline*}

\end_inset

Nous avons par ailleurs
\begin_inset Formula 
\begin{multline*}
\sum_{k\geq0}\left[\frac{1}{2^{k}}\left(X_{t-k}-\frac{7}{6}X_{t-k-1}+\frac{1}{3}X_{t-k-2}\right)\right]\\
=\sum_{k\geq0}\frac{1}{2^{k}}\left(Z_{t-k}-\frac{Z_{t-k-1}}{4}-\frac{1}{8}Z_{t-k-2}d\right)\\
=Z_{t}+Z_{t-1}\left(-\frac{1}{4}+\frac{1}{2}\right)+\sum_{k\geq2}\frac{Z_{t-k}}{2^{k}}\left(1-\frac{1}{4}\times2-\frac{1}{8}\times2^{2}\right)\\
=Z_{t}+Z_{t-1}\left(-\frac{1}{4}+\frac{1}{2}\right)\,.
\end{multline*}

\end_inset

Ce qui finit la démonstration.
\end_layout

\begin_layout Enumerate
\begin_inset ERT
status open

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Enumerate
Pour tracer le périodogramme
\begin_inset space ~
\end_inset

: 
\family typewriter
k=kernel("daniell",4);
\begin_inset Newline newline
\end_inset

 spec.pgram(sncf,k,taper=0,log='no')
\family default
.
 On obtient la figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:périodogramme"

\end_inset

.
\begin_inset Float figure
placement h
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/periodogram-01.png
	scale 50

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
périodogramme
\begin_inset CommandInset label
LatexCommand label
name "fig:périodogramme"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset

Rappel
\begin_inset space ~
\end_inset

: les abscisses vont de 
\begin_inset Formula $0$
\end_inset

 à 
\begin_inset Formula $\pi$
\end_inset

 (l'échelle affichée n'est pas correcte).
 Le pic le plus important se trouve donc en 
\begin_inset Formula $\pi/6$
\end_inset

, ce qui correspond à une période 
\begin_inset Formula $2\pi/(\pi/6)=12$
\end_inset

 (ce qui est bien cohérent avec le graphique de la série et les autocorrélations
)
\begin_inset Newline newline
\end_inset

 (
\family typewriter
png(filename="blabla/tp8/5.1.png") ; par(mfrow=c(2,1)) ; plot(sncf) ; 
\begin_inset Newline newline
\end_inset

acf(sncf,lag.max=50) ; dev.off()
\family default
, figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:graphique-et-ACF"

\end_inset

) 
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Float figure
placement h
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/5.1.png
	scale 45

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
graphique et ACF
\begin_inset CommandInset label
LatexCommand label
name "fig:graphique-et-ACF"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Phantom HPhantom
status open

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset Float figure
placement h
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/5.2.1.png
	scale 45

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:5.2.1"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Enumerate
Calculons les séries demandées
\begin_inset space ~
\end_inset

: 
\family typewriter
y1=diff.ts(sncf,lag=1); y2=diff.ts(sncf,lag=12); y3=diff.ts(y1,lag=12)
\family default
.
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
On commence par 
\family typewriter
y1
\family default
 (figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:5.2.1"

\end_inset

).
 On se dit que 
\begin_inset Formula $Y_{1}$
\end_inset

 pourrait être un 
\begin_inset Formula $AR(3)$
\end_inset

, et donc que 
\begin_inset Formula $X$
\end_inset

 pourrait être un 
\begin_inset Formula $ARIMA(3,1,0)$
\end_inset

.
 On estime les coefficients par
\begin_inset space ~
\end_inset

: 
\family typewriter
out<-arima(sncf,order=c(3,1,0))
\family default
.
 On fait un test de niveau 
\begin_inset Formula $0,05$
\end_inset

 pour savoir si les résidus forment un bruit blanc.
 L'instruction 
\family typewriter
Box.test(out$resid,lag=10)
\family default
 renvoie une 
\begin_inset Formula $p$
\end_inset

-valeur de 
\begin_inset Formula $0,002345$
\end_inset

 (le test calcule une statitique et la 
\begin_inset Formula $p$
\end_inset

-valeur est la probabilité d'observer une statistique aussi grande sous
 l'hypothèse 
\begin_inset Quotes cld
\end_inset

bruit blanc
\begin_inset Quotes crd
\end_inset

).
 Comme la 
\begin_inset Formula $p$
\end_inset

-valeur est plus petite que 
\begin_inset Formula $0,05$
\end_inset

, on rejette l'hypothèse 
\begin_inset Quotes cld
\end_inset

bruit blanc
\begin_inset Quotes crd
\end_inset

.
 Notre processus ne peut pas être un 
\begin_inset Formula $ARIMA(3,1,0)$
\end_inset

.
\end_layout

\begin_layout Itemize
On continue avec 
\begin_inset Formula $Y_{2}$
\end_inset

 (figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:5.2.2"

\end_inset

).
 
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Float figure
placement h
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/5.2.2.png
	scale 45

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:5.2.2"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Phantom HPhantom
status open

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset Float figure
placement h
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/5.2.3.png
	scale 45

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:5.2.3"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\end_inset

On se dit que 
\begin_inset Formula $Y_{2}$
\end_inset

 pourrait être un 
\begin_inset Formula $AM(1)$
\end_inset

 et donc que 
\begin_inset Formula $X$
\end_inset

 pourrait être un 
\begin_inset Formula $SARIMA(0,0,1,12)$
\end_inset

.
 On estime les coefficients par 
\family typewriter
out<-arima(sncf,order=c(0,0,1),seasonal=list(order=c(0,0,1),period=12))
\family default
.
 On fait un test de niveau 
\begin_inset Formula $0,05$
\end_inset

 pour savoir si les résidus forment un bruit blanc.
 L'instruction 
\family typewriter
Box.test(out$resid,lag=10)
\family default
 renvoie une 
\begin_inset Formula $p$
\end_inset

-valeur de 
\begin_inset Formula $2,2\times10^{-16}$
\end_inset

, donc on rejette l'hypothèse 
\begin_inset Quotes cld
\end_inset

bruit blanc
\begin_inset Quotes crd
\end_inset

.
 Notre processus ne peut pas être un 
\begin_inset Formula $SARIMA(0,0,1,12)$
\end_inset

.
\end_layout

\begin_layout Itemize
On continue avec 
\begin_inset Formula $Y_{3}$
\end_inset

 (figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:5.2.3"

\end_inset

)On se dit que 
\begin_inset Formula $Y_{3}$
\end_inset

 pourrait être un 
\begin_inset Formula $MA(1)$
\end_inset

 et que donc 
\begin_inset Formula $X$
\end_inset

 pourrait être un 
\begin_inset Formula $SARIMA(0,1,1,12)$
\end_inset

.
 On estime les coefficients par 
\family typewriter
out<-arima(sncf,order=c(0,1,1),seasonal=list(order=c(0,1,1),period=12))
\family default
.
 On fait un test de niveau 
\begin_inset Formula $0,05$
\end_inset

 pour savoir si les résidus forment un bruit blanc.
 Faisons un test de Box-Jenkins au niveau 
\begin_inset Formula $0,05$
\end_inset

.
 L'instruction 
\family typewriter
Box.test(out$resid,lag=10)
\family default
 renvoie une 
\begin_inset Formula $p$
\end_inset

-valeur de 
\begin_inset Formula $0,09057$
\end_inset

 (
\begin_inset Formula $>0,05$
\end_inset

) donc on reste sur l'hypothèse 
\begin_inset Quotes cld
\end_inset

bruit blanc
\begin_inset Quotes crd
\end_inset

.
 Donc notre processus 
\begin_inset Formula $X$
\end_inset

 a bien l'air d'être un 
\begin_inset Formula $SARIMA(0,1,1,12)$
\end_inset

.
 
\end_layout

\end_deeper
\begin_layout Enumerate
On exécute une boucle 
\begin_inset Newline newline
\end_inset


\family typewriter
p=0
\begin_inset Newline newline
\end_inset

q=0
\begin_inset Newline newline
\end_inset

out<-arima(sncf,order=c(0,1,2),seasonal=list(order=c(0,1,2),period=12))
\begin_inset Newline newline
\end_inset

m=out$aic 
\begin_inset Newline newline
\end_inset

for (i in 0:2) 
\begin_inset Newline newline
\end_inset

{
\begin_inset Newline newline
\end_inset

for (j in 0:2)
\begin_inset Newline newline
\end_inset

 {
\begin_inset Newline newline
\end_inset

if (i+j>0)
\begin_inset Newline newline
\end_inset

{
\begin_inset Newline newline
\end_inset

 out<-arima(sncf,order=c(i,1,j),seasonal=list(order=c(i,1,j),period=12))
 
\begin_inset Newline newline
\end_inset


\begin_inset space ~
\end_inset

if (out$aic>m) { p=i q=j } 
\begin_inset Newline newline
\end_inset

}
\begin_inset Newline newline
\end_inset


\begin_inset space ~
\end_inset

}
\begin_inset Newline newline
\end_inset

}
\begin_inset Newline newline
\end_inset

cat(p,q)
\begin_inset Newline newline
\end_inset


\family default
Le meilleur couple maximisant le critère AIC est 
\begin_inset Formula $p=1$
\end_inset

, 
\begin_inset Formula $q=0$
\end_inset

 (qui ne correspond pas aux graphiques ACF et PACF ci-dessus).
 Nous éxécutons ensuite
\begin_inset Newline newline
\end_inset


\family typewriter
out02<-arima(sncf,order=c(1,1,0),seasonal=list(order=c(1,1,0),period=12))
\family default

\begin_inset Newline newline
\end_inset

Faisons un test de Box-Jenkins sur les résidus au niveau 
\begin_inset Formula $0,05$
\end_inset

.
\begin_inset Newline newline
\end_inset


\family typewriter
Box.test(out02$resid)
\family default

\begin_inset Newline newline
\end_inset

Ceci nous donne une 
\begin_inset Formula $p$
\end_inset

-valeur de 
\begin_inset Formula $0,1508$
\end_inset

.
 Donc nous validons le modèle SARIMA(1,1,0,12)
\end_layout

\begin_layout Enumerate
On éxécute le code (graphique dans la figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:pred"

\end_inset

)
\begin_inset Newline newline
\end_inset


\family typewriter
out02<-arima(sncf,order=c(1,1,0),seasonal=list(order=c(1,1,0),period=12))
\begin_inset Newline newline
\end_inset

 outpred<-predict(out02,n.ahead=12) 
\begin_inset Newline newline
\end_inset

pred=outpred$pred 
\begin_inset Newline newline
\end_inset

ts.plot(sncf,pred,col=c('black','red'))
\begin_inset Newline newline
\end_inset

lines(pred+1.96*outpred$se,col='cyan') 
\begin_inset Newline newline
\end_inset

lines(pred-1.96*outpred$se,col='cyan')
\begin_inset Newline newline
\end_inset


\family default

\begin_inset Float figure
placement h
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/pred-sncf.png
	scale 50

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Prédiction trafic SNCF
\begin_inset CommandInset label
LatexCommand label
name "fig:pred"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Note Comment
status collapsed

\begin_layout Plain Layout
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/serie1-01.png
	lyxscale 50
	scale 50

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Série 1, périodogramme et ACF.
\begin_inset CommandInset label
LatexCommand label
name "fig:Série-1,-périodogramme"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\end_deeper
\begin_layout Enumerate
\begin_inset space ~
\end_inset


\end_layout

\begin_deeper
\begin_layout Enumerate
Raisonnement et graphiques identiques à ce que nous avons pour 
\family typewriter
sncf
\family default
.
\end_layout

\begin_layout Enumerate
Nous utilisons les instructions
\begin_inset space ~
\end_inset

:
\begin_inset Newline newline
\end_inset


\family typewriter
serie1<-ts(serie1,frequency=12) 
\begin_inset Newline newline
\end_inset

s_dec<-decompose(serie1,type=c('additive'))
\begin_inset Newline newline
\end_inset

par(mfrow=c(3,1)) 
\begin_inset Newline newline
\end_inset

plot(s_dec$seasonal) 
\begin_inset Newline newline
\end_inset

plot(s_dec$trend) 
\begin_inset Newline newline
\end_inset

plot(s_dec$random) 
\begin_inset Newline newline
\end_inset


\family default
Voir le résultat dans la figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Décomposition-de-serie1"
plural "false"
caps "false"
noprefix "false"

\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Float figure
placement h
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/serie1_dec.png
	lyxscale 75
	scale 50

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Décomposition de serie1
\begin_inset CommandInset label
LatexCommand label
name "fig:Décomposition-de-serie1"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Phantom HPhantom
status open

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset Float figure
placement h
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/acf-pacf-x1.png
	lyxscale 75
	scale 45

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
ACF et PACF pour serie1
\begin_inset CommandInset label
LatexCommand label
name "fig:ACF-et-PACF"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Enumerate
Nous commençons par enlever les valeurs NA
\begin_inset space ~
\end_inset

: 
\family typewriter
x<-window(s_dec$random,c(2,1),c(9,12))
\family default
.
 Puis nous traçons les ACF, PACF
\begin_inset space ~
\end_inset

:
\begin_inset Newline newline
\end_inset


\family typewriter
par(mfrow=c(2,1)) 
\begin_inset Newline newline
\end_inset

acf(x)
\begin_inset Newline newline
\end_inset

 pacf(x)
\begin_inset Newline newline
\end_inset


\family default
(voir figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:ACF-et-PACF"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
 Les ACF tendent vers 
\begin_inset Formula $0$
\end_inset

 et les PACF sont nulles après le rang 1 donc nous faisons l'hypothèse que
 le processus est AR(1).
\end_layout

\begin_layout Enumerate
Comme on a identifié une période 12, on commence par 
\family typewriter
x1<-diff(serie1,lag=12); plot(x1)
\family default
.
 Le résultat n'a pas l'air stationnaire (la moyenne varie).
 Si on fait un test de Dickey-Fuller au niveau 
\begin_inset Formula $0,05$
\end_inset

, on obtient une 
\begin_inset Formula $p$
\end_inset

-valeur égale à 
\begin_inset Formula $0,1272$
\end_inset

, ce qui confirme l'idée que 
\family typewriter
x1
\family default
 n'est pas stationnaire.
 Nous faisons ensuite
\begin_inset space ~
\end_inset

: 
\family typewriter
x2<-diff(x1)
\family default
.
 Le résultat a l'air peu stationnaire (la moyenne varie, voir figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:x2"
plural "false"
caps "false"
noprefix "false"

\end_inset

, à gauche).
 Le test de Dickey-Fuller au sur 
\family typewriter
x2
\family default
 donne une 
\begin_inset Formula $p$
\end_inset

-valeur égale à 
\begin_inset Formula $0,0148$
\end_inset

 donc … la réponse dépend du niveau voulu pour le test.
 Nous considérerons que 
\family typewriter
x2
\family default
 n'est pas stationnaire.
 Nous faisons ensuite
\begin_inset space ~
\end_inset

: 
\family typewriter
x3<-diff(x2)
\family default
.
 Le résultat a l'air stationnaire (voir figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:x2"
plural "false"
caps "false"
noprefix "false"

\end_inset

, à droite).
 Les ACF, PACF de 
\family typewriter
x3
\family default
 sont visibles dans la figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:x3-1"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 On dirait que les ACF tendent vers 
\begin_inset Formula $0$
\end_inset

 et que les PACF sont nulles après le cran 
\begin_inset Formula $3$
\end_inset

 donc nous faisons l'hypothèse que 
\family typewriter
x3
\family default
 est un MA(3).
\begin_inset Float figure
placement h
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/x2.png
	lyxscale 75
	scale 40

\end_inset

 
\begin_inset Phantom HPhantom
status open

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset Graphics
	filename figures/x3.png
	lyxscale 75
	scale 40

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
x2
\begin_inset CommandInset label
LatexCommand label
name "fig:x2"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
placement h
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/acf-pacf-x3.png
	lyxscale 75
	scale 50

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
x3
\begin_inset CommandInset label
LatexCommand label
name "fig:x3-1"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset

Nous pouvons ensuite estimer les coefficients avec
\begin_inset Newline newline
\end_inset

 
\family typewriter
out<-arima(x,order=c(0,2,3),seasonal=list(order=c(0,2,3),period=12)) 
\begin_inset Newline newline
\end_inset


\family default
Si nous faisons un test de Box-Jenkins au niveau 
\begin_inset Formula $0,01$
\end_inset

 (
\family typewriter
Box.test(out$resid,lag=10)
\family default
) sur les résidus, nous trouvons une 
\family typewriter

\begin_inset Formula $p$
\end_inset


\family default
-valeur égale à 
\begin_inset Formula $0,02448$
\end_inset

 donc on peut conclure que le modèle proposé est correct.
 
\end_layout

\begin_layout Enumerate
Nous traçons avec 
\begin_inset Newline newline
\end_inset


\family typewriter
ts.plot(serie1,pred$pred,col=c('black','red'),ylim=c(-50,210)) 
\begin_inset Newline newline
\end_inset

lines(pred$pred+1.96*pred$se,col='grey') 
\begin_inset Newline newline
\end_inset

lines(pred$pred-1.96*pred$se,col='grey') 
\begin_inset Newline newline
\end_inset


\family default
(voir figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Prédictions-pour-serie1"
plural "false"
caps "false"
noprefix "false"

\end_inset

)
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename figures/pred-serie1.png
	lyxscale 75
	scale 50

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Prédictions pour serie1
\begin_inset CommandInset label
LatexCommand label
name "fig:Prédictions-pour-serie1"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Phantom HPhantom
status open

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename figures/acf-serie2.png
	lyxscale 75
	scale 50

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
ACF serie2
\begin_inset CommandInset label
LatexCommand label
name "fig:ACF-serie2"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\end_deeper
\begin_layout Enumerate
\begin_inset space ~
\end_inset


\end_layout

\begin_deeper
\begin_layout Enumerate
La série n'a pas l'air stationnaire (sa moyenne varie).
 Un test de Dickey-Fuller au niveau 
\begin_inset Formula $0,05$
\end_inset

 nous donne une 
\family typewriter

\begin_inset Formula $p$
\end_inset


\family default
-valeur égale à 
\begin_inset Formula $0,146$
\end_inset

 ce qui confirme l'hypothèse de non-stationnarité.
 Le graphe de l'ACF (voir figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:ACF-serie2"
plural "false"
caps "false"
noprefix "false"

\end_inset

) ne permet pas de détecter une saisonnalité.
 Nous éxécutons donc ensuite 
\family typewriter
x1<-diff(serie2); plot(x1) 
\family default
(voir figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Différences-de-serie2"
plural "false"
caps "false"
noprefix "false"

\end_inset

, à gauche) puis 
\family typewriter
x2<-diff(x1); plot(x2) 
\family default
(voir figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Différences-de-serie2"
plural "false"
caps "false"
noprefix "false"

\end_inset

, à droite).
 Nous estimons que 
\family typewriter
x1
\family default
 n'est pas stationnaire mais que 
\family typewriter
x2
\family default
 l'est..
\begin_inset Float figure
placement h
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/d1-serie2.png
	lyxscale 75
	scale 50

\end_inset


\begin_inset Phantom HPhantom
status open

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset Graphics
	filename figures/d2-serie2.png
	scale 50

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Différences de serie2
\begin_inset CommandInset label
LatexCommand label
name "fig:Différences-de-serie2"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset

Nous traçons ensuite les ACF et PACF de 
\begin_inset Formula $\mathtt{x2}$
\end_inset

 (voir figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:ACF,-PACF-pour"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Float figure
placement h
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/acf-pacf-serie2.png
	lyxscale 75
	scale 50

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
ACF, PACF pour 
\family typewriter
x2
\family default
 de serie2
\begin_inset CommandInset label
LatexCommand label
name "fig:ACF,-PACF-pour"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Phantom HPhantom
status open

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset Float figure
placement h
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/last-pred.png
	lyxscale 75
	scale 50

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Prédiction pour serie2
\begin_inset CommandInset label
LatexCommand label
name "fig:Prédiction-pour-serie2"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\end_inset

Une fois de plus, l'interprétation n'est pas aisée.
 Nous proposons un modèle MA(3) pour 
\family typewriter
x2 
\family default
(donc ARIMA(0,2,3) pour 
\family typewriter
serie2
\family default
).
 Nous éxécutons 
\family typewriter
out<-arima(serie2,order=c(0,2,3)) ; Box.test(out$resid,lag=10)
\family default
 et nous trouvons une 
\begin_inset Formula $p$
\end_inset

-valeur égale à 
\begin_inset Formula $0,716$
\end_inset

, ce qui valide notre modèle.
\end_layout

\begin_layout Enumerate
Voir figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Prédiction-pour-serie2"
plural "false"
caps "false"
noprefix "false"

\end_inset

 (prédiction en rouge, borne de l'intervalle de confiance en bleu).
 L'intervalle de confiance nous dit que … nous ne pouvons rien prédire.
 C'est ce qui arrive quand le bruit est trop grand.
 
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cleardoublepage 
\backslash
phantomsection
\end_layout

\end_inset


\end_layout

\begin_layout Chapter*
Table de la loi normale
\end_layout

\begin_layout Standard
\begin_inset Graphics
	filename figures/Table-loi-normale.pdf
	scale 80

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset bibtex
LatexCommand bibtex
btprint "btPrintAll"
bibfiles "bib-poly-cours-series-temp-m1-im"
options "alpha-fr"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset nomencl_print
LatexCommand printnomenclature
set_width "auto"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset index_print
LatexCommand printindex
type "idx"
name "Index"
literal "true"

\end_inset


\end_layout

\end_body
\end_document
